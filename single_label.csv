text,mitre_technique_ID,mitre_technique_name
This file extracts credentials from LSASS similar to Mimikatz.,T1003.001,OS Credential Dumping: LSASS Memory
"It calls OpenProcess on lsass.exe with access flag set to VM_READ, and looks for the modules wdigest.dll and lsasrv.dll loaded in the lsass.exe process.",T1003.001,OS Credential Dumping: LSASS Memory
"It spreads to Microsoft Windows machines using several propagation methods, including the EternalBlue exploit for the CVE-2017-0144 vulnerability in the SMB service.",T1210,Exploitation of Remote Services
SMB exploitation via EternalBlue,T1210,Exploitation of Remote Services
SMBv1 Exploitation via EternalBlue,T1210,Exploitation of Remote Services
has the capability to exploit SMBv1 via the well known EternalBlue exploit.,T1210,Exploitation of Remote Services
SMB copy and remote execution,T1570,Lateral Tool Transfer
This thread is then used to execute the SMB copy and remote execution,T1570,Lateral Tool Transfer
SMB copy and remote execution,T1570,Lateral Tool Transfer
SMB Copy and Remote Execution,T1570,Lateral Tool Transfer
The malware decompresses its resource named,T1140,Deobfuscate/Decode Files or Information
The malware decompresses a resource,T1140,Deobfuscate/Decode Files or Information
This is used as an integrity check for the decryption process.,T1140,Deobfuscate/Decode Files or Information
"decrypt the MFT,",T1140,Deobfuscate/Decode Files or Information
the code attempts to decrypt the contents,T1140,Deobfuscate/Decode Files or Information
"Once the sector is decrypted,",T1140,Deobfuscate/Decode Files or Information
and the same key is used to decrypt the MFT.,T1140,Deobfuscate/Decode Files or Information
"is also decoded, and placed back",T1140,Deobfuscate/Decode Files or Information
its resource section are decompressed and written to disk,T1140,Deobfuscate/Decode Files or Information
The malware is a DLL that is launched using rundll32.exe:,T1218.011,System Binary Proxy Execution: Rundll32
being invoked by rundll32.exe.,T1218.011,System Binary Proxy Execution: Rundll32
Command Line Execution,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Once the command line arguments are generated,T1059.003,Command and Scripting Interpreter: Windows Command Shell
The malware also spawns cmd.exe to execute the following command,T1059.003,Command and Scripting Interpreter: Windows Command Shell
that hashes each running process on the system,T1057,Process Discovery
Process Hashes and Process Privilege Checks,T1057,Process Discovery
to track which of the 3 processes are running on the system.,T1057,Process Discovery
"compares each hash with 3 hardcoded hashes:

0x6403527E → avp.exe associated with Kaspersky AV
0x23214B44  → ns.exe associated with Norton Security
0x651B3005 → ccSvcHst.exe associated with Symantec",T1518.001,Software Discovery: Security Software Discovery
using the API NtRaiseHardError,T1106,Native API
invokes the following API’s:,T1106,Native API
"GetExtendedTcpTable to retrieve a list of TCP endpoints
GetIpNetTable to retrieve",T1106,Native API
NetServerEnum to get a list,T1106,Native API
NetServerGetInfoto retrieve the current configuration,T1106,Native API
CreateFile and WriteFile are used,T1106,Native API
"CreateProcessAsUser or CreateProcess is executed,",T1106,Native API
is created using the same API call;,T1106,Native API
Calls CryptEncrypt,T1106,Native API
it also invokes the API NTRaiseHardError.,T1106,Native API
undocumented Windows API that causes,T1106,Native API
"If the API fails to execute, the malware calls InitiateSystemShutdownExW",T1106,Native API
NetServerGetInfoto retrieve the current configuration for the local server,T1082,System Information Discovery
Obtains the IP address from the ClientIpAddress field,T1016,System Network Configuration Discovery
There are two approaches to using valid credentials to copy and execute the malware to a remote host:,T1078,Valid Accounts
is used to connect to a server using the default credentials,T1078,Valid Accounts
WMIC,T1047,Windows Management Instrumentation
C:\Windows\system32\wbem\wmic.exe /node,T1047,Windows Management Instrumentation
encodes it using XOR encoding with key,T1027,Obfuscated Files or Information
contains the original MBR that was encoded by XORing,T1027,Obfuscated Files or Information
which were previously encrypted,T1027,Obfuscated Files or Information
the original encoded MBR,T1027,Obfuscated Files or Information
"obtain keystrokes, and status of keyboard buffer",T1056.001,Input Capture: Keylogging
The malware only targets fixed drives on the system.,T1083,File and Directory Discovery
The malware will first start enumerating files in the directory it is being executed from.,T1083,File and Directory Discovery
the scheduled task is set to trigger 60 minutes after the malware execution by default.,T1053.005,Scheduled Task/Job: Scheduled Task
the scheduled task will trigger 30 minutes after the malware execution.,T1053.005,Scheduled Task/Job: Scheduled Task
Explanation of schtask parameters,T1053.005,Scheduled Task/Job: Scheduled Task
taskrun. Path and filename of the task to be run,T1053.005,Scheduled Task/Job: Scheduled Task
"For instance, immediately after execution, it loads itself in memory, and deletes itself from the disk.",T1027,Obfuscated Files or Information
delete important files,T1070.004,Indicator Removal: File Deletion
the configuration file will be deleted,T1070.004,Indicator Removal: File Deletion
threat actors use Themida packer to obfuscate the signature used for detection.,T1027,Obfuscated Files or Information
packed by noted tools,T1027,Obfuscated Files or Information
Themida-packed,T1027,Obfuscated Files or Information
upload/download file,T1105,Ingress Tool Transfer
remote shell functions.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"It supports proxy (Socks5),",T1090,Proxy
with SOCKS v5 server,T1090,Proxy
used to dump information from the victim’s Oracle database.,T1005,Data from Local System
an information stealer used to harvest internal information.,T1005,Data from Local System
Obfuscated PowerShell script,T1027,Obfuscated Files or Information
multi-layer obfuscation,T1027,Obfuscated Files or Information
to obfuscate their tools,T1027,Obfuscated Files or Information
have adopted more obfuscation techniques,T1027,Obfuscated Files or Information
Heavily obfuscated PowerShell script,T1027,Obfuscated Files or Information
the encrypted payload,T1027,Obfuscated Files or Information
the encrypted payload,T1027,Obfuscated Files or Information
to obfuscate control flow of program.,T1027,Obfuscated Files or Information
Heavy obfuscation in a simple but useful anti-analysis approach makes it difficult for security products to detect their scripts.,T1027,Obfuscated Files or Information
threat actors use multi-layered AES encryption and base64 encoding to obfuscate,T1027,Obfuscated Files or Information
obfuscate the execution flow of the program,T1027,Obfuscated Files or Information
the decryption algorithm,T1140,Deobfuscate/Decode Files or Information
decrypted with RC4 algorithm,T1140,Deobfuscate/Decode Files or Information
usage of a highly similar decryption algorithm,T1140,Deobfuscate/Decode Files or Information
to decrypt the payload,T1140,Deobfuscate/Decode Files or Information
decrypt it,T1140,Deobfuscate/Decode Files or Information
the decryption function into RC4,T1140,Deobfuscate/Decode Files or Information
they always have used DLL sideloading as their major technique to launch their malware.,T1574.002,Hijack Execution Flow: DLL Side-Loading
adopted DLL sideloading techniques to run their malware.,T1574.002,Hijack Execution Flow: DLL Side-Loading
used DLL sideloading to launch their malware,T1574.002,Hijack Execution Flow: DLL Side-Loading
"The malicious DLL “gtn.dll”, which we named as “ShellFang”, loads when a legitimate executable is launched.",T1574.002,Hijack Execution Flow: DLL Side-Loading
including API hashing and execution flow obfuscation through exception mechanism,T1027,Obfuscated Files or Information
Windows APIs are obfuscated via a hashing function and dynamically resolved in the run-time.,T1027,Obfuscated Files or Information
Necessary APIs will be dynamically resolved during execution.,T1027,Obfuscated Files or Information
"API obfuscation, and execution flow obfuscation",T1027,Obfuscated Files or Information
abusing exception mechanisms to obfuscate the execution flow of programs and Windows API hashing.,T1027,Obfuscated Files or Information
the final payload is an HTTPs Cobalt Strike beacon.,T1071.001,Application Layer Protocol: Web Protocols
by creating immediate tasks through GPO.,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
abused group policy objects (GPO) to install loaders,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
Propagation through GPO,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
they will submit immediate tasks to the hosts in the domain through GPO,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
As the hosts receive the task through GPO,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
"usually compile all necessary libraries in a single binary, making malware classification more difficult for analysts and resulting in a large binary",T1027,Obfuscated Files or Information
"Once the victim opens the document,",T1204.002,User Execution: Malicious File
injecting the shellcode into rundll32.exe,T1055,Process Injection
Shellcode which is used for code injection,T1055,Process Injection
proxy,T1090,Proxy
create scheduled tasks for persistence.,T1053.005,Scheduled Task/Job: Scheduled Task
to create a ImmediateTask,T1053.005,Scheduled Task/Job: Scheduled Task
Windows API,T1106,Native API
Windows APIs,T1106,Native API
backdoor is a basic remote shell,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\System32\cmd.exe /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
forcing its component SmadAVprotect32.exe to side-load their malicious DLL.,T1574.002,Hijack Execution Flow: DLL Side-Loading
the malware starts a function called bypassSMADAV,T1106,Native API
with the API function IsWindowVisible.,T1106,Native API
by IsWindowVisible function,T1106,Native API
calling the RegisterClass function prior to calling CreateWindow.,T1106,Native API
"Before a call to CreateWindowEx, you would usually first need to create a class by calling RegisterClass and then class CreateWindowEx.",T1106,Native API
the malware creates 2 scheduled tasks,T1053.005,Scheduled Task/Job: Scheduled Task
schtasks /Create /TN test /SC MINUTE /MO 15 /TR,T1053.005,Scheduled Task/Job: Scheduled Task
"the malware creates a scheduled task to execute its copy from this randomized path:

schtasks /Create /TN 8NaZrCq3pGeDRXKF /SC MINUTE /MO 15 /TR ""explorer.exe c:\users\public\8NaZrCq3pGeDRXKF.zip\8NaZr.exe"" /f",T1053.005,Scheduled Task/Job: Scheduled Task
"The final payload returned is a lightweight PowerShell backdoor,",T1105,Ingress Tool Transfer
It then picks one random C&C URL out of the three available and constructs a GET request,T1071.001,Application Layer Protocol: Web Protocols
sends them back to the server in POST request:,T1071.001,Application Layer Protocol: Web Protocols
After the validation of the JSON and Base64 decoding,T1140,Deobfuscate/Decode Files or Information
used by various actors to disable endpoint protection tools.,T1562.001,Impair Defenses: Disable or Modify Tools
techniques like process hollowing where the process is created in suspend mode and then replaced with malicious code.,T1055,Process Injection
The current system username,T1033,System Owner/User Discovery
The current username home folder,T1033,System Owner/User Discovery
"The system’s network interfaces (name, MacAddress, description)",T1082,System Information Discovery
was deployed using DLL side-loading,T1574.002,Hijack Execution Flow: DLL Side-Loading
"due to DLL side-loading, the loader/injector winutils.dll is loaded into memory and runs in the context",T1574.002,Hijack Execution Flow: DLL Side-Loading
abused to side-load,T1574.002,Hijack Execution Flow: DLL Side-Loading
Packed Rorschach loader and injector,T1027,Obfuscated Files or Information
the initial loader/injector winutils.dll is protected with UPX-style packing,T1027,Obfuscated Files or Information
"After unpacking, the sample loads",T1027,Obfuscated Files or Information
decrypted and injected,T1140,Deobfuscate/Decode Files or Information
and decrypts config,T1140,Deobfuscate/Decode Files or Information
"injected into notepad.exe, where the ransomware logic begins.",T1055,Process Injection
is injected into notepad.exe,T1055,Process Injection
"Disable the Windows firewall, using netsh.exe",T1562.001,Impair Defenses: Disable or Modify Tools
"When executed on a Windows Domain Controller (DC), the ransomware automatically creates a Group Policy, spreading itself to other machines within the domain.",T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
creates a group policy,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
creates another group policy,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
creates another group policy,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
deletes them from the original location.,T1070.004,Indicator Removal: File Deletion
creating a schedule task,T1053.005,Scheduled Task/Job: Scheduled Task
"that registers a scheduled task which runs immediately and upon user logon,",T1053.005,Scheduled Task/Job: Scheduled Task
"finds the relevant syscall numbers for NT APIs,",T1106,Native API
with the syscall instruction,T1106,Native API
the malware first creates a syscall table for NT APIs,T1106,Native API
Creation of syscall table for certain NT APIs.,T1106,Native API
It makes direct system calls using the “syscall” instruction.,T1106,Native API
Example use of direct syscall.,T1106,Native API
It uses GetSystemDefaultUILanguage and GetUserDefaultUILanguage to,T1106,Native API
The WinAPI CryptGenRandom is utilized,T1106,Native API
"is implemented via NtSetInformationFile using FileInformationClass FileRenameInformation,",T1106,Native API
Command Line Arguments,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the list of processes,T1057,Process Discovery
code is protected and obfuscated,T1027,Obfuscated Files or Information
This obfuscated process,T1027,Obfuscated Files or Information
"reusing multiple code chunks from DEP-allowed memory pages, called ROP gadgets.",T1055,Process Injection
"ROP-based attacks execute “RET” instructions without a prior “CALL” instruction, the running thread’s stack and the shadow stack values mismatch",T1055,Process Injection
"call other vfgadgets that are responsible for executing specific operations, like Argument LoadersInvokers and Collectors.",T1055,Process Injection
"Collectors are gadgets that retrieve a value already present in a register, and save it back into the attacker’s counterfeit object",T1055,Process Injection
leaked the stack pointer and retrieved the this pointer as a static offset from the stack.,T1055,Process Injection
"vfgadget address,",T1055,Process Injection
prepare the address of the Windows API we want to invoke along with its arguments.,T1106,Native API
the Windows API address and its arguments.,T1106,Native API
"invoke any API we like,",T1106,Native API
"began sending spam emails, mailing new malicious attachments to continue spreading.",T1566.001,Phishing: Spearphishing Attachment
discover commands using the Windows utilities systeminfo,T1082,System Information Discovery
systeminfo,T1082,System Information Discovery
systeminfo,T1082,System Information Discovery
ipconfig,T1016,System Network Configuration Discovery
ipconfig /all,T1016,System Network Configuration Discovery
ipconfig /all,T1016,System Network Configuration Discovery
"Remote access tools were used for command and control, such as Tactical RMM and Anydesk.",T1219,Remote Access Software
"the threat actors deployed Tactical RMM, a remote management agent, for additional access and persistence in the environment.",T1219,Remote Access Software
the threat actor accessed the environment using Tactical RMM to deploy Anydesk on the compromised host.,T1219,Remote Access Software
the threat actors proceeded to deploy several remote management tools across the environment.,T1219,Remote Access Software
Tactical RMM is a remote management software platform that uses a combination of agents to allow for remote management and access to systems.,T1219,Remote Access Software
"the threat actors added AnyDesk to the same server running Tactical RMM, providing an additional means of access prior to the deployment of ransomware.",T1219,Remote Access Software
used by the threat actor for the remote management of Tactical RMM Agent.,T1219,Remote Access Software
Using this RMM agent they proceeded to install AnyDesk on the host.,T1219,Remote Access Software
Tactical RMM Agent was installed by the threat actor on a server to ensure remote access,T1219,Remote Access Software
"The intrusion began when a user double clicked a LNK file, which then executed encoded Powershell commands",T1204.002,User Execution: Malicious File
"The Powershell script, when double clicked (executed),",T1204.002,User Execution: Malicious File
they also used tasklist,T1057,Process Discovery
"Next, they proceeded to transfer a beacon executable over SMB to the remote host’s ProgramData directory.",T1570,Lateral Tool Transfer
"The threat actors, however, proceeded along a more traditional path, using SMB file transfers and remote services to move laterally across domain controllers and several other servers",T1570,Lateral Tool Transfer
rasomware deployment to all hosts over SMB.,T1570,Lateral Tool Transfer
files transferred via SMB as SYSTEM on remote hosts.,T1570,Lateral Tool Transfer
an executable Cobalt Strike beacon was copied via SMB to a target machine,T1570,Lateral Tool Transfer
This beacon was then successfully executed via WMI,T1047,Windows Management Instrumentation
then executed via WMI.,T1047,Windows Management Instrumentation
wmic,T1047,Windows Management Instrumentation
setup a Registry Run Key to maintain persistence on the beachhead host.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
established persistence via a run key.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
commands to download an Emotet DLL onto the computer.,T1105,Ingress Tool Transfer
the threat actors dropped Powertool64.exe and dontsleep.exe in preparation for their final actions.,T1105,Ingress Tool Transfer
the threat actors then dropped SoftPerfect’s Network Scanner,T1105,Ingress Tool Transfer
dropped and executed on the server,T1105,Ingress Tool Transfer
"Windows net commands were run,",T1059.003,Command and Scripting Interpreter: Windows Command Shell
threat actors proceeded to run the net commands,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"the threat actors conducted further discovery tasks running find.bat and p.bat,",T1059.003,Command and Scripting Interpreter: Windows Command Shell
and a batch file 1.bat were dropped on the host and the batch file was executed,T1059.003,Command and Scripting Interpreter: Windows Command Shell
two batch files were run.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
The first find.bat was used to run,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\System32\cmd.exe /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd.exe /c start,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the threat actor executed a batch script,T1059.003,Command and Scripting Interpreter: Windows Command Shell
They then proceeded to dump credentials from the LSASS process on the host.,T1003.001,OS Credential Dumping: LSASS Memory
the ‘mimikatz’ string in the Netlogon event that is used by the Mimikatz Zerologon implementation.,T1003.001,OS Credential Dumping: LSASS Memory
"Process access to LSASS was observed, likely to dump credentials",T1003.001,OS Credential Dumping: LSASS Memory
The Granted Access level matches know indicators for Mimikatz,T1003.001,OS Credential Dumping: LSASS Memory
"request access level of 0x0040 (64) to LSASS, as well indicating other credential access tools may have been in use by the threat actor.",T1003.001,OS Credential Dumping: LSASS Memory
With some further process injection,T1055,Process Injection
The threat actor was observed process injecting into legitimate process,T1055,Process Injection
from a process that was injected with Cobalt Strike.,T1055,Process Injection
Injected Process Name,T1055,Process Injection
the processes used for injection,T1055,Process Injection
"The specific mechanism used to inject into a foreign process, was injecting arbitrary code into its memory space, and executing it as a remotely created thread",T1055,Process Injection
from an injected process,T1055,Process Injection
A flight of netlogon authentications were observed from the beachhead host to the domain controller as a possible attempt at exploiting the domain controller.,T1078,Valid Accounts
"After choosing a new server and connecting via RDP,",T1021.001,Remote Services: Remote Desktop Protocol
"From there, the threat actors began connecting to other hosts via RDP, including the a backup server.",T1021.001,Remote Services: Remote Desktop Protocol
did RDP to a few other servers,T1021.001,Remote Services: Remote Desktop Protocol
traces of RDP (Remote Desktop Protocol) connections were discovered on multiple compromised hosts utilized for lateral movement,T1021.001,Remote Services: Remote Desktop Protocol
They started by connecting to a new server via RDP,T1021.001,Remote Services: Remote Desktop Protocol
"Once establishing the RDP connection, they deployed Powertool64.exe,",T1021.001,Remote Services: Remote Desktop Protocol
The threat actor kept the remote desktop session alive,T1021.001,Remote Services: Remote Desktop Protocol
to execute encoded scripts.,T1027,Obfuscated Files or Information
The script will decode itself,T1140,Deobfuscate/Decode Files or Information
The decoded base 64 content,T1140,Deobfuscate/Decode Files or Information
is a Base64 encoded script with various components split into different variables for obfuscation purposes.,T1027,Obfuscated Files or Information
A service was also created for the agent.,T1543.003,Create or Modify System Process: Windows Service
service was installed in the system,T1543.003,Create or Modify System Process: Windows Service
svcService Type: user mode serviceService Start Type: auto startService Account: LocalSystem,T1543.003,Create or Modify System Process: Windows Service
a separate service was created for that agent.,T1543.003,Create or Modify System Process: Windows Service
service was installed in the system,T1543.003,Create or Modify System Process: Windows Service
service was installed in the system,T1543.003,Create or Modify System Process: Windows Service
--serviceService Type: user mode serviceService Start Type: auto startService Account: LocalSystem,T1543.003,Create or Modify System Process: Windows Service
Service Type: user mode serviceService Start Type: auto startService Account: LocalSystem,T1543.003,Create or Modify System Process: Windows Service
The threat actor was observed creating remote services,T1543.003,Create or Modify System Process: Windows Service
"This occurred from rundll32.exe, which was previously used to execute and run Cobalt Strike.",T1218.011,System Binary Proxy Execution: Rundll32
"C:\Windows\System32\cmd.exe /c rundll32.exe C:\ProgramData\x86.dll, StartA",T1218.011,System Binary Proxy Execution: Rundll32
delete its process file,T1070.004,Indicator Removal: File Deletion
delete the driver files.,T1070.004,Indicator Removal: File Deletion
removing files from the system.,T1070.004,Indicator Removal: File Deletion
The threat actor was observed deleting files that had been dropped to disk,T1027,Obfuscated Files or Information
whoami /groups,T1033,System Owner/User Discovery
The threat actor was observed creating remote services in order to execute beacon DLL files,T1569.002,System Services: Service Execution
the threat actors began to review sensitive documents,T1005,Data from Local System
Both HTTP and HTTPS were observed to be used.,T1071.001,Application Layer Protocol: Web Protocols
Infected email attachments,T1566.001,Phishing: Spearphishing Attachment
"obtaining relevant device data, such as OS version and architecture, hardware ID, CPU, RAM, screen resolution, system language, etc.",T1082,System Information Discovery
"collects information, primarily system information",T1082,System Information Discovery
can take away system,T1082,System Information Discovery
exfiltrate files and extract data from specific applications.,T1005,Data from Local System
"acquire browsing histories, Internet cookies, usernames/passwords, personally identifiable details, credit card numbers, and other highly sensitive information from browsers.",T1005,Data from Local System
target stored browser data,T1005,Data from Local System
collects sensitive information from the victim’s machine,T1005,Data from Local System
"collects cookie information, search histories, and key inputs from browsers",T1005,Data from Local System
collect inside of the “Web Data” SQLite file,T1005,Data from Local System
sensitive data from the victim’s machine.,T1005,Data from Local System
"usernames/passwords,",T1078,Valid Accounts
include saved credentials,T1078,Valid Accounts
run under the name “tmp.exe” by unpacking itself to the “C:\Users\admin\AppData\Local\Temp\” file path.,T1036.005,Masquerading: Match Legitimate Name or Location
Registry Key Sets,T1112,Modify Registry
transmits information as a zip file,T1041,Exfiltration Over C2 Channel
sends this information to its C2 server,T1041,Exfiltration Over C2 Channel
C2 is transmitted as a zip file during the POST request.,T1041,Exfiltration Over C2 Channel
transferred to the C2 server as a zip file.,T1041,Exfiltration Over C2 Channel
transfers them to the C2 address,T1041,Exfiltration Over C2 Channel
"many obfuscated strings that are being covered by a random string, “edx765“, to evade detection.",T1027,Obfuscated Files or Information
"obfuscated information,",T1027,Obfuscated Files or Information
passes the obfuscated string to a function that strips the arbitrary string and delivers the original string,T1140,Deobfuscate/Decode Files or Information
passes the obfuscated string to a function that strips the arbitrary string and delivers the original string.,T1027,Obfuscated Files or Information
"Making a ‘POST’ request,",T1071.001,Application Layer Protocol: Web Protocols
multiple POST requests to the “c2/sock” address,T1071.001,Application Layer Protocol: Web Protocols
accessed C2 while visiting port 80,T1071.001,Application Layer Protocol: Web Protocols
they are instructed to click “Confirm” to view a message from “Express.”,T1204.002,User Execution: Malicious File
"The user is also asked to permit push notifications in the browser,",T1204.002,User Execution: Malicious File
"Once decrypted, the configuration file reveals several parameters,",T1140,Deobfuscate/Decode Files or Information
Decryption exclusion list,T1140,Deobfuscate/Decode Files or Information
decrypted using the RC4 algorithm with a hard-coded key in the resource.,T1140,Deobfuscate/Decode Files or Information
send the decryption program,T1140,Deobfuscate/Decode Files or Information
and decrypted,T1140,Deobfuscate/Decode Files or Information
decrypted using the RC4 algorithm with a hardcoded key in the resource.,T1140,Deobfuscate/Decode Files or Information
the hardcoded key to decrypt the configuration file.,T1140,Deobfuscate/Decode Files or Information
to decrypt the configuration file.,T1140,Deobfuscate/Decode Files or Information
Get configuration file and decrypt it,T1140,Deobfuscate/Decode Files or Information
Decryptor download,T1140,Deobfuscate/Decode Files or Information
The decryptor is delivered in a zip archive containing the decryptor executable,T1140,Deobfuscate/Decode Files or Information
the decryptor to clean up their environment.,T1140,Deobfuscate/Decode Files or Information
"At the end of the decryption process, the program indicates the number of decrypted files",T1140,Deobfuscate/Decode Files or Information
Decryptor has finished the decryption process,T1140,Deobfuscate/Decode Files or Information
Decryptor execution,T1140,Deobfuscate/Decode Files or Information
"The decryptor program appears unique and is linked to one victim specifically. In our example, it only decrypts the files",T1140,Deobfuscate/Decode Files or Information
"one to get information about the machine, such as the operating system version,",T1082,System Information Discovery
one to get processes,T1057,Process Discovery
"reflective DLL loading, to inject a DLL from memory.",T1055,Process Injection
Use Windows API functions to inject DLL,T1055,Process Injection
a regular Bitmap (open matrix image format used by Windows) that can be used by malware to execute code or as a payload dropper,T1027,Obfuscated Files or Information
The image’s pixels are an actual binary representation of the payload.,T1027,Obfuscated Files or Information
This process can be summarized as Exe -> Resources -> BMP with embedded data in pixels fetched,T1027,Obfuscated Files or Information
The unpacked malware,T1027,Obfuscated Files or Information
the configuration file encrypted.,T1027,Obfuscated Files or Information
PowerShell Script uses Base64 and hexadecimal encoding and XOR-encryption,T1027,Obfuscated Files or Information
". The malware will try first to write in the registry-hive “HKEY_LOCAL_MACHINE” but if it cannot create it, it will use the registry-hive “HKEY_CURRENT_USER”:",T1112,Modify Registry
Write in the registry,T1112,Modify Registry
After the writing in the registry has been completed,T1112,Modify Registry
write in the registry information,T1112,Modify Registry
Create its own registry key in \SOFTWARE\<uniquename>,T1112,Modify Registry
using the functions “SHGetFolderPathlW” and “CreateFileW”,T1106,Native API
with the function “WriteFile”.,T1106,Native API
Use Windows API functions,T1106,Native API
The batch script will delete the malware sample with its path using the command “del” and finally delete the bat file with the command “del %0%”.,T1070.004,Indicator Removal: File Deletion
the malware uses the “del” command,T1070.004,Indicator Removal: File Deletion
the malware tries to remove itself from the machine to avoid being detected and analyzed by security researchers,T1070.004,Indicator Removal: File Deletion
deletes the ransom note,T1070.004,Indicator Removal: File Deletion
The batch script,T1059.003,Command and Scripting Interpreter: Windows Command Shell
The download is done directly from the NetWalker Tor site,T1105,Ingress Tool Transfer
they will be able to download the decryptor,T1105,Ingress Tool Transfer
Place a value on RunOnce key,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
"performing password spray,",T1110,Brute Force
Activity from a password-spray associated IP address.,T1110,Brute Force
an IP address that had been identified as participating in password spray,T1110,Brute Force
credential stuffing attacks,T1110,Brute Force
is distributed through exposed Remote Desktop Protocol (RDP) setups,T1021.001,Remote Services: Remote Desktop Protocol
a heavy emphasis on Remote Desktop Protocols.,T1021.001,Remote Services: Remote Desktop Protocol
by brute-forcing them,T1110,Brute Force
"using other known vulnerabilities for initial access, i.e. vulnerabilities in Citrix gateway devices",T1190,Exploit Public-Facing Application
"uses other tools to gather credentials that include Mimikatz, LaZagne, and NirSoft’s NetPass.",T1003.001,OS Credential Dumping: LSASS Memory
It uses bat files,T1059.003,Command and Scripting Interpreter: Windows Command Shell
A batch file to stop services,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the stolen credentials are used to reach high-value machines like servers,T1078,Valid Accounts
WMIC /node,T1047,Windows Management Instrumentation
reg add HKLM\software\Microsoft\Windows\CurrentVersion\Policies\System,T1112,Modify Registry
makes use of API GetTickCount / QueryPerformanceCounter,T1106,Native API
the help of ShellExecute API,T1106,Native API
delete itself from the target systems after infection,T1027,Obfuscated Files or Information
It also drops and installs,T1105,Ingress Tool Transfer
sets the following registry entry to open the downloaded PDF file every time the computer boots,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\iXqrVo,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
adding the HIDDEN file attribute,T1564.001,Hide Artifacts: Hidden Files and Directories
adds the HIDDEN file attribute to the file:,T1564.001,Hide Artifacts: Hidden Files and Directories
taking command line arguments,T1059.003,Command and Scripting Interpreter: Windows Command Shell
command line argument,T1059.003,Command and Scripting Interpreter: Windows Command Shell
to download and execute a remote “note.hta”:,T1105,Ingress Tool Transfer
to download another remote file,T1105,Ingress Tool Transfer
the download and execution,T1105,Ingress Tool Transfer
uses PowerShell to pull and run,T1105,Ingress Tool Transfer
downloading and executing,T1105,Ingress Tool Transfer
downloads and runs,T1105,Ingress Tool Transfer
downloads and executes,T1105,Ingress Tool Transfer
downloads and executes,T1105,Ingress Tool Transfer
downloads and executes,T1105,Ingress Tool Transfer
downloads and executes,T1105,Ingress Tool Transfer
downloads and executes,T1105,Ingress Tool Transfer
the download of wed.hta,T1105,Ingress Tool Transfer
"disables AMSI by hijacking the COM server, changing it from ""%windir%\system32\amsi.dll"" to ""C:\IDontExist.dll"".",T1562.001,Impair Defenses: Disable or Modify Tools
performs the following actions to alter Windows Defender settings,T1562.001,Impair Defenses: Disable or Modify Tools
Adds the following exclusions to Windows DefenderExtensions,T1562.001,Impair Defenses: Disable or Modify Tools
Allows known Windows Defender Threat IDs to execute,T1562.001,Impair Defenses: Disable or Modify Tools
Disables Windows Defender Attack Surface Reduction (ASR) rules,T1562.001,Impair Defenses: Disable or Modify Tools
"Disables the following Windows Defender features:Intrusion Prevention System
IO AV Protection (does not scan downloaded files and attachments)
Realtime monitoring
Script scanning
Controlled folder access protection
PUA protection
Scheduled scan",T1562.001,Impair Defenses: Disable or Modify Tools
Sets Network Protection to audit mode in Windows Defender,T1562.001,Impair Defenses: Disable or Modify Tools
Disables MAPS (Microsoft Active Protection Service) reporting,T1562.001,Impair Defenses: Disable or Modify Tools
Allows severe/high/moderate/low-level threats to execute,T1562.001,Impair Defenses: Disable or Modify Tools
"Disables the ""administrator in Admin Approval Mode"" user type (disables UAC prompts)",T1562.001,Impair Defenses: Disable or Modify Tools
Stops the WinDefend service (Windows Defender),T1562.001,Impair Defenses: Disable or Modify Tools
Disables the startup of the WinDefend service,T1562.001,Impair Defenses: Disable or Modify Tools
Deletes the WinDefend service,T1562.001,Impair Defenses: Disable or Modify Tools
Stops the Microsoft Defender Antivirus Network Inspection Service (WdNisSvc),T1562.001,Impair Defenses: Disable or Modify Tools
designed to hamper Windows Defender,T1562.001,Impair Defenses: Disable or Modify Tools
to fool potential victims into opening them.,T1204.002,User Execution: Malicious File
users still need to manually mount them and run the fake PDFs to trigger the infection chain,T1204.002,User Execution: Malicious File
Manually executing the lnk file triggers,T1204.002,User Execution: Malicious File
Manual interactions are required,T1204.002,User Execution: Malicious File
a lot of junk code,T1027,Obfuscated Files or Information
keylogging,T1056.001,Input Capture: Keylogging
taking screenshots,T1113,Screen Capture
to load a binary into memory that injects,T1055,Process Injection
can modify group policy for privilege escalation and defense evasion,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
can modify group policy for privilege escalation and defense evasion.,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
Attempts to delete malicious batch files.,T1070.004,Indicator Removal: File Deletion
makes modifications to the Registry.,T1112,Modify Registry
"adds a custom icon to the registry,",T1112,Modify Registry
modifies the registry,T1112,Modify Registry
creating a registry key HKCU\Control Panel\Desktop,T1112,Modify Registry
Disables Windows Defender with batch scripts,T1562.001,Impair Defenses: Disable or Modify Tools
with batch scripts,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Uses batch scripts,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the command line argument,T1059.003,Command and Scripting Interpreter: Windows Command Shell
uses Mimikatz to dump passwords.,T1003.001,OS Credential Dumping: LSASS Memory
Uses GetComputerName to query the computer name.,T1082,System Information Discovery
has used RDP for lateral movement.,T1021.001,Remote Services: Remote Desktop Protocol
has installed and used legitimate tools such as TeamViewer and AnyConnect on targeted systems.,T1219,Remote Access Software
"iterate through the entire file system,",T1083,File and Directory Discovery
Victims receive spear phishing emails with attached malicious zip files,T1566.001,Phishing: Spearphishing Attachment
encoded PowerShell scripts,T1027,Obfuscated Files or Information
scripts to download additional scripts.,T1105,Ingress Tool Transfer
Creates benign-looking services for the ransomware binary.,T1543.003,Create or Modify System Process: Windows Service
Creates benign-looking services for the ransomware binary.,T1543.003,Create or Modify System Process: Windows Service
Lists internal IP addresses,T1016,System Network Configuration Discovery
has installed and used PsExec to execute payloads on remote hosts.,T1569.002,System Services: Service Execution
 Malicious actors typically gain entry to organizations’ Microsoft 365 environments by abusing either stolen account credentials,T1078,Valid Accounts
malicious actors behaving in predictable ways once they gain access to customer Microsoft 365 environment.,T1078,Valid Accounts
Actor signs in to a Microsoft 365 account from an endpoint,T1078,Valid Accounts
malicious actor signing in to a Microsoft 365 account,T1078,Valid Accounts
which the actor took after logging in to a user’s Microsoft 365 account,T1078,Valid Accounts
a malicious actor was observed signing in to a Microsoft 365 account,T1078,Valid Accounts
began with an actor signing into an internal user’s Microsoft 365 account from a VPN,T1078,Valid Accounts
a spoof of the legitimate ‘PerfectData’ software designed to masquerade a malicious application as legitimate,T1036.005,Masquerading: Match Legitimate Name or Location
brute-force activity,T1110,Brute Force
The emails included an attachment named ‘Credit Transfer Copy.html’,T1566.001,Phishing: Spearphishing Attachment
"capable of modifying Windows UAC prompt, disabling Windows Defender notifications, disabling Task Manager, disabling command prompt, preventing users from accessing Windows registry tools, disabling the Run command, and modifying the display timeout",T1562.001,Impair Defenses: Disable or Modify Tools
performing antivirus tampering,T1562.001,Impair Defenses: Disable or Modify Tools
the script retrieves NSudo and modifies Windows UAC prompt behavior by allowing administrators to perform operations without authentication or consent prompts,T1562.001,Impair Defenses: Disable or Modify Tools
"Disabling Windows Defender notifications, Disabling Task Manager, Disabling command prompt, Preventing users from accessing Windows registry tools, Disabling Run command, Modifying the display timeout",T1562.001,Impair Defenses: Disable or Modify Tools
threat actor(s) made sure to add more paths and folders to Windows Defender exclusion including %TEMP% and C:\Windows\* as well as adding .ps1 (PowerShell) extension to the exclusion list.,T1562.001,Impair Defenses: Disable or Modify Tools
"Disabling Windows Defender notifications, Task Manager and Command Prompt",T1562.001,Impair Defenses: Disable or Modify Tools
recursively removes the implementation of Windows Defender IOfficeAntiVirus,T1562.001,Impair Defenses: Disable or Modify Tools
It then adds the extensions such as exe and DLL as exclusions to Windows Defender.,T1562.001,Impair Defenses: Disable or Modify Tools
performs the antivirus checks,T1518.001,Software Discovery: Security Software Discovery
The script checks the host against the list of antiviruses,T1518.001,Software Discovery: Security Software Discovery
antivirus check script,T1518.001,Software Discovery: Security Software Discovery
to download the malicious update.bat file from the C2 domain,T1105,Ingress Tool Transfer
has the capability of sending additional payloads to the hosts,T1105,Ingress Tool Transfer
pulling additional BatLoader payloads and scripts from C2,T1105,Ingress Tool Transfer
retrieves the same files from the C2,T1105,Ingress Tool Transfer
"executing scripts and commands retrieved from C2 such as ps1, bat, vbs, and exe",T1105,Ingress Tool Transfer
the script retrieves the Cobalt Strike payload,T1105,Ingress Tool Transfer
retrieves and executes the runanddelete.bat and scripttodo.ps1 scripts from the C2,T1105,Ingress Tool Transfer
then the full set of malware is retrieved from C2,T1105,Ingress Tool Transfer
retrieving malware from C2,T1105,Ingress Tool Transfer
The batch file was executed,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the batch file to run,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
The batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
The batch script,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the username,T1033,System Owner/User Discovery
using the username,T1033,System Owner/User Discovery
username,T1033,System Owner/User Discovery
"obtains all entries within the IPs starting with 192., 10., and .172 in the ARP cache table",T1016,System Network Configuration Discovery
it then checks the amount of IPs found in the ARP table,T1016,System Network Configuration Discovery
ARP table,T1016,System Network Configuration Discovery
the GPG-encrypted files:,T1027,Obfuscated Files or Information
the encrypted data,T1027,Obfuscated Files or Information
the encrypted strings reside within the function,T1027,Obfuscated Files or Information
The data stored in the BSS section is encoded,T1027,Obfuscated Files or Information
the encoded data in the BSS section,T1027,Obfuscated Files or Information
on the API calls QueryPerformanceFrequency and QueryPerformanceCounter,T1106,Native API
from API call GetSystemTimeAsFileTime,T1106,Native API
using the API,T1106,Native API
The traffic beaconing contains the following pattern that will be encrypted with the AES key extracted from the compressed blob,T1573.001,Encrypted Channel: Symmetric Cryptography
the encrypted with AES-128 beacon,T1573.001,Encrypted Channel: Symmetric Cryptography
OS version and system type,T1082,System Information Discovery
computer name,T1082,System Information Discovery
computer name,T1082,System Information Discovery
screenshot,T1113,Screen Capture
"then collects the credentials, host information, files,",T1005,Data from Local System
Syncro RMM is a Remote Monitoring and Management tool used to control and manage devices remotely.,T1219,Remote Access Software
tool can be used as a persistence mechanism and remote accessing,T1219,Remote Access Software
Syncro RMM can also be used as a persistence mechanism,T1219,Remote Access Software
leverages SOCKS5,T1095,Non-Application Layer Protocol
leverages SOCKS5 proxies to hide malicious traffic,T1090,Proxy
task scheduling,T1053.005,Scheduled Task/Job: Scheduled Task
it proceeds with scheduled task creation,T1053.005,Scheduled Task/Job: Scheduled Task
run the scheduled task every 2 minutes is  start.,T1053.005,Scheduled Task/Job: Scheduled Task
the scheduled task,T1053.005,Scheduled Task/Job: Scheduled Task
creates the registry key,T1112,Modify Registry
creating the registry key,T1112,Modify Registry
These words are used to build the registry value names.,T1112,Modify Registry
recursively removes the implementation of Windows Defender IOfficeAntiVirus under HKLM:\SOFTWARE\Microsoft\AMSI\Providers\{2781761E-28E0-4109-99FE-B9D127C57AFE}.,T1112,Modify Registry
enables the data transfer with URL syntax for protocols such as HTTP/HTTPS,T1071.001,Application Layer Protocol: Web Protocols
runs it via rundll32.exe,T1218.011,System Binary Proxy Execution: Rundll32
injects itself into explorer.exe,T1055,Process Injection
injecting itself into a running explorer.exe process.,T1055,Process Injection
injecting itself into a running explorer.exe process,T1055,Process Injection
"The script performs process injection using the API such as OpenThread (to create a handle to an existing process), VirtualAlloc (memory allocation in the chosen process), and QueueUserAPC, the thread that the APC (Asynchronous Procedure Calls) is queued to has to enter an alertable state",T1055,Process Injection
"accessing browser credentials and cookies, Thunderbird and Outlook profiles",T1552.001,Unsecured Credentials: Credentials In Files
malware creates the persistence via Registry Run Keys.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
creates a persistence via Registry Run Keys under HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
it stores three embedded binaries within the unpacked payload.,T1027,Obfuscated Files or Information
the embedded compressed binaries,T1027,Obfuscated Files or Information
compressed binary,T1027,Obfuscated Files or Information
unpacked payload,T1027,Obfuscated Files or Information
The binaries are compressed using APLib compression algorithm.,T1027,Obfuscated Files or Information
The unpacked sample is approximately 540 KB,T1027,Obfuscated Files or Information
The unpacked sample is approximately 540 KB,T1027,Obfuscated Files or Information
decompress data blobs,T1140,Deobfuscate/Decode Files or Information
decompress them,T1140,Deobfuscate/Decode Files or Information
The decompression function,T1140,Deobfuscate/Decode Files or Information
Decrypted strings,T1140,Deobfuscate/Decode Files or Information
Decompiled decryption function,T1140,Deobfuscate/Decode Files or Information
Decryption function in Python,T1140,Deobfuscate/Decode Files or Information
The decryption function,T1140,Deobfuscate/Decode Files or Information
The decryption function,T1140,Deobfuscate/Decode Files or Information
Decryption function,T1140,Deobfuscate/Decode Files or Information
the decryption function,T1140,Deobfuscate/Decode Files or Information
APLib decompression function,T1140,Deobfuscate/Decode Files or Information
decrypts them,T1140,Deobfuscate/Decode Files or Information
"The decryption function is shown below, the decryption function can be represented as the following pseudocode:",T1140,Deobfuscate/Decode Files or Information
The GPG decryption routine,T1140,Deobfuscate/Decode Files or Information
GPG decryption,T1140,Deobfuscate/Decode Files or Information
wmic,T1047,Windows Management Instrumentation
reg.exe query,T1012,Query Registry
that pulls the written data from the registry under HKEY_CURRENT_USER\Software\AppDataLow\Software\Microsoft\<registry_value>>,T1012,Query Registry
the Tor communication capability,T1090,Proxy
Configured for WMI persistence,T1047,Windows Management Instrumentation
WMI Persistence,T1047,Windows Management Instrumentation
"As tasklist uses WMI “under the hood,",T1047,Windows Management Instrumentation
the malicious authentications into victim O365 tenants had originated from within the victim’s own network.,T1078,Valid Accounts
the threat actor was making authentications to O365,T1078,Valid Accounts
Log in to O365 as a user with privileged access to cloud resources.,T1078,Valid Accounts
the threat actor succeeded in authenticating into victim O365 tenants,T1078,Valid Accounts
This threat actor abused access to accounts in the Cloud Solution Partner’s environment with legitimate delegated administrative privileges to then gain access to several customers’ O365 environments,T1078,Valid Accounts
the threat actor connected to the victim’s O365 tenant,T1078,Valid Accounts
the user account used to connect to the victim’s O365 tenant,T1078,Valid Accounts
the threat actor managed to continue to access the victim’s cloud environment,T1078,Valid Accounts
the accounts that were used to authenticate to the cloud.,T1078,Valid Accounts
the threat actor used a compromised O365 administrator account,T1078,Valid Accounts
The threat actor created new O365 Service Principals to maintain access to victim’s environments,T1078,Valid Accounts
The threat actor used accounts with Delegated Administrator rights to access other O365 tenants,T1078,Valid Accounts
the threat actor leveraged different credentials for each step while moving laterally through the victim’s network,T1078,Valid Accounts
using privileged accounts and then accessed the wiki using a different set of credentials.,T1078,Valid Accounts
the threat actor began attempting to connect into the environment via VPN,T1078,Valid Accounts
The threat actor attempted to log in to the VPN using several user accounts,T1078,Valid Accounts
threat actor had knowledge of these accounts and used them on the correct systems,T1078,Valid Accounts
the threat actor connected into the victim’s environment via a VPN,T1078,Valid Accounts
The Threat actor also used valid accounts to create persistence within the environment,T1078,Valid Accounts
to establish a Remote Desktop Protocol (RDP) session to an internal server,T1021.001,Remote Services: Remote Desktop Protocol
establish another RDP session to a different internal server,T1021.001,Remote Services: Remote Desktop Protocol
the threat actor connected via RDP to a user’s workstation,T1021.001,Remote Services: Remote Desktop Protocol
the threat actor’s RDP session.,T1021.001,Remote Services: Remote Desktop Protocol
The threat actor established RDP sessions to internal servers,T1021.001,Remote Services: Remote Desktop Protocol
The threat actor connected via Remote Desktop,T1021.001,Remote Services: Remote Desktop Protocol
the user the threat actor used to RDP,T1021.001,Remote Services: Remote Desktop Protocol
the threat actor connected via Remote Desktop to a Domain Controller,T1021.001,Remote Services: Remote Desktop Protocol
"The threat actor used both privileged and non-privileged accounts for RDP throughout the environment, depending on the target system",T1021.001,Remote Services: Remote Desktop Protocol
using a domain service account.,T1078,Valid Accounts
using a domain administrator’s account.,T1078,Valid Accounts
the threat actor could have easily used a second domain administrator account,T1078,Valid Accounts
The threat actor accomplished this by using administrative accounts,T1078,Valid Accounts
a given user account was also authenticating to Active Directory from a given source IP address two years prior,T1078,Valid Accounts
the user account was known to have recently been abused by the threat actor,T1078,Valid Accounts
the threat actor accessing the wiki as users who would be considered “non-privileged”,T1078,Valid Accounts
A local account was used by the Threat Actor,T1078,Valid Accounts
"to connect via SMB to targeted users, and then copy their Chrome profile directories as well as data protection API (DPAPI) data.",T1570,Lateral Tool Transfer
the threat actor connected via Remote Desktop to a Domain Controller and copied the DSInternals10 PowerShell module to the system.,T1570,Lateral Tool Transfer
the threat actor must first decrypt them,T1140,Deobfuscate/Decode Files or Information
they decrypted the cookies file using the user’s DPAPI key.,T1140,Deobfuscate/Decode Files or Information
The decryption of the cookies,T1140,Deobfuscate/Decode Files or Information
deleted the specific history items related to threat actor activity,T1070.004,Indicator Removal: File Deletion
Attempted to blend in with a file name that matched the system name it resided on,T1036.005,Masquerading: Match Legitimate Name or Location
Attempted to blend in with a file name that matched the system name it resided on,T1036.005,Masquerading: Match Legitimate Name or Location
With the binary named to masquerade as a legitimate file on the system,T1036.005,Masquerading: Match Legitimate Name or Location
AdFind was renamed to masquerade as a legitimate Windows binary,T1036.005,Masquerading: Match Legitimate Name or Location
"The threat actor renamed their utilities to masquerade as legitimate system binaries (AdFind as svchost.exe), match the system’s role (GoldMax), or appear legitimate (TrailBlazer as an apparent Adobe utility).",T1036.005,Masquerading: Match Legitimate Name or Location
the threat actor renamed their systems prior to connecting to victim’s VPNs to match the victim’s system naming convention,T1036.005,Masquerading: Match Legitimate Name or Location
Masquerades its command-and-control (C2) traffic as legitimate Google Notifications HTTP requests,T1071.001,Application Layer Protocol: Web Protocols
placed in a hidden directory,T1564.001,Hide Artifacts: Hidden Files and Directories
directories with random names of a consistent length were navigated to by the same user that ran the tool.,T1083,File and Directory Discovery
ListUsers,T1033,System Owner/User Discovery
The threat actor attempted to remotely list running processes on systems using tasklist.exe,T1057,Process Discovery
process listing,T1057,Process Discovery
This remote process listing,T1057,Process Discovery
the threat actor was running tasklist remotely on these systems specifically to see which of the target systems was running Google Chrome.,T1057,Process Discovery
The threat actor regularly interrogated other systems using tasklist.exe,T1057,Process Discovery
the use of a PowerShell script to execute Mimikatz in-memory,T1003.001,OS Credential Dumping: LSASS Memory
to execute the Mimikatz commands ‘privilege::debug sekurlsa::logonpasswords “lsadump::lsa /patch”‘ in-memory,T1003.001,OS Credential Dumping: LSASS Memory
the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.,T1027,Obfuscated Files or Information
used a heavily obfuscated PowerShell script,T1027,Obfuscated Files or Information
enumerating current directory ,T1083,File and Directory Discovery
tries to enumerate the current directory,T1083,File and Directory Discovery
crawl the filesystem,T1083,File and Directory Discovery
The decrypted payload,T1140,Deobfuscate/Decode Files or Information
Decrypted payload ,T1140,Deobfuscate/Decode Files or Information
The decrypted payload,T1140,Deobfuscate/Decode Files or Information
try to decrypt it using the RC4 encryption scheme with the key,T1140,Deobfuscate/Decode Files or Information
then decrypts and communicates to,T1140,Deobfuscate/Decode Files or Information
decodes the embedded shellcode,T1140,Deobfuscate/Decode Files or Information
the encrypted payload,T1027,Obfuscated Files or Information
contain encrypted C2 strings,T1027,Obfuscated Files or Information
encrypted payload ,T1027,Obfuscated Files or Information
Embedded encrypted payload ,T1027,Obfuscated Files or Information
DLL has an encrypted payload embedded in it.,T1027,Obfuscated Files or Information
The embedded DLL,T1027,Obfuscated Files or Information
side loading “ffmpeg.dll”.,T1574.002,Hijack Execution Flow: DLL Side-Loading
that have Base64 and AES encrypted C2’s appended to them,T1573.001,Encrypted Channel: Symmetric Cryptography
using NetWkstaGetInfo() API.,T1106,Native API
"domain name, Hostname and OS Version",T1082,System Information Discovery
The info stealer also collects information on infected hosts,T1005,Data from Local System
Manipulates registry,T1112,Modify Registry
decrypting and executing the shellcode,T1140,Deobfuscate/Decode Files or Information
decrypt the payload,T1140,Deobfuscate/Decode Files or Information
The decrypted payload,T1140,Deobfuscate/Decode Files or Information
decrypts a shellcode,T1140,Deobfuscate/Decode Files or Information
performed through the CryptUnprotectData API function,T1106,Native API
an encrypted shellcode payload.,T1027,Obfuscated Files or Information
Encrypts a provided payload,T1027,Obfuscated Files or Information
DLLs with the names ualapi.dll and ncobjapi.dll being sideloaded,T1574.002,Hijack Execution Flow: DLL Side-Loading
"collects system information and browser history, then sends it to the C2 server.",T1041,Exfiltration Over C2 Channel
downloads an infostealer and starts it.,T1105,Ingress Tool Transfer
Performs payload injections through syscalls via mapping a shellcode to a remote process and creating a remote thread.,T1055,Process Injection
The driver collects information about installed AV filters,T1518.001,Software Discovery: Security Software Discovery
Connects to a given host via a socket and waits for the server to send data.,T1095,Non-Application Layer Protocol
"Manipulates (creates, lists, starts, stops and deletes) services.",T1543.003,Create or Modify System Process: Windows Service
attackers placed,T1105,Ingress Tool Transfer
attackers placed,T1105,Ingress Tool Transfer
administrator credentials,T1078,Valid Accounts
compromised administrative [T1078.001] accounts,T1078,Valid Accounts
user,T1078,Valid Accounts
Access to valid,T1078,Valid Accounts
locate high value assets in order to exfiltrate data,T1005,Data from Local System
Spearphishing emails with malicious attachments,T1566.001,Phishing: Spearphishing Attachment
attached to spearphishing emails,T1566.001,Phishing: Spearphishing Attachment
exploitation of public-facing applications,T1190,Exploit Public-Facing Application
User execution [T1204] of malicious files,T1204.002,User Execution: Malicious File
steganography [T1027.003] to hide stolen data inside other files stored on GitHub,T1027,Obfuscated Files or Information
multi-hop proxies,T1090,Proxy
stage collected data  locally,T1074.001,Data Staged: Local Data Staging
Exfiltration over C2 channel,T1041,Exfiltration Over C2 Channel
encryption,T1027,Obfuscated Files or Information
24 different IP addresses in use,T1090,Proxy
compromised devices that act as proxies for their C&C servers,T1090,Proxy
"use some victims as proxies, or some vulnerable devices to forward communication to their real C&C servers.",T1090,Proxy
phishing emails have similar topics and pretend to come from some of the same entities,T1566.001,Phishing: Spearphishing Attachment
"attachments used for phishing emails,",T1566.001,Phishing: Spearphishing Attachment
emails have a PDF document attached,T1566.001,Phishing: Spearphishing Attachment
PDF file attached,T1566.001,Phishing: Spearphishing Attachment
used emails with PDF or RTF files attached that contain a link to download malware,T1566.001,Phishing: Spearphishing Attachment
user must click to download the malware,T1204.002,User Execution: Malicious File
manually extract the file and execute it,T1204.002,User Execution: Malicious File
have attempted to get users to execute malicious files masquerading as documents,T1204.002,User Execution: Malicious File
regular RAR archives that have an executable file inside.,T1027,Obfuscated Files or Information
contains several benign files that are written to disk (they are not part of NSIS binaries and they are not used at all by the installer) and two files that are malicious,T1027,Obfuscated Files or Information
reads a string (or binary data) from its resource section,T1027,Obfuscated Files or Information
reads data from its own resource section and decrypts a payload.,T1027,Obfuscated Files or Information
is read from an encrypted resource,T1027,Obfuscated Files or Information
two shellcodes contained in the compiled AutoIt script,T1027,Obfuscated Files or Information
"Read a binary from its resource section, write it to disk and execute it",T1027,Obfuscated Files or Information
variety of packers used for these executables,T1027,Obfuscated Files or Information
different variants of a packer,T1027,Obfuscated Files or Information
is packed with CyaX,T1027,Obfuscated Files or Information
is gzip-decompressed and executed,T1027,Obfuscated Files or Information
.NET packer known as CyaX,T1027,Obfuscated Files or Information
used an AutoIt packer that comes heavily obfuscated.,T1027,Obfuscated Files or Information
have used various layers of packers for obfuscating their droppers.,T1027,Obfuscated Files or Information
decrypting the payload,T1140,Deobfuscate/Decode Files or Information
decrypting,T1140,Deobfuscate/Decode Files or Information
decrypt,T1140,Deobfuscate/Decode Files or Information
decrypts it,T1140,Deobfuscate/Decode Files or Information
decrypts another executable,T1140,Deobfuscate/Decode Files or Information
a string that will be decrypted,T1140,Deobfuscate/Decode Files or Information
"decrypts the array by doing a single-byte XOR operation, cycling through the key",T1140,Deobfuscate/Decode Files or Information
decryption of the payload is based on XOR operations,T1140,Deobfuscate/Decode Files or Information
decrypt the payload,T1140,Deobfuscate/Decode Files or Information
a single-byte XOR algorithm.,T1140,Deobfuscate/Decode Files or Information
decrypt the payload,T1140,Deobfuscate/Decode Files or Information
have used various encryption algorithms in their droppers to hide strings and payloads,T1140,Deobfuscate/Decode Files or Information
injecting it into legitimate processes.,T1055,Process Injection
be injected into a new process or loaded in the same process space,T1055,Process Injection
"injected into a different process,",T1055,Process Injection
injection of the payload,T1055,Process Injection
performs the injection and execution of the payload,T1055,Process Injection
inject it into some process,T1055,Process Injection
shellcode with RunPE code is used to perform the injection,T1055,Process Injection
RAR archive is downloaded,T1027,Obfuscated Files or Information
compressed archives,T1027,Obfuscated Files or Information
"layers of encryption, obfuscation or anti-analysis",T1027,Obfuscated Files or Information
"was hiding in non-malicious code,",T1027,Obfuscated Files or Information
encrypted resource and XORed with a hardcoded password,T1027,Obfuscated Files or Information
encrypted with this same XOR-based algorithm,T1027,Obfuscated Files or Information
DLL is run with rundll32,T1218.011,System Binary Proxy Execution: Rundll32
uses steganography,T1027,Obfuscated Files or Information
reads pixels from an image contained in the first binary,T1027,Obfuscated Files or Information
"stores every pixel as three numbers according to its red, green and blue components",T1027,Obfuscated Files or Information
have used packers that read pixel data from images contained in PE files’ resource sections and build the next layer of execution from the data,T1027,Obfuscated Files or Information
DLL that will be loaded and called in the same address space,T1055,Process Injection
performs the injection is contained in an array and is dynamically loaded.,T1055,Process Injection
disabling Windows Defender,T1562.001,Impair Defenses: Disable or Modify Tools
"have used CyaX packer, which can disable Windows Defender.",T1562.001,Impair Defenses: Disable or Modify Tools
checking for security products,T1518.001,Software Discovery: Security Software Discovery
used droppers that check for security software present in a victim’s computer,T1518.001,Software Discovery: Security Software Discovery
loaded with VirtualAlloc and executed,T1106,Native API
"used API calls in their droppers, such as  CreateProcessA, WriteProcessMemory and ResumeThread, to load and execute shellcode in memory",T1106,Native API
created in the Startup folder to execute the script.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
used RATs that persist by creating a Run registry key or by creating a copy of the malware in the Startup folder,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
Delete the dropper executable,T1070.004,Indicator Removal: File Deletion
have used malware that deletes itself from the system,T1070.004,Indicator Removal: File Deletion
Download and execute files,T1105,Ingress Tool Transfer
ability to download and execute other malware,T1105,Ingress Tool Transfer
uploading and downloading files,T1105,Ingress Tool Transfer
keylogging,T1056.001,Input Capture: Keylogging
keylogging,T1056.001,Input Capture: Keylogging
"keylogging,",T1056.001,Input Capture: Keylogging
used various RATs that have keylogging capabilities,T1056.001,Input Capture: Keylogging
screen capture,T1113,Screen Capture
taking screenshots,T1113,Screen Capture
used various RATs that can capture screenshots of victim machines,T1113,Screen Capture
exfiltration of files,T1041,Exfiltration Over C2 Channel
used various RATs that exfiltrate data over the same channel used for C&C,T1041,Exfiltration Over C2 Channel
used RATs that can launch a command shell for executing commands.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
have used scheduled tasks in their droppers and payloads to achieve persistence,T1053.005,Scheduled Task/Job: Scheduled Task
used RATs that implement UAC bypassing.,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
"have used RATs that allow full access to the Registry,",T1112,Modify Registry
have used droppers that inject the payload into legitimate processes,T1055,Process Injection
used various RATs that can browse file systems,T1083,File and Directory Discovery
used various RATs with modules that show running processes,T1057,Process Discovery
used various RATs that can read the Registry.,T1012,Query Registry
used various RATs that gather system information such as computer name and operating system during the initial infection,T1082,System Information Discovery
used various RATs that can collect the IP address of the victim machine,T1016,System Network Configuration Discovery
used various RATs that retrieve the current username during initial infection,T1033,System Owner/User Discovery
used various RATs that can perform remote desktop access.,T1021.001,Remote Services: Remote Desktop Protocol
"used various RATs that can access the local file system and upload, download or delete files",T1005,Data from Local System
"used Remcos RAT, which uses RC4 for encrypting C&C communications",T1573.001,Encrypted Channel: Symmetric Cryptography
used various RATs that use TCP for C&C communications,T1095,Non-Application Layer Protocol
data exfiltration of sensitive information,T1005,Data from Local System
move through the victim environment via RDP,T1021.001,Remote Services: Remote Desktop Protocol
"mass deletion of virtual machines, storage, and configurations",T1070.004,Indicator Removal: File Deletion
to identify any credentials which may be stored in technical documentation,T1552.001,Unsecured Credentials: Credentials In Files
extraction of sensitive API Keys,T1552.001,Unsecured Credentials: Credentials In Files
Access to local password managers and databases to obtain further credentials,T1552.001,Unsecured Credentials: Credentials In Files
Using compromised credentials to access corporate VPNs.,T1078,Valid Accounts
victim controlled hostnames were revealed,T1082,System Information Discovery
runs a scheduled task,T1053.005,Scheduled Task/Job: Scheduled Task
decryption of credentials,T1140,Deobfuscate/Decode Files or Information
decrypted using DPAPI,T1140,Deobfuscate/Decode Files or Information
These credentials are generated and stored in the memory of the LSASS process,T1003.001,OS Credential Dumping: LSASS Memory
Attackers may attempt to access LSASS process memory to extract credentials as it stores a variety of credentials.,T1003.001,OS Credential Dumping: LSASS Memory
"LSASS process memory is one of the prime targets for attackers, as well as malware armed with lateral movement capabilities since it caches a variety of credentials",T1003.001,OS Credential Dumping: LSASS Memory
Credential extraction from the LSASS process,T1003.001,OS Credential Dumping: LSASS Memory
credential-based deception is to stage the deceptive credentials in LSASS process memory.,T1003.001,OS Credential Dumping: LSASS Memory
credentials are extracted with Mimikatz.,T1003.001,OS Credential Dumping: LSASS Memory
credential extraction tool Mimikatz,T1003.001,OS Credential Dumping: LSASS Memory
uses the CreateProcessWithLogonW Windows API,T1106,Native API
calling the API,T1106,Native API
recon for interesting hostnames,T1082,System Information Discovery
public facing systems is compromised,T1190,Exploit Public-Facing Application
be injected with deceptive credentials at multiple places like LSASS process memory,T1055,Process Injection
Injecting NETONLY credentials into LSASS process memory,T1055,Process Injection
Injecting credentials into LSASS memory,T1055,Process Injection
credentials being picked up and used to pivot to decoy systems in the network,T1078,Valid Accounts
keyloggers,T1056.001,Input Capture: Keylogging
flood a remote DNS server with false traffic.,T1071.001,Application Layer Protocol: Web Protocols
"send traffic simultaneously to one server,",T1071.001,Application Layer Protocol: Web Protocols
using the default factory credentials.,T1078,Valid Accounts
exfiltrating data from the target device,T1041,Exfiltration Over C2 Channel
covert channel that can be used to exfiltrate data from the victim device,T1041,Exfiltration Over C2 Channel
"deliver more malware,",T1105,Ingress Tool Transfer
extract data and files from endpoint devices.,T1005,Data from Local System
a version of the malware that was injected into a victim’s system,T1055,Process Injection
"It usually pretends to be a legitimate file, such as an Adobe PDF or Dropbox file,",T1036.005,Masquerading: Match Legitimate Name or Location
The phishing email with the malicious attachment,T1566.001,Phishing: Spearphishing Attachment
file is a Python program packaged by PyInstaller.,T1027,Obfuscated Files or Information
is an obfuscating tool for Python script that makes the malware harder to be analyzed and detected.,T1027,Obfuscated Files or Information
It contains Base64-encoded data,T1027,Obfuscated Files or Information
Python programs that are obfuscated using PyArmor,T1027,Obfuscated Files or Information
"After decrypting the pyc file,",T1140,Deobfuscate/Decode Files or Information
it uses the following command to delete the data in PSReadline,T1070.004,Indicator Removal: File Deletion
It also checks the victim’s hostname,T1082,System Information Discovery
collects browser history and passwords from the following browsers,T1552.001,Unsecured Credentials: Credentials In Files
It also uses the command “CopyFromScreen” to capture a screenshot.,T1113,Screen Capture
Downloading files and getting a screenshot,T1113,Screen Capture
Download components for the Keylogger,T1056.001,Input Capture: Keylogging
It is a key logger that saves data in the “KeyLogs” folder.,T1056.001,Input Capture: Keylogging
downloads three components from,T1105,Ingress Tool Transfer
can be executed via scheduled tasks.,T1053.005,Scheduled Task/Job: Scheduled Task
"It was quite common to see scheduled tasks used to create persistence for the ransomware executable,",T1053.005,Scheduled Task/Job: Scheduled Task
The threat actors also expressed interest in other access methods such as RDP,T1021.001,Remote Services: Remote Desktop Protocol
Credentials that have either been reused across multiple platforms or have previously been exposed,T1078,Valid Accounts
this includes VPN accounts,T1078,Valid Accounts
Compromised accounts may be used to maintain access to the network.,T1078,Valid Accounts
local accounts.,T1078,Valid Accounts
domain and local accounts,T1078,Valid Accounts
Affiliates have been seen brute forcing,T1110,Brute Force
Affiliates have been seen brute forcing exposed RDP services and compromising accounts with weak passwords.,T1210,Exploitation of Remote Services
Exploit Public-Facing Applications,T1190,Exploit Public-Facing Application
is typically executed via command line arguments,T1059.003,Command and Scripting Interpreter: Windows Command Shell
some defense evasion batch scripts.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
a batch script or a specially crafted command line script.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"The ProxyShell elevation of privilege on the Exchange PowerShell Backend (CVE-2021-34523), Windows Background Intelligent Transfer Service (BITS) improperly handling symbolic links (CVE-2020-0787), and abusing the CMSTPLUA COM interface have all been seen as methods of privilege escalation.",T1068,Exploitation for Privilege Escalation
has utilized a UAC bypass tool.,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
"Indicators, such as logs in Windows Event Logs or malicious files, are typically removed using wevtutil, a batch script, or CCleaner.",T1027,Obfuscated Files or Information
"Windows Defender, other anti-malware solutions and monitoring tools are disabled utilizing a process explorer tool,",T1562.001,Impair Defenses: Disable or Modify Tools
Firewall rules have occasionally been seen being disabled as well.,T1562.001,Impair Defenses: Disable or Modify Tools
"During the defense evasion phase, anti-malware and monitoring software is often disabled.",T1562.001,Impair Defenses: Disable or Modify Tools
Mimikatz is a key player in dumping credentials but LockBit 2.0 has been occasionally seen utilizing MiniDump as well.,T1003.001,OS Credential Dumping: LSASS Memory
has been seen using the PowerShell module InvokeGPUpdate to update the group policy.,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
Most PowerShell scripts involved in LockBit 2.0 cases are Base64 encoded.,T1027,Obfuscated Files or Information
"enumerates system information such as hostname, shares, and domain information.",T1082,System Information Discovery
has been known to self-propagate via SMB.,T1570,Lateral Tool Transfer
a method of lateral movement and a tool for downloading/executing files.,T1570,Lateral Tool Transfer
"AnyDesk has been the most common legitimate desktop software used to establish an interactive command and control channel, with ConnectWise seen slightly less frequently.",T1219,Remote Access Software
Operates as a file grabber,T1105,Ingress Tool Transfer
the UPX packed sample,T1027,Obfuscated Files or Information
which unpacks,T1027,Obfuscated Files or Information
brute forcing post-infection to automate local and global spreading attempts.,T1110,Brute Force
brute forcing,T1110,Brute Force
"multiple levels of encoded commands,",T1027,Obfuscated Files or Information
The multiple levels of Base64 encoding,T1027,Obfuscated Files or Information
use of three base64 encoded echo commands,T1027,Obfuscated Files or Information
encoded payload,T1027,Obfuscated Files or Information
downloading itself from malicious servers,T1105,Ingress Tool Transfer
attacker began adding the lwp-download command as a failover for wget and curl to enable downloading commands,T1105,Ingress Tool Transfer
"download, and configure",T1105,Ingress Tool Transfer
process of downloading and setting persistence of some other file.,T1105,Ingress Tool Transfer
downloading a specific payload,T1105,Ingress Tool Transfer
decoded into a new script,T1140,Deobfuscate/Decode Files or Information
The payload contains two additional base64 encoded scripts,T1027,Obfuscated Files or Information
operators attempted to use cached credentials from local accounts to gain initial access to additional systems within an internal network.,T1078,Valid Accounts
exploits known vulnerabilities in internet-facing applications,T1190,Exploit Public-Facing Application
"MiniDump, “a C# implementation of mimikatz/pypykatz minidump functionality to get credentials from LSASS dumps”",T1003.001,OS Credential Dumping: LSASS Memory
Usernames,T1033,System Owner/User Discovery
and hostnames collected,T1082,System Information Discovery
"It is used to connect to systems in the same network via SMB, to write a batch file to disk",T1570,Lateral Tool Transfer
to push batch files over SMB to other systems within an internal network.,T1570,Lateral Tool Transfer
"write a batch file to disk that executes the Fantasy wiper, and then run that batch file via PsExec with this command line string",T1059.003,Command and Scripting Interpreter: Windows Command Shell
writing the batch file to disk and executing.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
The batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
The batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
a batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"creates another batch file, system.bat,",T1059.003,Command and Scripting Interpreter: Windows Command Shell
writes another batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"the batch file in Figure 7, which Sandals creates on remote systems to launch",T1059.003,Command and Scripting Interpreter: Windows Command Shell
both use batch files that run via the Windows command shell.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
ease of batch file execution.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
write the batch file on the remote system.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
it writes a batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
lists the command line arguments accepted,T1059.003,Command and Scripting Interpreter: Windows Command Shell
deletes all files written to disk in the current working directory,T1070.004,Indicator Removal: File Deletion
then deletes the file.,T1070.004,Indicator Removal: File Deletion
deletes the directory with the files causing the errors,T1070.004,Indicator Removal: File Deletion
recursively deletes all files,T1070.004,Indicator Removal: File Deletion
the file deletion functions,T1070.004,Indicator Removal: File Deletion
File deletion functions,T1070.004,Indicator Removal: File Deletion
File deletion functions,T1070.004,Indicator Removal: File Deletion
then deletes the files.,T1070.004,Indicator Removal: File Deletion
the decoded command line parameter,T1140,Deobfuscate/Decode Files or Information
The base64 string,T1027,Obfuscated Files or Information
base64-encoded argument,T1027,Obfuscated Files or Information
a base64 encoded argument,T1027,Obfuscated Files or Information
It collects a list of fixed drives but excludes the drive where the %WINDOWS% directory exists.,T1083,File and Directory Discovery
Then it enters a for loop iterating over the drive list to build a recursive directory listing,T1083,File and Directory Discovery
shows that the directory listing function,T1083,File and Directory Discovery
Directory listing functions,T1083,File and Directory Discovery
", the GetSubDirectoryFileListRecursive function",T1083,File and Directory Discovery
Recursive directory listing functions,T1083,File and Directory Discovery
and then self-deletes.,T1027,Obfuscated Files or Information
bat deletes itself,T1027,Obfuscated Files or Information
"attempts to clear file system cache memory, and self-deletes",T1027,Obfuscated Files or Information
that deletes the Fantasy wiper from disk and then deletes itself.,T1027,Obfuscated Files or Information
creates a batch file in %WINDOWS%\Temp called registry.bat.,T1112,Modify Registry
"deletes the following registry keys:
HKCR\.EXE
HKCR\.dll
HKCR\*",T1112,Modify Registry
"Then it runs the following to attempt to clear file system cache memory:
%windir%\system32\rundll32.exe",T1218.011,System Binary Proxy Execution: Rundll32
GetSubDirectoryFileListRecursive function,T1106,Native API
uses the LookupPrivilegeValue and AdjustTokenPrivilege APIs,T1106,Native API
operators attempted to capture cached credentials and then use them for lateral movement.,T1078,Valid Accounts
The actors used built-in Windows user account DefaultAccount.,T1078,Valid Accounts
and the built-in Windows user account  [T1078.001] to move laterally,T1078,Valid Accounts
HTTPS activity from IP address  to the organization’s VMware server.,T1071.001,Application Layer Protocol: Web Protocols
"Following HTTPS activity,",T1071.001,Application Layer Protocol: Web Protocols
outgoing HTTPS port 443 connections to  and  (the prior domain in reverse).,T1071.001,Application Layer Protocol: Web Protocols
encoded payload,T1027,Obfuscated Files or Information
"to download next stage and execute it""",T1105,Ingress Tool Transfer
"The actors downloaded malware and multiple tools to the network, including PsExec, Mimikatz, and Ngrok.",T1105,Ingress Tool Transfer
"The exclusion rule allowlisted the entire , enabling threat actors to download tools to the  without virus scans.",T1562.001,Impair Defenses: Disable or Modify Tools
that added an exclusion rule to Windows Defender,T1562.001,Impair Defenses: Disable or Modify Tools
the actors manually disabled Windows Defender via the Graphical User Interface (GUI),T1562.001,Impair Defenses: Disable or Modify Tools
The actors added an exclusion rule to Windows Defender.,T1562.001,Impair Defenses: Disable or Modify Tools
"The tool allowlisted the entire c:\drive, enabling the actors to bypass virus scans for tools they downloaded to the c:\drive.",T1562.001,Impair Defenses: Disable or Modify Tools
The actors manually disabled Windows Defender via the GUI.,T1562.001,Impair Defenses: Disable or Modify Tools
"The threat actors also moved laterally to the domain controller, compromised credentials,",T1078,Valid Accounts
the actors gained access to a VMware service account with administrator and system level access,T1078,Valid Accounts
"In February 2022, the threat actors exploited Log4Shell [T1190] for initial access",T1190,Exploit Public-Facing Application
The actors exploited Log4Shell for initial access to the organization’s VMware Horizon server.,T1190,Exploit Public-Facing Application
The exploit payload created a Scheduled Task,T1053.005,Scheduled Task/Job: Scheduled Task
The Scheduled Task was named  to masquerade as a legitimate Windows task.,T1053.005,Scheduled Task/Job: Scheduled Task
"The actors’ exploit payload created Scheduled Task RuntimeBrokerService.exe, which executed RuntimeBroker.exe daily as SYSTEM.",T1053.005,Scheduled Task/Job: Scheduled Task
the actors used RDP,T1021.001,Remote Services: Remote Desktop Protocol
the actors leveraged RDP to propagate to several hosts within the network.,T1021.001,Remote Services: Remote Desktop Protocol
"The actors were able to proxy [T1090] RDP sessions,",T1021.001,Remote Services: Remote Desktop Protocol
The actors used RDP to move laterally to multiple hosts on the network.,T1021.001,Remote Services: Remote Desktop Protocol
used Ngrok to proxy RDP connections and to perform command and control.,T1021.001,Remote Services: Remote Desktop Protocol
a reverse proxy tool for proxying an internal service,T1090,Proxy
Mimikatz – a credential theft tool.,T1003.001,OS Credential Dumping: LSASS Memory
The threat actors then executed Mimikatz on VDI-KMS to harvest credentials,T1003.001,OS Credential Dumping: LSASS Memory
"Additionally, the threat actor was observed attempting to dump the Local Security Authority Subsystem Service (LSASS) process",T1003.001,OS Credential Dumping: LSASS Memory
The actors used Mimikatz,T1003.001,OS Credential Dumping: LSASS Memory
The actors were observed trying to dump LSASS process.,T1003.001,OS Credential Dumping: LSASS Memory
The actors used Mimikatz to harvest credentials.,T1003.001,OS Credential Dumping: LSASS Memory
The actors were able to proxy,T1090,Proxy
The actors used Ngrok to proxy,T1090,Proxy
The actors removed malicious file mde.ps1 from the dis.,T1027,Obfuscated Files or Information
"When executed, mde.ps1 downloaded  from  and removed  from the disk",T1027,Obfuscated Files or Information
send phishing emails with malicious HTML attachments to all addresses in the victim’s mailbox.,T1566.001,Phishing: Spearphishing Attachment
sending additional phishing emails to the victim’s contacts,T1566.001,Phishing: Spearphishing Attachment
phishing email,T1566.001,Phishing: Spearphishing Attachment
"starts with an income tax-themed phishing email written in Spanish, disguising itself as a tax receipt notification",T1566.001,Phishing: Spearphishing Attachment
disseminate additional phishing emails to the victim’s contacts.,T1566.001,Phishing: Spearphishing Attachment
send phishing emails with malicious HTML attachments to all addresses in the victim’s mailbox.,T1566.001,Phishing: Spearphishing Attachment
constructs an email with a hardcoded subject and body and attaches the HTML file from the “fb” folder.,T1566.001,Phishing: Spearphishing Attachment
collect the victim’s login credentials for various online accounts,T1078,Valid Accounts
login credentials,T1078,Valid Accounts
targets victim’s login credentials,T1078,Valid Accounts
credentials,T1078,Valid Accounts
attempt to compromise the victim’s login credentials for webmail services,T1078,Valid Accounts
keystrokes,T1056.001,Input Capture: Keylogging
"keylogging,",T1056.001,Input Capture: Keylogging
logs keystrokes,T1056.001,Input Capture: Keylogging
logging keystrokes via polling and application hooks,T1056.001,Input Capture: Keylogging
logging keystrokes,T1056.001,Input Capture: Keylogging
operating system information,T1082,System Information Discovery
"system information,",T1082,System Information Discovery
"performs surveillance on the victim’s machine by collecting system information such as hostnames, IPv4 address, operating system version, disk volume information, disk size and anti-virus software information, and gets the system’s default language.",T1082,System Information Discovery
"using multiple hosts, including an Amazon Web Services (AWS) Elastic Compute Cloud (EC2) instance, accessed through its public URL, to host the malicious files.",T1071.001,Application Layer Protocol: Web Protocols
requests a data stream from the C2 server through the URL,T1071.001,Application Layer Protocol: Web Protocols
hosted the PowerShell downloader script,T1105,Ingress Tool Transfer
hosted the ZIP file containing the payloads,T1105,Ingress Tool Transfer
downloads a RAR file.,T1105,Ingress Tool Transfer
downloads the PowerShell downloader script from an attacker-controlled server,T1105,Ingress Tool Transfer
download a ZIP file,T1105,Ingress Tool Transfer
downloading,T1105,Ingress Tool Transfer
download the payloads,T1105,Ingress Tool Transfer
downloads a malicious ZIP file,T1105,Ingress Tool Transfer
drops the DLL,T1105,Ingress Tool Transfer
download the PowerShell downloader script from the attacker-controlled server,T1105,Ingress Tool Transfer
download and run the Horabot “au” using the URL,T1105,Ingress Tool Transfer
downloading files from a URL,T1105,Ingress Tool Transfer
downloads the contents of an HTML file stored in an attacker-controlled server,T1105,Ingress Tool Transfer
a virtual private server (VPS) behind which the attacker has parked the actual command and control (C2) server,T1090,Proxy
"domain name also resembled the legitimate Mexican Tax Agency domain, a tactic the attacker likely adopted to disguise malicious traffic.",T1036.005,Masquerading: Match Legitimate Name or Location
is a legitimate AutoIt interpreter.,T1036.005,Masquerading: Match Legitimate Name or Location
uses PowerShell downloader,T1059.003,Command and Scripting Interpreter: Windows Command Shell
leads to payload delivery through the execution of a PowerShell downloader script,T1059.003,Command and Scripting Interpreter: Windows Command Shell
RAR file contains a batch file with a CMD extension,T1059.003,Command and Scripting Interpreter: Windows Command Shell
executes it through the PowerShell commands.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
downloading and executing two other PowerShell scripts from a different attacker-controlled server.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"PowerShell downloader script, which the attacker attempts to execute to re-infect the victim’s machine,",T1059.003,Command and Scripting Interpreter: Windows Command Shell
batch file downloads the PowerShell downloaderThe,T1059.003,Command and Scripting Interpreter: Windows Command Shell
a malicious batch file with a .cmd extension is downloaded to the user’s machine.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
executes an embedded PowerShell command to download the next-stage PowerShell script from the server and execute it on the victim’s machine.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
creates two other malicious batch scripts with the extension .cmd in the folder “/Users/Public.”,T1059.003,Command and Scripting Interpreter: Windows Command Shell
executes one of the dropped batch files,T1059.003,Command and Scripting Interpreter: Windows Command Shell
executes an embedded PowerShell command,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"executes another dropped batch file,",T1059.003,Command and Scripting Interpreter: Windows Command Shell
executes a PowerShell command,T1059.003,Command and Scripting Interpreter: Windows Command Shell
contains the payload DLLs and a few legitimate executables and DLLs,T1055,Process Injection
DLL sideloadingThis,T1574.002,Hijack Execution Flow: DLL Side-Loading
sideloading to legitimate executables,T1574.002,Hijack Execution Flow: DLL Side-Loading
run the payloads by sideloading them to the legitimate executables,T1574.002,Hijack Execution Flow: DLL Side-Loading
sideload a malicious DLL,T1574.002,Hijack Execution Flow: DLL Side-Loading
sideload the DLL,T1574.002,Hijack Execution Flow: DLL Side-Loading
sideloads the DLL to the AutoIt interpreter process,T1574.002,Hijack Execution Flow: DLL Side-Loading
enticing users to open the attached malicious HTML file,T1204.002,User Execution: Malicious File
lures them to click an embedded malicious hyperlink which,T1204.002,User Execution: Malicious File
executed when the victim opens the contents of the file,T1204.002,User Execution: Malicious File
"user opens the CMD file,",T1204.002,User Execution: Malicious File
"an embedded URL is launched in the victim’s browser,",T1027,Obfuscated Files or Information
has an embedded malicious URL,T1027,Obfuscated Files or Information
redirecting to another malicious HTML file from an attacker-controlled AWS EC2 instance.,T1090,Proxy
configured to run the payloads in the startup folder of the victim’s machine,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
creates two Windows shortcut files in the Windows startup folder using the Internet Explorer application icon and the target paths pointing to the two dropped batch scripts.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
"creates three more Windows shortcut files in the victim’s machine startup folder,",T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
files dropped in the Windows startup folder are run,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
launches several processes,T1543.003,Create or Modify System Process: Windows Service
heavily obfuscated with random symbols that substitute the instructions during the run-time and base64-encoded strings.,T1027,Obfuscated Files or Information
uses alphanumeric characters and the special character “_” to generate a random name and creates a folder with the random name in the root directory of the victim’s machine.,T1027,Obfuscated Files or Information
executes the compiled AutoIt script,T1027,Obfuscated Files or Information
evade detection,T1027,Obfuscated Files or Information
encodes the email addresses in the “.Outlook” file to a data stream,T1027,Obfuscated Files or Information
decodes the base64-encoded strings and initializes them,T1140,Deobfuscate/Decode Files or Information
decrypts the encrypted,T1140,Deobfuscate/Decode Files or Information
decrypt,T1140,Deobfuscate/Decode Files or Information
decryption function decrypts the URL pointing to the attacker-controlled server,T1140,Deobfuscate/Decode Files or Information
the malicious ZIP file is deleted.,T1070.004,Indicator Removal: File Deletion
deleting the “fb” folder to cover its paths and avoid detection,T1070.004,Indicator Removal: File Deletion
"writes the path of the executable file, “_upyqta2_Ji7.exe”, to the class’s registry key “HKEY_CURRENT_USER\software\Classes\ms-settings\shell\open\command”",T1112,Modify Registry
screenshot capturing,T1113,Screen Capture
"capturing screenshots,",T1113,Screen Capture
capturing screenshots,T1113,Screen Capture
anti-virus software information,T1518.001,Software Discovery: Security Software Discovery
"Checks for the existence of the anti-virus products such as AVG and Avast by checking for the DLLs avghookx.dll, avghooka.dll and snxhk.dll",T1518.001,Software Discovery: Security Software Discovery
exfiltrated to the attacker-controlled server through an HTTP POST request to the URL,T1041,Exfiltration Over C2 Channel
exfiltrates the email address to the C2 server using an HTTP POST request,T1041,Exfiltration Over C2 Channel
exfiltrate contacts’ email addresses,T1041,Exfiltration Over C2 Channel
encoded email addresses are exfiltrated,T1041,Exfiltration Over C2 Channel
"checking if a file on the victim’s filesystem exists and gets the file’s attributes, collecting size and version information,",T1083,File and Directory Discovery
looks for the Outlook data files from the victim profile’s Outlook application data folder.,T1083,File and Directory Discovery
enumerates all folders and emails in the victim’s Outlook data file,T1083,File and Directory Discovery
collect login data from the Google Chrome user profile folders,T1005,Data from Local System
"extracts email addresses from the emails’ sender, recipients, CC and BCC fields.",T1005,Data from Local System
creating SQL queries to produce the database tables to store the stolen data,T1074.001,Data Staged: Local Data Staging
added to the email address collection array.,T1074.001,Data Staged: Local Data Staging
writes the extracted email addresses from the array to a file called “.Outlook” created by the script in the roaming user profile’s Microsoft application data folder.,T1074.001,Data Staged: Local Data Staging
"Checks the registry keys to detect virtual environments such as VMWare, Virtual Box, Wine, Microsoft Hyper-V or Windows Virtual PC.",T1012,Query Registry
the adversary used impacket to execute Windows Management Instrumentation (WMI) to achieve command execution on other systems present in the environment.,T1047,Windows Management Instrumentation
examples of the command line syntax used for the performance of this activity,T1059.003,Command and Scripting Interpreter: Windows Command Shell
adversary using Windows Batch files,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
performed via the following command-line syntax,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the command-line syntax used,T1059.003,Command and Scripting Interpreter: Windows Command Shell
command-line syntax was observed being used,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the Windows Command Processor was used,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"attacker also used the ""proxychains"" utility, which is often employed to redirect network traffic",T1090,Proxy
use of utilities such as proxychains,T1090,Proxy
adversary leveraging a Windows Service to execute PowerShell to stay persistent in the environment.,T1569.002,System Services: Service Execution
The Windows service was configured with the following options:Service Type: user mode service Service Start Type,T1543.003,Create or Modify System Process: Windows Service
the PowerShell being executed was Base64 encoded,T1027,Obfuscated Files or Information
The decoded PowerShell instructions,T1140,Deobfuscate/Decode Files or Information
"decrypting,",T1140,Deobfuscate/Decode Files or Information
Disabling PowerShell logging,T1562.001,Impair Defenses: Disable or Modify Tools
Disabling this security control,T1562.001,Impair Defenses: Disable or Modify Tools
to disable remote administration restrictions to facilitate lateral movement and privilege escalation activities,T1562.001,Impair Defenses: Disable or Modify Tools
attacker disabling Windows Defender,T1562.001,Impair Defenses: Disable or Modify Tools
"Downloading, decrypting, and executing a backdoor payload from an attacker-controlled server",T1105,Ingress Tool Transfer
the attacker leveraging Windows Remote Desktop Connections to pivot to additional systems in the environment.,T1021.001,Remote Services: Remote Desktop Protocol
attacker also attempted to execute PowerShell scripts on remote systems in the environment while moving system-to-system,T1570,Lateral Tool Transfer
adversaries copied and executed the aforementioned PowerShell script on multiple systems across the environment,T1570,Lateral Tool Transfer
Comsvcs.dll is a well-known way to extract LSASS (Local Security Authority Subsystem Service) data,T1003.001,OS Credential Dumping: LSASS Memory
"invoking comsvcs.dll with rundll32.exe, an adversary can create a dump of any process",T1003.001,OS Credential Dumping: LSASS Memory
utilizing comsvcs.dll,T1003.001,OS Credential Dumping: LSASS Memory
"invoking comsvcs.dll with rundll32.exe,",T1218.011,System Binary Proxy Execution: Rundll32
adversary was also observed remotely modifying the Windows Registry on remote systems,T1112,Modify Registry
by modifying the Windows Registry on compromised systems.,T1112,Modify Registry
the adversary attempting to exfiltrate sensitive information over SMB (TCP/445) directly from a compromised domain controller.,T1041,Exfiltration Over C2 Channel
threat actor is actively exploiting the so-called PrintNightmare vulnerability (CVE-2021-1675 / CVE-2021-34527) in Windows' print spooler service to spread laterally across a victim's network,T1210,Exploitation of Remote Services
screen capture,T1113,Screen Capture
keylogging,T1056.001,Input Capture: Keylogging
"Microsoft SharePoint vulnerability CVE-2019-0604 was used to deliver
web shells",T1190,Exploit Public-Facing Application
"exploited the Microsoft SharePoint vulnerability
CVE-2019-0604 to install web shells",T1190,Exploit Public-Facing Application
"running native Windows commands on compromised servers,",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"The operators made a consistent effort to
delete these tools and remove any residual forensic artifacts from
compromised systems.",T1027,Obfuscated Files or Information
"consistently cleaned up evidence of their intrusion after
gaining access to a system",T1027,Obfuscated Files or Information
"moved laterally and
deployed their signature malware",T1570,Lateral Tool Transfer
"used this
access to deploy and remotely execute FOCUSFJORD on their primary target.",T1570,Lateral Tool Transfer
"The operators deleted tools used for credential harvesting and
internal reconnaissance",T1070.004,Indicator Removal: File Deletion
"to delete any remaining FOCUSFJORD
forensic evidence, including files on disk, configuration data
encrypted in the registry, and related services and registry keys
used for persistence.",T1070.004,Indicator Removal: File Deletion
"writes its encrypted C2
configuration into the system’s registry",T1112,Modify Registry
"writes its configuration to registry,
this value is set to “default” and is later manually changed by the
actor",T1112,Modify Registry
"the
operators were able to access their primary target via RDP connections",T1021.001,Remote Services: Remote Desktop Protocol
"operators were able to access their primary target via RDP connections
from a trusted third party using stolen credentials",T1078,Valid Accounts
configured to proxy C2 traffic,T1090,Proxy
configured to proxy C2 traffic,T1090,Proxy
"used other victim networks to proxy their C2
instructions, likely to minimize the risk of detection and blend in
with normal network traffic.",T1090,Proxy
"acting as proxies to relay
communications to their C2 servers.",T1090,Proxy
usually to the victim’s domain name,T1082,System Information Discovery
"to read
and decrypt those registry key values for proper execution.",T1140,Deobfuscate/Decode Files or Information
"the malware needs to read
and decrypt those registry key values",T1012,Query Registry
"to obfuscate the source of the
activity.",T1027,Obfuscated Files or Information
"a tool called “anti.exe”
to stop Windows Update service and terminate EDR and Antivirus
related services.",T1562.001,Impair Defenses: Disable or Modify Tools
leverages spear-phishing and tries to trick the victims into opening malicious documents,T1566.001,Phishing: Spearphishing Attachment
They used multiple malicious PDFs and MS Office documents during the campaign.,T1566.001,Phishing: Spearphishing Attachment
they use tools such as Mimikatz to dump credentials.,T1003.001,OS Credential Dumping: LSASS Memory
"and remote monitoring software such as ScreenConnect, Remote Utilities, and eHorus.",T1219,Remote Access Software
"they added a new tool for remote access, Syncro, to their arsenal.",T1219,Remote Access Software
It disguises itself as a legitimate Google Update executable.,T1036.005,Masquerading: Match Legitimate Name or Location
It collects the victim’s username,T1033,System Owner/User Discovery
computer name,T1082,System Information Discovery
and IP address,T1016,System Network Configuration Discovery
Domain fronting is another method for concealing communication between the endpoint and the command and control servers.,T1090,Proxy
purpose of domain fronting is to connect to a restricted host while pretending to communicate with an allowed host,T1090,Proxy
masks your traffic to a certain website by masquerading it as a different domain.,T1090,Proxy
Domain fronting was mostly used by web services to bypass censorship in several countries that restricted traffic,T1090,Proxy
attackers have started using this technique to hide their malicious infrastructure behind legitimate domains,T1090,Proxy
domain fronting possible by allowing the operators to configure related settings via the malleable C2 profiles,T1090,Proxy
Setup the CDN service to create a new CDN endpoint and redirect traffic to your domain.,T1090,Proxy
Identify a domain that uses the same CDN to ensure that the traffic will be forwarded to the correct resource.,T1090,Proxy
Setup a profile to facilitate domain fronting,T1090,Proxy
the legitimate website will forward the traffic through the CDN to the original destination according to the host header.,T1090,Proxy
domain fronting,T1090,Proxy
domain fronting,T1090,Proxy
domain fronting,T1090,Proxy
domain fronting,T1090,Proxy
malleable C2 profiles are configured to allow domain fronting using the Fastly and AzureEdge CDNs,T1090,Proxy
domain fronting,T1090,Proxy
domain fronting,T1090,Proxy
domain fronting,T1090,Proxy
domain fronting appears to be used by threat actors.,T1090,Proxy
Attackers can use legitimate domains that are registered under the same CDN provider.,T1090,Proxy
HTTP/HTTPS C2 traffic,T1071.001,Application Layer Protocol: Web Protocols
HTTP communication between the Beacon and the Cobalt Strike server,T1071.001,Application Layer Protocol: Web Protocols
other compromised host running the parent HTTP Beacon,T1071.001,Application Layer Protocol: Web Protocols
HTTP Parent Beacon,T1071.001,Application Layer Protocol: Web Protocols
customized for the HTTP-POST Block,T1071.001,Application Layer Protocol: Web Protocols
Encrypting and encoding the data with XOR mask and random key,T1573.001,Encrypted Channel: Symmetric Cryptography
threat actors use their beacon sessions to establish RDP access,T1021.001,Remote Services: Remote Desktop Protocol
attackers was to establish a Remote Desktop session,T1021.001,Remote Services: Remote Desktop Protocol
"to establishing a RDP session, including the ability to navigate using a graphical environment and easily move laterally once the necessary access has been granted",T1021.001,Remote Services: Remote Desktop Protocol
attacker’s Kali Linux host to RDP into our target’s environment,T1021.001,Remote Services: Remote Desktop Protocol
RDP into the target host,T1021.001,Remote Services: Remote Desktop Protocol
Cobalt Strike beacon acts as the intermediary to facilitate the Remote Desktop session,T1021.001,Remote Services: Remote Desktop Protocol
SMB beacons open a local port on the target host and listen for incoming communication from a parent beacon,T1090,Proxy
SMB beacons are mostly used to make network detection harder and to get access to isolated systems where communication to the internet is prohibited,T1090,Proxy
the SMB Beacon is communicating over the network with a parent Beacon using named pipes.,T1090,Proxy
can see the named pipe created that we specified on the Cobalt Strike interface when we created the SMB listener.,T1090,Proxy
RDP into the target host using reverse proxy,T1090,Proxy
threat actors using reverse proxy,T1090,Proxy
a reverse proxy,T1090,Proxy
Reverse Proxy using Cobalt Strike Beacon,T1090,Proxy
the ability to run a SOCKS proxy server on the team server.,T1090,Proxy
This enables the operators to setup a listening port and leverage it to relay traffic to and from the open beacon session,T1090,Proxy
attackers take advantage of this technique using proxychains,T1090,Proxy
employ proxychains from the attacker’s Kali Linux host,T1090,Proxy
via reverse proxy.,T1090,Proxy
can be configured as a proxy,T1090,Proxy
threat actors use their beacon sessions to establish RDP access through a reverse proxy,T1090,Proxy
the victim’s hostname is captured in this logon event,T1082,System Information Discovery
execute the command systeminfo on the compromised host.,T1082,System Information Discovery
it took 148 packets containing DNS requests and responses to finish the task and send back the data to the Cobalt Strike Server.,T1041,Exfiltration Over C2 Channel
which will then send the results to the C2 server,T1041,Exfiltration Over C2 Channel
SSL can be used to complicate command-and-control (C2) traffic analysis,T1095,Non-Application Layer Protocol
"replacing an early call instruction to their malicious code, or by overwriting the entry point in the PE header",T1055,Process Injection
"unpack any additional payloads,",T1027,Obfuscated Files or Information
HTTPS and other protocols built on SSL have,T1071.001,Application Layer Protocol: Web Protocols
service using HTTPS,T1071.001,Application Layer Protocol: Web Protocols
SSL encrypted traffic,T1071.001,Application Layer Protocol: Web Protocols
TLS encrypted data,T1071.001,Application Layer Protocol: Web Protocols
detect when TLS connections are being initiated and log the symmetric keys generated for the SSL/TLS connection,T1573.001,Encrypted Channel: Symmetric Cryptography
"decrypt TLS traffic,",T1140,Deobfuscate/Decode Files or Information
decrypt network traffic,T1140,Deobfuscate/Decode Files or Information
decrypted,T1140,Deobfuscate/Decode Files or Information
the decrypted HTTPS traffic.,T1140,Deobfuscate/Decode Files or Information
encrypt,T1027,Obfuscated Files or Information
SSL encrypted traffic,T1027,Obfuscated Files or Information
TLS encrypted data,T1027,Obfuscated Files or Information
downloads the next stage from a public file storage service,T1105,Ingress Tool Transfer
"embeds the next stages of the execution inside an additional file, usually an XML or a PDF file.",T1027,Obfuscated Files or Information
that embeds the Crypter with the payload.,T1027,Obfuscated Files or Information
the actor embeds the malicious code inside different legitimate codes.,T1027,Obfuscated Files or Information
which enables an HTTPS connection.,T1071.001,Application Layer Protocol: Web Protocols
"Once downloaded and executed, the malicious installer copies its compressed files into a newly created folder with a legitimate-looking name  (i.e., IIS Application Health Monitor) in one of the following directory paths:",T1036.005,Masquerading: Match Legitimate Name or Location
"At first glance, the files within the directory may seem legitimate",T1036.005,Masquerading: Match Legitimate Name or Location
Write a registry Run key,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
Write a.lnk file in the startup folder,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
registry run key persistence implementation,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
The Decryption Shellcode,T1140,Deobfuscate/Decode Files or Information
"The Decryption shellcode has three main tasks: first, it extracts the Loader shellcode and the payload, then it decrypts them, and finally, it transfers the execution to the decrypted Loader shellcode.",T1140,Deobfuscate/Decode Files or Information
Decryption shellcode execution flow,T1140,Deobfuscate/Decode Files or Information
The Decryption shellcode,T1140,Deobfuscate/Decode Files or Information
decrypts it using the denoted decryption key,T1140,Deobfuscate/Decode Files or Information
the decrypted payload,T1140,Deobfuscate/Decode Files or Information
the decrypted payload,T1140,Deobfuscate/Decode Files or Information
the decrypted payload address,T1140,Deobfuscate/Decode Files or Information
An encrypted additional shellcode,T1027,Obfuscated Files or Information
An encrypted payload,T1027,Obfuscated Files or Information
these are encrypted and split inside the XML.,T1027,Obfuscated Files or Information
the user will be encouraged to download a malicious installer,T1204.002,User Execution: Malicious File
"deceive the user into thinking that the application has failed to execute, even as it silently continues the malicious execution in the background.",T1204.002,User Execution: Malicious File
shellcode is to inject the decrypted payload within the currently running process (itself).,T1055,Process Injection
the Loader overwrites the current PE with the final payload’s PE,T1055,Process Injection
It does so by copying the PE headers and each section according to the current executable’s base address.,T1055,Process Injection
the Loader copies the new PE headers to the base address and each section to the relevant location according to the IMAGE_SECTION_HEADER,T1055,Process Injection
the import address table and relocation table of the newly injected PE.,T1055,Process Injection
the newly injected PE,T1055,Process Injection
"Loader removes evidence of injection by using the following methods:
Update the LDR data table entry to match the injected PE.
Remove the injected PE headers from memory.",T1027,Obfuscated Files or Information
disable system defenses,T1562.001,Impair Defenses: Disable or Modify Tools
The process list checked is as follows,T1057,Process Discovery
The services running on the compromised system are checked against the following list,T1057,Process Discovery
"The credentials also allow BlackCat to move laterally within the victim’s system and/or network, often with administrative privileges.",T1078,Valid Accounts
the ransomware to deploy additional tools,T1105,Ingress Tool Transfer
such as Mimikatz,T1003.001,OS Credential Dumping: LSASS Memory
utilizes a unique onion domain,T1090,Proxy
Encrypted Multi-Hop Proxies,T1090,Proxy
cyber actors use the VPS as well as small office and home office (SOHO) devices as operational nodes to evade detection.,T1090,Proxy
have been routinely observed using a VPS as an encrypted proxy.,T1090,Proxy
Some of these nodes operate as part of an encrypted proxy service to prevent attribution by concealing their country of origin and TTPs,T1090,Proxy
cyber actors have been observed using a network of VPSs and small office and home office (SOHO) routers as part of their operational infrastructure to evade detection and host C2 activity,T1090,Proxy
"to locate certain files, paths,",T1083,File and Directory Discovery
cyber actors have been observed using multiple implants with file system enumeration and traversal capabilities.,T1083,File and Directory Discovery
IP address space,T1016,System Network Configuration Discovery
cyber actors have exploited known vulnerabilities in Internet-facing systems,T1190,Exploit Public-Facing Application
exploit targeting a public-facing appliance vulnerability.,T1190,Exploit Public-Facing Application
"Exploiting Internet accessible webservers using webshell small code injections against multiple code languages, including net, asp, apsx, php, japx, and cfm.",T1190,Exploit Public-Facing Application
These emails may contain a malicious link or files that will provide the cyber actor access to the victim’s device,T1566.001,Phishing: Spearphishing Attachment
These emails may contain a malicious link or file that provide the cyber actor access to the victim’s device,T1566.001,Phishing: Spearphishing Attachment
after the user clicks on the malicious link or opens the attachment.,T1204.002,User Execution: Malicious File
the user clicks on the malicious link or opens the attachment.,T1204.002,User Execution: Malicious File
"gaining credential access into victim networks by using legitimate, but compromised credentials to access OWA servers, corporate login portals, and victim networks.",T1078,Valid Accounts
"cyber actors used valid accounts to log into a service specifically designed to accept remote connections,",T1078,Valid Accounts
The actor may then perform actions as the logged-on user.,T1078,Valid Accounts
"cyber actors used valid accounts to log into a service specifically designed to accept remote connections,",T1078,Valid Accounts
The actor may then perform actions as the logged-on user.,T1078,Valid Accounts
"Using cmd.exe,",T1059.003,Command and Scripting Interpreter: Windows Command Shell
Windows Command Shell,T1059.003,Command and Scripting Interpreter: Windows Command Shell
or command line interface tools,T1059.003,Command and Scripting Interpreter: Windows Command Shell
executing malware shellcode and batch files,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Employing Python scripts to exploit vulnerable servers.,T1210,Exploitation of Remote Services
"cyber actors used valid accounts to log into a service specifically designed to accept remote connections, such as telnet, SSH, RDP, and Virtual Network Computing (VNC).",T1210,Exploitation of Remote Services
"cyber actors used valid accounts to log into a service specifically designed to accept remote connections, such as telnet, SSH, RDP, and Virtual Network Computing (VNC).",T1210,Exploitation of Remote Services
such as schtask or crontab to create and schedule tasks that enumerate victim devices and networks.,T1053.005,Scheduled Task/Job: Scheduled Task
to establish new services to enable persistence.,T1543.003,Create or Modify System Process: Windows Service
cyber actors have also been observed modifying group policies for password exploitation.,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
usage of Mimikatz,T1003.001,OS Credential Dumping: LSASS Memory
observed targeting the LSASS process or Active directory (NDST.DIT) for credential dumping.,T1003.001,OS Credential Dumping: LSASS Memory
"Injecting into the rundll32.exe process to hide usage of Mimikatz, as well as injecting into a running legitimate explorer.exe process for lateral movement.",T1055,Process Injection
Using shellcode that injects implants into newly created instances of the Service Host process (svchost),T1055,Process Injection
were observed using the 7-Zip utility to unzip imported tools and malware files onto the victim device.,T1140,Deobfuscate/Decode Files or Information
cyber actors have been observed deleting files using rm or del commands.,T1070.004,Indicator Removal: File Deletion
cyber actors were observed Base64 encoding files and command strings to evade security measures.,T1027,Obfuscated Files or Information
have been observed using Base-64 encoded commands,T1027,Obfuscated Files or Information
"were observed using Microsoft signed binaries, such as Rundll32, as a proxy to execute malicious payloads.",T1218.011,System Binary Proxy Execution: Rundll32
"have been observed using commands, including tasklist, jobs, ps, or taskmgr, to reveal the running processes on victim devices.",T1057,Process Discovery
cyber actors also used on-premises Identity and Access Management (IdAM) and federation services in hybrid cloud environments in order to pivot to cloud resources.,T1078,Valid Accounts
cyber actors also used on-premises Identity and Access Management (IdAM) and federation services in hybrid cloud environments in order to pivot to cloud resources.,T1078,Valid Accounts
cyber actors used RDP,T1021.001,Remote Services: Remote Desktop Protocol
cyber actors have been observed using the mv command to export files into a location,T1074.001,Data Staged: Local Data Staging
a downloader that downloads and executes a payload,T1105,Ingress Tool Transfer
cyber actors have been observed importing tools from GitHub or infected domains to victim networks,T1105,Ingress Tool Transfer
cyber actors used the Server Message Block (SMB) protocol to import tools into victim networks.,T1570,Lateral Tool Transfer
it also tries to delete the wp-sale.js file,T1070.004,Indicator Removal: File Deletion
obfuscated PHP code (again using character code obfuscation):,T1027,Obfuscated Files or Information
a heavily obfuscated script,T1027,Obfuscated Files or Information
obfuscated JavaScript code,T1027,Obfuscated Files or Information
When decoded,T1140,Deobfuscate/Decode Files or Information
"When decoded, a backdoor is revealed",T1140,Deobfuscate/Decode Files or Information
sent as a POST request,T1071.001,Application Layer Protocol: Web Protocols
This backdoor executes arbitrary PHP code sent in POST request parameters.,T1071.001,Application Layer Protocol: Web Protocols
actors disable antivirus software,T1562.001,Impair Defenses: Disable or Modify Tools
the threat actor deactivated antivirus protocols,T1562.001,Impair Defenses: Disable or Modify Tools
after receiving phishing emails containing malicious PDF documents [T,T1566.001,Phishing: Spearphishing Attachment
for initial access is RDP compromise.,T1021.001,Remote Services: Remote Desktop Protocol
actors often use RDP to move laterally across the network,T1021.001,Remote Services: Remote Desktop Protocol
download multiple tools ,T1105,Ingress Tool Transfer
actors gain initial access through exploiting public-facing applications ,T1190,Exploit Public-Facing Application
PsExec has also been used to aid lateral movement,T1570,Lateral Tool Transfer
actors used a legitimate admin account to remotely log on to the domain controller,T1078,Valid Accounts
by modifying Group Policy Objects,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
force a group policy update,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
delete files upon completion—including,T1070.004,Indicator Removal: File Deletion
numerous batch (.bat) files on impacted systems,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Batch files create a new admin user ,T1059.003,Command and Scripting Interpreter: Windows Command Shell
which are typically transferred as an encrypted 7zip file.,T1027,Obfuscated Files or Information
These strings are passed to a decoding function where they are converted from hex to byte and XOR’d with decimal 18.,T1140,Deobfuscate/Decode Files or Information
the decoded strings,T1140,Deobfuscate/Decode Files or Information
Once decoded,T1140,Deobfuscate/Decode Files or Information
Base64 decodes the payload content,T1140,Deobfuscate/Decode Files or Information
to decode the second buffer using key 58 3E 88 D0,T1140,Deobfuscate/Decode Files or Information
decoded by Shellcode,T1140,Deobfuscate/Decode Files or Information
"These strings are passed to a
de-obfuscation function",T1140,Deobfuscate/Decode Files or Information
PowerShell de-obfuscation routine,T1140,Deobfuscate/Decode Files or Information
this shellcode is responsible for fetching Remcos RAT,T1105,Ingress Tool Transfer
used to retrieve a payload package containing the second stage PowerShell and two shellcode buffers,T1105,Ingress Tool Transfer
retrieves a decoy tax document and VBS script.,T1105,Ingress Tool Transfer
copying the current process command line as a new argument,T1059.003,Command and Scripting Interpreter: Windows Command Shell
full command line argument,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"a single payload
package is retrieved that contains both the two-stage shellcode",T1027,Obfuscated Files or Information
highly obfuscated commands and encrypted shellcode.,T1027,Obfuscated Files or Information
The PowerShell command contains various obfuscated strings,T1027,Obfuscated Files or Information
inject Remcos RAT into a legitimate Windows process such as ieinstal.exe.,T1055,Process Injection
injecting it into ieinstall.exe,T1055,Process Injection
execution begins with the user clicking on a shortcut file,T1204.002,User Execution: Malicious File
executed by the user clicking a shortcut file,T1204.002,User Execution: Malicious File
enticing users to click on malicious shortcut files,T1204.002,User Execution: Malicious File
checks if the system is 64-bit,T1082,System Information Discovery
remote access and surveillance features,T1219,Remote Access Software
keylogging,T1056.001,Input Capture: Keylogging
screenshots,T1113,Screen Capture
highly obfuscated and contains junk code to impede analysis.,T1027,Obfuscated Files or Information
The script concatenates hundreds of smaller strings into a single variable which ultimately builds and executes,T1027,Obfuscated Files or Information
The payload would then be decrypted through XOR,T1140,Deobfuscate/Decode Files or Information
use a set of tools via remote desktop,T1021.001,Remote Services: Remote Desktop Protocol
the ransomware drops a batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
to steal system information like machine details,T1082,System Information Discovery
the payload most likely arrives by exploiting public-facing websites and domains.,T1190,Exploit Public-Facing Application
targeted vulnerabilities in Microsoft SQL (MS SQL) Server for initial access,T1190,Exploit Public-Facing Application
"the payload downloaded by the PowerShell script was a .NET downloader, which would subsequently retrieve an encrypted payload from the command-and-control (C&C) server",T1105,Ingress Tool Transfer
used different sets of defense evasion and reconnaissance tools such as GMER and Advance Process Termination to manually uninstall antivirus products on the target system.,T1562.001,Impair Defenses: Disable or Modify Tools
to terminate security-related processes and services by dropping KILLAV,T1562.001,Impair Defenses: Disable or Modify Tools
the threat actors who perform brute-force attacks on MS SQL Servers.,T1110,Brute Force
"executed a spam campaign with malicious OneNote file attachments,",T1566.001,Phishing: Spearphishing Attachment
The initial attack phase involves infiltrating Internet-facing Microsoft Exchange servers,T1190,Exploit Public-Facing Application
The malware implemented a series of Mimikatz modifications on closed-source tooling,T1003.001,OS Credential Dumping: LSASS Memory
staging a credential theft capability in the LSASS process itself by abusing native Windows capabilities,T1003.001,OS Credential Dumping: LSASS Memory
"In order to steal credentials, the attackers employ custom modified versions of Mimikatz",T1003.001,OS Credential Dumping: LSASS Memory
stealing credentials from the Local Security Authority Subsystem Service (LSASS) process.,T1003.001,OS Credential Dumping: LSASS Memory
Mimikatz publicly available code (top); strings from a Mimikatz modification,T1003.001,OS Credential Dumping: LSASS Memory
"This call instructs LSASS to load and execute pc.dll, which then stages the getHashFlsa64.dll credential theft component.",T1003.001,OS Credential Dumping: LSASS Memory
accesses the memory of its host LSASS process and stores stolen credentials in a Mimikatz log file,T1003.001,OS Credential Dumping: LSASS Memory
of a Security Package into LSASS using RPC calls.,T1003.001,OS Credential Dumping: LSASS Memory
steals credentials from LSASS,T1003.001,OS Credential Dumping: LSASS Memory
The threat actors used C:\MS_DATA as their main working directory for storing malware and staging data for exfiltration,T1074.001,Data Staged: Local Data Staging
and Remote Desktop user sessions.,T1021.001,Remote Services: Remote Desktop Protocol
"""cmd""  /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"cmd""  /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"cmd""  /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"cmd""  /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"""cmd""  /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"""cmd""  /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"""cmd""  /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"""cmd""  /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"""cmd""  /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"""cmd""  /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"""cmd""  /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"""cmd""  /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"""cmd""  /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"They also retrieve networking information, like network adapters, specific machines, and network services like  Remote Desktop Protocol (RDP).",T1016,System Network Configuration Discovery
"For lateral movement, the attackers made use of the PsExec tool and the net use command for accessing shared resources on remote machines.",T1570,Lateral Tool Transfer
and the PsExec Windows Sysinternals tool and net for lateral movement and exploration,T1570,Lateral Tool Transfer
loads and executes the decrypted,T1140,Deobfuscate/Decode Files or Information
pc.exe decrypts AddSecurityPackage64.dll and pc.dll using the AES encryption algorithm,T1140,Deobfuscate/Decode Files or Information
"pc.dll decrypts,",T1140,Deobfuscate/Decode Files or Information
Disabling Windows event logging in an attempt to evade detection,T1562.001,Impair Defenses: Disable or Modify Tools
"In an attempt to remain undetected, AddSecurityPackage64.dll disables Windows event logging by killing threads of the Windows Event Log service without stopping the execution of the service itself",T1562.001,Impair Defenses: Disable or Modify Tools
Injecting pc.dll into LSASS as a Security Package,T1055,Process Injection
to execute malicious code in the context of LSASS.,T1055,Process Injection
"enumerating the processes’ threads,",T1057,Process Discovery
tasklist,T1057,Process Discovery
informationAddSecurityPackage64.dll injects pc.dll into LSASS by deploying pc.dll as a Security Package,T1055,Process Injection
embedded JavaScript Observed Notation (JSON)-based configuration to set parameters,T1027,Obfuscated Files or Information
text-encoded in base64,T1027,Obfuscated Files or Information
brute-force attacks,T1110,Brute Force
brute-forcing and compromising servers,T1110,Brute Force
Valid credentials,T1078,Valid Accounts
"uploaded to the command-and-control (C&C) server,",T1041,Exfiltration Over C2 Channel
usually at port 5028/TCP,T1095,Non-Application Layer Protocol
use several highly obfuscated and underdevelopment custom loaders,T1027,Obfuscated Files or Information
malicious RAR archive,T1027,Obfuscated Files or Information
"exploits CVE-2015-2291, an Intel driver vulnerability, to load a malicious driver designed to reduce the token integrity of Microsoft Defender.",T1068,Exploitation for Privilege Escalation
deploying a malicious kernel mode driver (“bring your own vulnerable driver” or BYOVD method) via exploiting a vulnerable Intel driver,T1068,Exploitation for Privilege Escalation
install an information stealer.,T1005,Data from Local System
"stealer,",T1005,Data from Local System
keylogger with logging capabilities using the Telegram API,T1056.001,Input Capture: Keylogging
distributed to victims via phishing attempts,T1566.001,Phishing: Spearphishing Attachment
embedded binary files,T1027,Obfuscated Files or Information
"archive contains the files,",T1140,Deobfuscate/Decode Files or Information
"deobfuscate, decompress,",T1140,Deobfuscate/Decode Files or Information
decrypts strings,T1140,Deobfuscate/Decode Files or Information
"deobfuscation, and decompression",T1140,Deobfuscate/Decode Files or Information
decompressing,T1140,Deobfuscate/Decode Files or Information
"decompresses it using the GZipStream API,",T1140,Deobfuscate/Decode Files or Information
masquerades as a legitimate word document,T1036.005,Masquerading: Match Legitimate Name or Location
legitimize the package in the eyes of the victim,T1036.005,Masquerading: Match Legitimate Name or Location
designed to lure unsuspecting victims into executing the loader.,T1204.002,User Execution: Malicious File
is executed by the victim,T1204.002,User Execution: Malicious File
utilizes Telegram for delivering payloads,T1105,Ingress Tool Transfer
download,T1105,Ingress Tool Transfer
used to send program execution DEBUG and Telegram to deliver payloads and send commands.,T1105,Ingress Tool Transfer
downloads the next part,T1105,Ingress Tool Transfer
"utilizes Telegram for delivering payloads, sending commands, and receiving the payload heartbeat.",T1095,Non-Application Layer Protocol
send commands.,T1095,Non-Application Layer Protocol
sends a request to the attacker-controlled Telegram channel,T1095,Non-Application Layer Protocol
"sends the message ""bot getted"" to the debug server.",T1095,Non-Application Layer Protocol
"accepts commands from a Telegram channel,",T1095,Non-Application Layer Protocol
"message to both the Debug server and the Telegram channel,",T1095,Non-Application Layer Protocol
sends a GET request to  https://api[.]telegram[.]org/bot{token}/getUpdates to retrieve the command,T1095,Non-Application Layer Protocol
API hashing,T1027,Obfuscated Files or Information
resolves hashed Windows APIs,T1027,Obfuscated Files or Information
conceal the utilization of potentially suspicious APIs (functions) from static detection,T1027,Obfuscated Files or Information
"replacing the human-readable names of functions (such as ""CreateMutexW"") with a hash value,",T1027,Obfuscated Files or Information
used in the code to call the corresponding API function,T1027,Obfuscated Files or Information
employs dynamic API resolving to conceal its API imports,T1027,Obfuscated Files or Information
"storing the names or hashes of the APIs needed, then importing them dynamically at runtime.",T1027,Obfuscated Files or Information
"passes two arguments to the ""mw_resolveAPI"" function.",T1027,Obfuscated Files or Information
resolves the given API hash and retrieves the address of an exported function,T1027,Obfuscated Files or Information
creating a hash for each export function name,T1027,Obfuscated Files or Information
"string encryption,",T1027,Obfuscated Files or Information
irrelevant code,T1027,Obfuscated Files or Information
LoadLibrary and GetProcAddress functions,T1106,Native API
Compressapi,T1106,Native API
GetTokenInformation API.,T1106,Native API
retrieves the MachineGuid of the infected system from the SOFTWARE\Microsoft\Cryptography\MachineGuid registry key,T1012,Query Registry
"retrieves the MachineGuid of the infected system from the ""SOFTWARE\Microsoft\Cryptography\MachineGuid"" registry key.",T1012,Query Registry
deletes the HKCU\SOFTWARE\Intel registry key and recreates it,T1112,Modify Registry
collects information about the .NET Framework Setup,T1082,System Information Discovery
elevate its privileges by executing the mw_UAC_bypass function,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
Calling Local Windows RPC Servers from .NET,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
bypass user account control (UAC) using only two remote procedure call (RPC) requests,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
"executes an export function called ""Entry"" from UpdateTask.dll via rundll32.exe",T1218.011,System Binary Proxy Execution: Rundll32
payload through rundll32.exe,T1218.011,System Binary Proxy Execution: Rundll32
disable Microsoft Defender,T1562.001,Impair Defenses: Disable or Modify Tools
patch the integrity level of the Microsoft defender (MsMpEng.exe) and forcibly reduce it from system to untrusted integrity.,T1562.001,Impair Defenses: Disable or Modify Tools
determine if it is running as an account with administrator privileges or simply as a regular user,T1033,System Owner/User Discovery
creating scheduled tasks,T1053.005,Scheduled Task/Job: Scheduled Task
sets up its working directory,T1074.001,Data Staged: Local Data Staging
collect system information and steals user information,T1074.001,Data Staged: Local Data Staging
"tokens, and passwords from various web browsers and applications",T1078,Valid Accounts
captures screenshots,T1113,Screen Capture
compressed and exfiltrated to the attacker via Telegram,T1041,Exfiltration Over C2 Channel
"some strings, such as web browser paths and Geolocation API services URLs, are encrypted with the AES algorithm in cipher-block chaining (CBC) mode",T1573.001,Encrypted Channel: Symmetric Cryptography
"gathers basic system information,",T1082,System Information Discovery
for the infected system by gathering the username and hostname,T1082,System Information Discovery
"the malware then proceeds to gather basic system information, including username, computer name, and OS version,",T1082,System Information Discovery
"System info, including both hardware and OS info.",T1082,System Information Discovery
Collection of information about the system in HTML format,T1082,System Information Discovery
and hostname,T1082,System Information Discovery
"gathers basic system information, which it then sends to the C2,",T1041,Exfiltration Over C2 Channel
send a list of process names and IDs back to the C2,T1041,Exfiltration Over C2 Channel
the system information gathered by Domino Backdoor and sent to the C2,T1041,Exfiltration Over C2 Channel
in return receives an AES encrypted payload.,T1027,Obfuscated Files or Information
uses a custom algorithm which XOR’s multiple values together.,T1027,Obfuscated Files or Information
which is stored immediately before the encrypted config block.,T1027,Obfuscated Files or Information
"The malware generates a random 32-byte key, which it encrypts using the RSA key.",T1027,Obfuscated Files or Information
loading an encrypted payload from its resources,T1027,Obfuscated Files or Information
The Microsoft WinCrypt library is used for AES encryption and,T1027,Obfuscated Files or Information
the encrypted config.,T1027,Obfuscated Files or Information
be based on an encryption algorithm used previously in,T1027,Obfuscated Files or Information
by gathering the username and,T1033,System Owner/User Discovery
"to gather basic system information, including username,",T1033,System Owner/User Discovery
is generated from the system username,T1033,System Owner/User Discovery
used a similar XOR-based algorithm as part of its encryption mechanisms during communication with the C2.,T1573.001,Encrypted Channel: Symmetric Cryptography
"then proceeds to gather basic system information, including username, computer name, and OS version, which it then encrypts using AES-256-CBC and the generated,",T1573.001,Encrypted Channel: Symmetric Cryptography
then sends the AES-encrypted system data.,T1573.001,Encrypted Channel: Symmetric Cryptography
This data is then encrypted using AES and returned to the C2.,T1573.001,Encrypted Channel: Symmetric Cryptography
the decrypted config contains two pipe-delimited IP addresses,T1140,Deobfuscate/Decode Files or Information
and decrypts them using XOR and the key,T1140,Deobfuscate/Decode Files or Information
"The malware then proceeds to decrypt its configuration block,",T1140,Deobfuscate/Decode Files or Information
The config is decrypted using XOR and a 16-byte key,T1140,Deobfuscate/Decode Files or Information
"A second config block, which is decrypted separately",T1140,Deobfuscate/Decode Files or Information
The decrypted data consists of a 4 byte size,T1140,Deobfuscate/Decode Files or Information
The malware then decrypts the received payload using AES and the shared key.,T1140,Deobfuscate/Decode Files or Information
which decrypts to the following 5 bytes,T1140,Deobfuscate/Decode Files or Information
decrypting it using AES-256-CBC and a hardcoded key.,T1140,Deobfuscate/Decode Files or Information
"The decrypted data consists of 4 bytes containing the payload size,",T1140,Deobfuscate/Decode Files or Information
The Microsoft WinCrypt library is used for AES encryption and decryption by both,T1140,Deobfuscate/Decode Files or Information
is decrypted using XOR and a 16-byte key,T1140,Deobfuscate/Decode Files or Information
executes the decrypted shellcode,T1140,Deobfuscate/Decode Files or Information
loads the resources using the API calls LdrFindResource_U and LdrAccessResource,T1106,Native API
and execute the file using CreateProcessA.,T1106,Native API
"utilising similar API calls,",T1106,Native API
the malware enumerates the running processes on the system and compiles a list of process names and IDs.,T1057,Process Discovery
enumerate running processes and send a list of process names and IDs back to the C2,T1057,Process Discovery
Enumerates running processes,T1057,Process Discovery
the loader allocates memory within the current process and then loads the PE payload into it using the full PE loading procedure.,T1055,Process Injection
"It copies the headers, maps the individual PE sections,  processes any relocations,  loads the PE’s imports, and then executes the PE from its internally specified entry point.",T1055,Process Injection
"passes the PE payload to it, which the shellcode then loads and executes.",T1055,Process Injection
Enumerate files on desktop,T1083,File and Directory Discovery
Enumerates files under Steam application directory,T1083,File and Directory Discovery
looping through entries under registry key,T1012,Query Registry
"waits for data collection tasks to complete,",T1005,Data from Local System
"creating a hash of the collected data, to which it then appends its current process id.",T1005,Data from Local System
uploads data to the C2 via a HTTP POST request,T1071.001,Application Layer Protocol: Web Protocols
http/https data transfer,T1071.001,Application Layer Protocol: Web Protocols
Self-delete after sending data,T1070.004,Indicator Removal: File Deletion
It then attempts to connect to the C2 via TCP port 443,T1095,Non-Application Layer Protocol
"ranswomare for Windows can self-propagate in the local area network using the legitimate PsExec utility (contained in its body), which creates a temporary system service.",T1569.002,System Services: Service Execution
Legitimate accounts obtained by the attackers can be used to ensure persistence in the compromised infrastructure.,T1078,Valid Accounts
may use stolen legitimate accounts specified in the configuration data.,T1078,Valid Accounts
uses the command shell to run appropriate commands,T1059.003,Command and Scripting Interpreter: Windows Command Shell
an additional BAT file contained in the body of the ransomware.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"The attackers may use wmic to obtain information and run various commands,",T1047,Windows Management Instrumentation
They may also use the wmiexec module from Impacket to execute commands and move across the network.,T1047,Windows Management Instrumentation
uses wmic to obtain the,T1047,Windows Management Instrumentation
ransomware uses Native API.,T1106,Native API
the function CreateProcessWithLogonW.,T1106,Native API
"affiliates may exploit group policies, which results in a scheduled task being created (on each host) that launches the ransomware.",T1053.005,Scheduled Task/Job: Scheduled Task
disabling security tools,T1562.001,Impair Defenses: Disable or Modify Tools
"To prevent being detected, the attackers end processes and services related to security and antivirus software.",T1562.001,Impair Defenses: Disable or Modify Tools
"To bypass UAC, BlackCat ransomware may escalate privileges using the ICMLuaUtil COM interface, as well as use the Masquerade PEB method.",T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
"Bypass User Account Control;The attackers may bypass UAC using the ICMLuaUtil COM interface, as well as use the Masquerade PEB method.",T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
decrypts configuration data as well as decrypts and unpacks the legitimate PsExec utility,T1140,Deobfuscate/Decode Files or Information
unpacks the legitimate PsExec utility,T1027,Obfuscated Files or Information
ransomware uses obfuscation.,T1027,Obfuscated Files or Information
use a SoftPerfect Network Scanner executable renamed to svchost.exe.,T1036.005,Masquerading: Match Legitimate Name or Location
uses PsExec to modify the system registry parameter MaxMpxCt,T1112,Modify Registry
"To obtain authentication data, the attackers may dump the LSASS process using legitimate tools (procdump, comsvcs.dll).",T1003.001,OS Credential Dumping: LSASS Memory
"To obtain authentication data from the registry and files, the attackers may use NirSoft utilities.",T1552.001,Unsecured Credentials: Credentials In Files
"The attackers enumerate drives, directories, and files",T1083,File and Directory Discovery
to search for sensitive information for exfiltration purposes.,T1005,Data from Local System
The attackers collect information from the local system for exfiltration purposes.,T1005,Data from Local System
The attackers may use RDP to move across the network.,T1021.001,Remote Services: Remote Desktop Protocol
uses wmic to obtain the UUID of the compromised host.,T1082,System Information Discovery
enumerates all running processes,T1057,Process Discovery
;Moving across the victim’s network and deploying ransomware involves copying related tools to the host.,T1570,Lateral Tool Transfer
can self-propagate in the network by using the legitimate PsExec utility,T1570,Lateral Tool Transfer
to search for ones relating to security,T1518.001,Software Discovery: Security Software Discovery
enumerates system services to search for ones relating to security,T1518.001,Software Discovery: Security Software Discovery
"Before exfiltration, the attackers may put collected data in 7Zip archives.",T1074.001,Data Staged: Local Data Staging
"Remote access tools used by the attackers may use application layer protocols (HTTP, HTTPS,",T1071.001,Application Layer Protocol: Web Protocols
"When the attackers use Cobalt Strike, the collected information may be sent via Cobalt Strike server communication channels.",T1041,Exfiltration Over C2 Channel
"To remotely access the compromised infrastructure, the attackers may use the legitimate tools TeamViewer and ScreenConnect.",T1219,Remote Access Software
"To remotely access the compromised infrastructure, the attackers may use Cobalt Strike, TeamViewer and ScreenConnect",T1219,Remote Access Software
which perform asymmetric/symmetric encryption of the C&C server communication channel.,T1573.001,Encrypted Channel: Symmetric Cryptography
the attackers copy tools necessary for deployment to the compromised host.,T1105,Ingress Tool Transfer
the malware executes a command to delete itself from the system,T1070.004,Indicator Removal: File Deletion
delete key files,T1070.004,Indicator Removal: File Deletion
"attackers have been seen using several methods to distribute the wiper through the domain, like: domain Group Policy Object (GPO)",T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
installs the payload as a service,T1543.003,Create or Modify System Process: Windows Service
sets a hardcoded list of system directories,T1083,File and Directory Discovery
system directories are targeted,T1083,File and Directory Discovery
enumerates their partitions.,T1083,File and Directory Discovery
an obfuscated .NET program.,T1027,Obfuscated Files or Information
WMI,T1047,Windows Management Instrumentation
to identify where the Operative System is stored in the disk,T1082,System Information Discovery
Application-level protocol,T1071.001,Application Layer Protocol: Web Protocols
sends the output of ipconfig in a POST request,T1071.001,Application Layer Protocol: Web Protocols
the opening of a URL file extracted from the archive.,T1071.001,Application Layer Protocol: Web Protocols
output of ipconfig was sent to one of two addresses,T1071.001,Application Layer Protocol: Web Protocols
Application-level protocol,T1071.001,Application Layer Protocol: Web Protocols
a GET request is sent to the C2 server.,T1071.001,Application Layer Protocol: Web Protocols
application-level messages from the server to the client is sent as the body of an HTTP response,T1071.001,Application Layer Protocol: Web Protocols
are sent using separate POST requests.,T1071.001,Application Layer Protocol: Web Protocols
sends an HTTPS request,T1071.001,Application Layer Protocol: Web Protocols
same IP address was used as C2 server,T1071.001,Application Layer Protocol: Web Protocols
domains give attackers the ability to mask malicious traffic as legitimate activity within the company,T1071.001,Application Layer Protocol: Web Protocols
HttpConnector and HttpBindConnector are HTTP client with support for proxy and HTTP server.,T1071.001,Application Layer Protocol: Web Protocols
HTTP and HTTPS are supported,T1071.001,Application Layer Protocol: Web Protocols
HTTP with long polling,T1071.001,Application Layer Protocol: Web Protocols
connect by sending a GET request to a URL from the configuration and provide a special cookie value,T1071.001,Application Layer Protocol: Web Protocols
sends GET requests with pull operations.,T1071.001,Application Layer Protocol: Web Protocols
POST request with push operation,T1071.001,Application Layer Protocol: Web Protocols
Application-level protocol,T1071.001,Application Layer Protocol: Web Protocols
use HTTP/HTTPS for C2 connections,T1071.001,Application Layer Protocol: Web Protocols
An encrypted resume,T1027,Obfuscated Files or Information
archive,T1027,Obfuscated Files or Information
archive contains a bait PDF document,T1027,Obfuscated Files or Information
XOR encrypted with a 16-byte key,T1027,Obfuscated Files or Information
obfuscated with VMProtect,T1027,Obfuscated Files or Information
additional XOR encryption with the key,T1027,Obfuscated Files or Information
AES-128-CBC for encryption.,T1027,Obfuscated Files or Information
hashed with MD5,T1027,Obfuscated Files or Information
use AES-128 in CFB mode as the encryption algorithm,T1027,Obfuscated Files or Information
encrypted with the algorithm,T1027,Obfuscated Files or Information
a RAR archive,T1027,Obfuscated Files or Information
distributed in a RAR archive,T1027,Obfuscated Files or Information
ROR-13 hash,T1027,Obfuscated Files or Information
re-encrypted and saved in the same location,T1027,Obfuscated Files or Information
encrypted header,T1027,Obfuscated Files or Information
encrypted Base64 string containing the session GUID,T1027,Obfuscated Files or Information
compressed with GZip prior to encryption,T1027,Obfuscated Files or Information
are obfuscated with VMProtect,T1027,Obfuscated Files or Information
obfuscated,T1027,Obfuscated Files or Information
obfuscated code,T1027,Obfuscated Files or Information
is encrypted in the file,T1027,Obfuscated Files or Information
is re-encrypted,T1027,Obfuscated Files or Information
has been obfuscated with the same rel_jmp and fake-jb techniques,T1027,Obfuscated Files or Information
SFX archive,T1027,Obfuscated Files or Information
SFX archive,T1027,Obfuscated Files or Information
RAR and SFX-RAR files,T1027,Obfuscated Files or Information
plus the folder,T1027,Obfuscated Files or Information
"malicious archive,",T1027,Obfuscated Files or Information
located in the data sections,T1027,Obfuscated Files or Information
shellcode is located in a PE file overlay.,T1027,Obfuscated Files or Information
(encrypted) shellcode,T1027,Obfuscated Files or Information
consists of two .exe files.,T1027,Obfuscated Files or Information
contains three identical executable files,T1027,Obfuscated Files or Information
contains just one file:,T1027,Obfuscated Files or Information
which is also embedded inside the CHM file,T1027,Obfuscated Files or Information
three sections are extracted,T1027,Obfuscated Files or Information
malicious shortcuts,T1036.005,Masquerading: Match Legitimate Name or Location
Web lnks with two shortcuts:,T1036.005,Masquerading: Match Legitimate Name or Location
copies the payload to the folder C:\Users\Public\Downloads,T1036.005,Masquerading: Match Legitimate Name or Location
PDF documents with a CV and IELTS certificate,T1036.005,Masquerading: Match Legitimate Name or Location
the folder C:\Users\Public,T1036.005,Masquerading: Match Legitimate Name or Location
copied to the folder %appdata%\Microsoft\AddIns\,T1036.005,Masquerading: Match Legitimate Name or Location
into the folder c:\programdata,T1036.005,Masquerading: Match Legitimate Name or Location
folder c:\programdata,T1036.005,Masquerading: Match Legitimate Name or Location
trying to open either of the shortcuts,T1204.002,User Execution: Malicious File
If the user opens it directly,T1204.002,User Execution: Malicious File
"tries to make users run malicious .lnk, .chm, and .exe files",T1204.002,User Execution: Malicious File
"running a command that extracts a Base64-encoded CAB archive from the body of the LNK file,",T1140,Deobfuscate/Decode Files or Information
archive is unpacked to a temporary folder.,T1140,Deobfuscate/Decode Files or Information
an extracted JS script,T1140,Deobfuscate/Decode Files or Information
extract shellcode,T1140,Deobfuscate/Decode Files or Information
decrypts the string,T1140,Deobfuscate/Decode Files or Information
used for decryption:,T1140,Deobfuscate/Decode Files or Information
is unpacked,T1140,Deobfuscate/Decode Files or Information
unpacks,T1140,Deobfuscate/Decode Files or Information
encrypted portion of the data is decrypted,T1140,Deobfuscate/Decode Files or Information
is decrypted,T1140,Deobfuscate/Decode Files or Information
decryption and decompression,T1140,Deobfuscate/Decode Files or Information
decryption,T1140,Deobfuscate/Decode Files or Information
decodes it into shellcode with Base64,T1140,Deobfuscate/Decode Files or Information
decrypt,T1140,Deobfuscate/Decode Files or Information
uses a custom PL format with encryption,T1140,Deobfuscate/Decode Files or Information
adding itself to the startup folder,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
"writes the file svchost.bat, which transfers control to winness.exe, to the startup folder",T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
persists by means of a registry run key or a startup folder,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
"adding a scheduler task,",T1053.005,Scheduled Task/Job: Scheduled Task
creates a task with schtasks for persistence,T1053.005,Scheduled Task/Job: Scheduled Task
that all three intermediate C2 servers,T1090,Proxy
possible proxy servers (any indicated in the configuration plus system proxies) and C2 servers,T1090,Proxy
domains give attackers the ability to mask malicious traffic as legitimate activity within the company,T1090,Proxy
proxy server,T1090,Proxy
proxy,T1090,Proxy
– proxy server address and credentials,T1090,Proxy
proxy server,T1090,Proxy
collects and sends system information,T1005,Data from Local System
OS uptime,T1082,System Information Discovery
Operating system version and whether it is 32-bit or 64-bit,T1082,System Information Discovery
"Computer name
Name of running module
PID",T1082,System Information Discovery
Shellcode version and whether it is 32-bit or 64-bit,T1082,System Information Discovery
Whether the OS is 32-bit or 64-bit,T1082,System Information Discovery
Computer name,T1082,System Information Discovery
collect information about the computer name and OS version and whether it is 32-bit or 64-bit,T1082,System Information Discovery
"Network adapter IP addresses
MAC address of one of the adapters",T1016,System Network Configuration Discovery
List of IP addresses,T1016,System Network Configuration Discovery
MAC addresses of network adapters,T1016,System Network Configuration Discovery
Collects the configuration of active connector instances other than the RPCConnector and RPCBindConnector classes.,T1016,System Network Configuration Discovery
collect information about the IP and MAC addresses of the infected machine,T1016,System Network Configuration Discovery
Username,T1033,System Owner/User Discovery
Username and workgroup,T1033,System Owner/User Discovery
collect information about the name of the current user,T1033,System Owner/User Discovery
Transport-level protocol,T1095,Non-Application Layer Protocol
Standard TCP connection,T1095,Non-Application Layer Protocol
two TCP connections.,T1095,Non-Application Layer Protocol
Duplication of socket with TLS connection,T1095,Non-Application Layer Protocol
establishes a TCP connection,T1095,Non-Application Layer Protocol
messages are exchanged in the original TCP connection (without TLS encryption).,T1095,Non-Application Layer Protocol
KCP protocol,T1095,Non-Application Layer Protocol
uses KCP on top of a TCP connection,T1095,Non-Application Layer Protocol
three ways to connect to the C2 server,T1095,Non-Application Layer Protocol
"Transport protocol 3, port 8443
Transport protocol 2, port 80
Transport protocol 1, port 8080",T1095,Non-Application Layer Protocol
TcpConnector and TcpBindConnector are classes responsible for connecting over TCP as client and server,T1095,Non-Application Layer Protocol
"Transport protocols
TCP",T1095,Non-Application Layer Protocol
RPC (Pipe),T1095,Non-Application Layer Protocol
Network-level protocol,T1095,Non-Application Layer Protocol
KCP protocol,T1095,Non-Application Layer Protocol
KCP protocol,T1095,Non-Application Layer Protocol
support for multiple transport protocols for connecting to C2 servers,T1095,Non-Application Layer Protocol
use TCP and UDP for C2 connections,T1095,Non-Application Layer Protocol
AES-128 is the encryption algorithm used.,T1573.001,Encrypted Channel: Symmetric Cryptography
encrypted with AES-256-CBC;,T1573.001,Encrypted Channel: Symmetric Cryptography
is encrypted in the standard way,T1573.001,Encrypted Channel: Symmetric Cryptography
"encrypted in the backdoor's standard way,",T1573.001,Encrypted Channel: Symmetric Cryptography
data is encrypted in the standard way,T1573.001,Encrypted Channel: Symmetric Cryptography
uses AES for encrypting traffic in its backdoors,T1573.001,Encrypted Channel: Symmetric Cryptography
injectors,T1055,Process Injection
run it in an active process,T1055,Process Injection
running an arbitrary command in a CHM file via an ActiveX object,T1055,Process Injection
runs in a new process,T1055,Process Injection
is injected in a similar way,T1055,Process Injection
injected into,T1055,Process Injection
Crosswalk and Metasploit injectors,T1055,Process Injection
inject shellcode into the process,T1055,Process Injection
SeDebugPrivilege,T1106,Native API
finds the API functions it needs,T1106,Native API
Microsoft CryptoAPI,T1106,Native API
Cryptography API:,T1106,Native API
via a ZwCreateSection call,T1106,Native API
via ZwMapViewOfSection calls,T1106,Native API
execute a method from the .NET assembly,T1106,Native API
HttpWebRequest and HttpListener from .NET Framework are used for client and server implementations,T1106,Native API
RPCConnector and RPCBindConnector,T1106,Native API
TcpBindConnector and HttpBindConnector,T1106,Native API
TcpConnector/TcpBindConnector,T1106,Native API
CreateThread,T1106,Native API
uses various WinAPI functions to run malicious shellcode in the current process or to inject it into another process,T1106,Native API
finds the PID of the target process,T1057,Process Discovery
Current processes are checked,T1057,Process Discovery
"Name of running module
PID",T1057,Process Discovery
injects shellcode into it,T1055,Process Injection
"injects shellcode into the processes explorer.exe, winlogon.exe, wmplayer.exe, svchost.exe, and spoolsv.exe",T1055,Process Injection
archive was distributed,T1105,Ingress Tool Transfer
unpacks an HTML,T1027,Obfuscated Files or Information
is unpacked from the CHM file.,T1027,Obfuscated Files or Information
SFX archive,T1027,Obfuscated Files or Information
unpacks three files,T1027,Obfuscated Files or Information
contents are unpacked,T1027,Obfuscated Files or Information
SFX archiveWhen unpacked,T1027,Obfuscated Files or Information
use VMProtect or custom packers for its malware,T1027,Obfuscated Files or Information
can send system information,T1041,Exfiltration Over C2 Channel
is the library Funny.dll,T1055,Process Injection
dynamically loads the library,T1055,Process Injection
"that contains the library mapistub.dll,",T1055,Process Injection
dynamically loaded from a Base64 constant defined in the main assembly.,T1027,Obfuscated Files or Information
conditional jumps that never run are included,T1027,Obfuscated Files or Information
obfuscated with junk instructions and inverted conditional jumps (combinations of jle/jg and the like).,T1027,Obfuscated Files or Information
the file is deleted,T1070.004,Indicator Removal: File Deletion
wiping traces of malware from the system,T1070.004,Indicator Removal: File Deletion
saved in the registry,T1112,Modify Registry
passes control to a.bat.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cleanup script,T1059.003,Command and Scripting Interpreter: Windows Command Shell
uses cmd.exe and .bat files to run commands,T1059.003,Command and Scripting Interpreter: Windows Command Shell
sends phishing messages with malicious attachments,T1566.001,Phishing: Spearphishing Attachment
persists on infected machines by creating new services,T1543.003,Create or Modify System Process: Windows Service
uses legitimate utilities to load DLLs,T1574.002,Hijack Execution Flow: DLL Side-Loading
establish C2 connections via a peer-to-peer network of infected hosts,T1090,Proxy
support C2 connections via an external HTTP/SOCKS proxy,T1090,Proxy
"using the API RegisterServiceHandlerA then SetServiceStatus, and finally CreateEventA.",T1106,Native API
abusing API calls in the Operating System.,T1106,Native API
The malware also decrypts,T1140,Deobfuscate/Decode Files or Information
the decryption routine,T1140,Deobfuscate/Decode Files or Information
Decryption routine,T1140,Deobfuscate/Decode Files or Information
the AES 256 decryption key of the payload,T1140,Deobfuscate/Decode Files or Information
strings decoded when running,T1140,Deobfuscate/Decode Files or Information
to decrypt the payload from the .dat file using the AES-256-CTR decryption algorithm and starts to execute.,T1140,Deobfuscate/Decode Files or Information
injects the payload in memory.,T1055,Process Injection
The malware was injected into a SVCHOST process where a driver location pointed to the config file,T1055,Process Injection
injects it into a process.,T1055,Process Injection
a process injection in one of the svchost processes,T1055,Process Injection
injected themselves into Windows Media Player,T1055,Process Injection
injected code in a process,T1055,Process Injection
the adversary had removed the payload file from the system.,T1027,Obfuscated Files or Information
"Where in the beginning of the campaign the adversary was sloppy, during the last months of activity they became more careful and started to remove evidence",T1027,Obfuscated Files or Information
"Besides the use of Mimikatz to dump credentials,",T1003.001,OS Credential Dumping: LSASS Memory
"acquired through the use of Mimikatz, or creating LSASS dumps,",T1003.001,OS Credential Dumping: LSASS Memory
"using Mimikatz and dumping lsass,",T1003.001,OS Credential Dumping: LSASS Memory
"Using Mimikatz and dumping of lsass,",T1003.001,OS Credential Dumping: LSASS Memory
makes use of the technique “DLL Sideloading”,T1574.002,Hijack Execution Flow: DLL Side-Loading
"When the executable is run, the DLL next to it is loaded.",T1574.002,Hijack Execution Flow: DLL Side-Loading
The dll is run using the command “rundll32.exe,T1218.011,System Binary Proxy Execution: Rundll32
The model uses the persistence technique utilizing svchost.exe with service.dll to install a rogue service.,T1569.002,System Services: Service Execution
The DLL embeds several obfuscated strings,T1027,Obfuscated Files or Information
was to start a program as a service,T1543.003,Create or Modify System Process: Windows Service
The DLL is used to create a malicious service,T1543.003,Create or Modify System Process: Windows Service
". The name of the created service, “SysmainUpdate”, is usurping the name of the legitimate service “SysMain” which is related to the legitimate DLL sysmain.dll and also to the Superfetch service.",T1543.003,Create or Modify System Process: Windows Service
Adversary installed custom backdoor as a service,T1543.003,Create or Modify System Process: Windows Service
Adversary launched backdoor and some tools as a Windows Service,T1543.003,Create or Modify System Process: Windows Service
"the command line dump of the memory:
cmd /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"When running the file from the command line,",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"In some cases, batch (.bat) scripts were created",T1059.003,Command and Scripting Interpreter: Windows Command Shell
content in a batch script:,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"the exfiltration of data on the system, such as OS, Processor (architecture),",T1082,System Information Discovery
Username,T1033,System Owner/User Discovery
WMI activity [T1546.003] was also observed to execute commands on the systems.,T1047,Windows Management Instrumentation
WMI was used for running commands on remote systems,T1047,Windows Management Instrumentation
"From a persistence point of view, scheduled tasks",T1053.005,Scheduled Task/Job: Scheduled Task
Adversary ran scheduled tasks for persistence of certain malware samples,T1053.005,Scheduled Task/Job: Scheduled Task
and the use of valid accounts,T1078,Valid Accounts
they were looking to get valid accounts.,T1078,Valid Accounts
the adversary gained credentials in the network,T1078,Valid Accounts
the files were exfiltrated over the backdoor,T1041,Exfiltration Over C2 Channel
the data was stored in a location in the Internet Information Services (IIS) web server and exfiltrated over HTTP using GET requests towards the exact file paths,T1041,Exfiltration Over C2 Channel
malware exfiltrated data towards a C2,T1041,Exfiltration Over C2 Channel
When the data was gathered on a local system using the backdoor,T1005,Data from Local System
and the rar files were deleted,T1070.004,Indicator Removal: File Deletion
exfiltrated over HTTP using GET requests,T1071.001,Application Layer Protocol: Web Protocols
HTTP traffic to C2,T1071.001,Application Layer Protocol: Web Protocols
The packet data was customized and sent through a POST request with several headers towards the C2.,T1071.001,Application Layer Protocol: Web Protocols
The malware started to open up both UDP and TCP ports to connect with a C2 server,T1095,Non-Application Layer Protocol
the customized packet size using a XOR value.,T1573.001,Encrypted Channel: Symmetric Cryptography
Adversary exploited a web-facing server with application,T1190,Exploit Public-Facing Application
the actor established initial access by compromising the victim’s web server,T1190,Exploit Public-Facing Application
Tools were transferred to a compromised web-facing server,T1105,Ingress Tool Transfer
Adversary browsed several locations to search for the data they were after.,T1083,File and Directory Discovery
used Rotten/Bad Potato to elevate user rights by abusing API calls in the Operating System.,T1068,Exploitation for Privilege Escalation
including adding of registry keys,T1112,Modify Registry
and lateral movement/execution of files,T1570,Lateral Tool Transfer
"the attackers would launch a lateral movement phase, using default Windows credentials",T1078,Valid Accounts
run a network recognition process to find the IP address of each of the ATMs,T1016,System Network Configuration Discovery
using a variety of encryption schemes and symmetric keys.,T1573.001,Encrypted Channel: Symmetric Cryptography
to install AnyDesk and provide remote access for the “technician” to install the malware.,T1219,Remote Access Software
All captured information from the transaction is saved to an encrypted file placed in a directory previously set by the malware configuration,T1074.001,Data Staged: Local Data Staging
Those files will later be sent to the malware C2 server,T1041,Exfiltration Over C2 Channel
Captured data stored in the uploader C2,T1041,Exfiltration Over C2 Channel
sending all cab files generated from the stolen transactions to the server,T1041,Exfiltration Over C2 Channel
"StartSendScreen, StopSendScreen",T1113,Screen Capture
"StartSendScreen
Start screen capture
StopSendScreen
Stop screen capture",T1113,Screen Capture
Download a file from the remote server,T1105,Ingress Tool Transfer
"StartDownload, StopDownload.",T1105,Ingress Tool Transfer
"Shell
Execute a specified command via CMD",T1059.003,Command and Scripting Interpreter: Windows Command Shell
the files are sent through an HTTP POST request.,T1071.001,Application Layer Protocol: Web Protocols
Add the process to a startup registry key,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
malicious OneNote documents to entice users to click on an embedded file to download and execute,T1204.002,User Execution: Malicious File
a fake message to lure users to execute the HTA  file ,T1204.002,User Execution: Malicious File
"Upon clicking the Open button, it drops the HTA file",T1204.002,User Execution: Malicious File
it prompts the user with a fake message to double-click on open to view the attachment.,T1204.002,User Execution: Malicious File
The message above the ‘Open’ button instructs the user to “double click” in order to receive the attachment.,T1204.002,User Execution: Malicious File
The malicious document is delivered in either zip files or ISO images to the target through phishing emails.,T1566.001,Phishing: Spearphishing Attachment
the malware author used phishing emails to deliver malicious OneNote document either as attachment,T1566.001,Phishing: Spearphishing Attachment
Windows batch script,T1059.003,Command and Scripting Interpreter: Windows Command Shell
executes a batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the malicious batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Upon execution of the batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
launched by cmd.exe,T1059.003,Command and Scripting Interpreter: Windows Command Shell
batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Embedded Executable Objects In OneNote  ,T1027,Obfuscated Files or Information
an embedded file gets executed by the user,T1027,Obfuscated Files or Information
The FileData member of the FileDataStoreObject is the key member that holds the embedded data in the OneNote document.,T1027,Obfuscated Files or Information
Embedded data in Data object,T1027,Obfuscated Files or Information
OneNote file contains an embedded HTA  attachment,T1027,Obfuscated Files or Information
The OneNote file with the embedded HTA file,T1027,Obfuscated Files or Information
contains the “whoami” command,T1033,System Owner/User Discovery
make use of  the curl utility to download Qakbot and then execute it.,T1105,Ingress Tool Transfer
The HTA file uses curl utility to download,T1105,Ingress Tool Transfer
Curl is used to download the malicious DLL file,T1105,Ingress Tool Transfer
The script will then execute the downloaded file,T1105,Ingress Tool Transfer
downloads the payload from the Internet and executes on the target system.,T1105,Ingress Tool Transfer
Powershell will be invoked and it fetch the Qakbot payload from Internet,T1105,Ingress Tool Transfer
use powershell to download the payload,T1105,Ingress Tool Transfer
executed by rundll32.exe.,T1218.011,System Binary Proxy Execution: Rundll32
The script will then execute the downloaded file with Rundll32.exe,T1218.011,System Binary Proxy Execution: Rundll32
execute it with rundll32.exe,T1218.011,System Binary Proxy Execution: Rundll32
Obfuscated HTA script,T1027,Obfuscated Files or Information
The HTA file contains obfuscated script,T1027,Obfuscated Files or Information
The obfuscated registry is then read by MSHTA and the obfuscated code is,T1027,Obfuscated Files or Information
with obfuscated content,T1027,Obfuscated Files or Information
Deobfuscated HTA content,T1140,Deobfuscate/Decode Files or Information
code is de-obfuscated,T1140,Deobfuscate/Decode Files or Information
Base64 Decoded instructions in dropper,T1140,Deobfuscate/Decode Files or Information
The base64 decoded batch file,T1140,Deobfuscate/Decode Files or Information
then deletes the registry key,T1112,Modify Registry
creates a registry key in HKEY_CURRENT_USER\SOFTWARE\,T1112,Modify Registry
A closer look at the document reveals the graphical elements are all images placed in a layered style by the malicious actor.,T1027,Obfuscated Files or Information
enumerate files and folders,T1083,File and Directory Discovery
"It then performs SQL queries to retrieve files, file size, folders",T1083,File and Directory Discovery
Many of the hosts used to support these second-stage operations hosted RDP services,T1021.001,Remote Services: Remote Desktop Protocol
can run commands that will download files,T1105,Ingress Tool Transfer
"web shell with filenames that masquerade as human.aspx, which is a legitimate component of the MOVEit Transfer software.",T1036.005,Masquerading: Match Legitimate Name or Location
several POST requests,T1071.001,Application Layer Protocol: Web Protocols
large volumes of files have been stolen from victims' MOVEit transfer systems.,T1005,Data from Local System
"The threat actors also moved laterally to the domain controller, compromised credentials",T1078,Valid Accounts
implanted Ngrok reverse proxies,T1090,Proxy
The actors used Ngrok to proxy RDP connections and to perform command and control.,T1090,Proxy
the threat actors exploited Log4Shell [T1190] for initial access [TA0001] to the organization’s unpatched VMware Horizon server,T1190,Exploit Public-Facing Application
The actors exploited Log4Shell for initial access to the organization’s VMware Horizon server.,T1190,Exploit Public-Facing Application
added an exclusion rule to Windows Defender,T1562.001,Impair Defenses: Disable or Modify Tools
added an exclusion rule to Windows Defender.,T1562.001,Impair Defenses: Disable or Modify Tools
The actors added an exclusion rule to Windows Defender.,T1562.001,Impair Defenses: Disable or Modify Tools
"The tool allowlisted the entire c:\drive, enabling the actors to bypass virus scans for tools",T1562.001,Impair Defenses: Disable or Modify Tools
The actors manually disabled Windows Defender via the GUI.,T1562.001,Impair Defenses: Disable or Modify Tools
"The exclusion rule allowlisted the entire c:\drive, enabling threat actors to download tools to the c:\drive without virus scans.",T1562.001,Impair Defenses: Disable or Modify Tools
manually disabled Windows Defender via the Graphical User Interface (GUI),T1562.001,Impair Defenses: Disable or Modify Tools
The Scheduled Task was named RuntimeBrokerService.exe,T1053.005,Scheduled Task/Job: Scheduled Task
created a Scheduled Task,T1053.005,Scheduled Task/Job: Scheduled Task
The actors’ exploit payload created Scheduled Task,T1053.005,Scheduled Task/Job: Scheduled Task
the actors used RDP,T1021.001,Remote Services: Remote Desktop Protocol
RDP sessions,T1021.001,Remote Services: Remote Desktop Protocol
the actors leveraged RDP to propagate to several hosts within the network.,T1021.001,Remote Services: Remote Desktop Protocol
The actors used RDP to move laterally to multiple hosts on the network.,T1021.001,Remote Services: Remote Desktop Protocol
RDP connections,T1021.001,Remote Services: Remote Desktop Protocol
and the built-in Windows user account DefaultAccount [T1078.001] to move laterally,T1078,Valid Accounts
The actors used built-in Windows user account DefaultAccount.,T1078,Valid Accounts
Mimikatz – a credential theft tool.,T1003.001,OS Credential Dumping: LSASS Memory
The threat actors then executed Mimikatz on VDI-KMS to harvest credentials,T1003.001,OS Credential Dumping: LSASS Memory
the threat actor was observed attempting to dump the Local Security Authority Subsystem Service (LSASS) process,T1003.001,OS Credential Dumping: LSASS Memory
trying to dump LSASS process.,T1003.001,OS Credential Dumping: LSASS Memory
The actors used Mimikatz to harvest credentials.,T1003.001,OS Credential Dumping: LSASS Memory
Ngrok – a reverse proxy tool for proxying an internal service out onto an Ngrok domain,T1090,Proxy
"The actors were able to proxy [T1090] RDP sessions, which were only observable on the local network",T1090,Proxy
The actors downloaded the following tools,T1105,Ingress Tool Transfer
to download next stage and execute it,T1105,Ingress Tool Transfer
The exploit payload then downloaded mdeploy.text,T1105,Ingress Tool Transfer
The actors downloaded malware and multiple tools to the network,T1105,Ingress Tool Transfer
as outgoing HTTPS port 443 connections,T1071.001,Application Layer Protocol: Web Protocols
The actors removed malicious file mde.ps1 from the dis.,T1070.004,Indicator Removal: File Deletion
removed mde.ps1 from the disk,T1070.004,Indicator Removal: File Deletion
$BASE64 encoded payload,T1027,Obfuscated Files or Information
recording files to be uploaded when their download is requested by the C2 server.,T1041,Exfiltration Over C2 Channel
and uploads it back to the server.,T1041,Exfiltration Over C2 Channel
uploads it to the C2 server.,T1041,Exfiltration Over C2 Channel
sends it to the C2 server.,T1041,Exfiltration Over C2 Channel
sends it to the C2 server.,T1041,Exfiltration Over C2 Channel
Upload a recording file with a specified name to the C2 server.,T1041,Exfiltration Over C2 Channel
data to be exfiltrated to the C2 server,T1041,Exfiltration Over C2 Channel
sends data to the C2 server,T1041,Exfiltration Over C2 Channel
Sends the shellcode execution results to the C2 server,T1041,Exfiltration Over C2 Channel
decrypts the next loader stage,T1140,Deobfuscate/Decode Files or Information
decrypts it,T1140,Deobfuscate/Decode Files or Information
Decrypts,T1140,Deobfuscate/Decode Files or Information
decryption procedure,T1140,Deobfuscate/Decode Files or Information
Decrypts,T1140,Deobfuscate/Decode Files or Information
shellcode decrypts,T1140,Deobfuscate/Decode Files or Information
After decrypting,T1140,Deobfuscate/Decode Files or Information
decrypts the Orchestrator,T1140,Deobfuscate/Decode Files or Information
decodes the directory path,T1140,Deobfuscate/Decode Files or Information
decrypts the hidden page,T1140,Deobfuscate/Decode Files or Information
decrypting them on the fly.,T1140,Deobfuscate/Decode Files or Information
decrypts it with XOR,T1140,Deobfuscate/Decode Files or Information
Decrypts the Trojan with a XOR-based cipher,T1140,Deobfuscate/Decode Files or Information
The decryption key,T1140,Deobfuscate/Decode Files or Information
injects the Trojan loader into exe.,T1055,Process Injection
can be injected to processes,T1055,Process Injection
The malware injects the ProcessWorm into all processes running on the system,T1055,Process Injection
injects itself into processes,T1055,Process Injection
injects the ProcessWorm if needed.,T1055,Process Injection
injects the ProcessWorm into processes,T1055,Process Injection
is injected into all running processes.,T1055,Process Injection
injecting code,T1055,Process Injection
The injected Trojan loader,T1055,Process Injection
collects specific system information,T1082,System Information Discovery
Returns information about the machine’s BIOS.,T1082,System Information Discovery
Returns information about the operating system,T1082,System Information Discovery
computer name,T1082,System Information Discovery
"Overall available space
Space available to current user (may be less than overall available space due to quotas)
Disk capacity",T1082,System Information Discovery
Returns information about the computer system,T1082,System Information Discovery
checks if it is running on a 64-bit system,T1082,System Information Discovery
Returns OSVERSIONINFOEXW and SYSTEM_INFO structures,T1082,System Information Discovery
the current process name,T1057,Process Discovery
Returns the list of running processes,T1057,Process Discovery
Returns ProcessDebugPort value returned by NtQueryInformationProcess for current process.,T1057,Process Discovery
Returns ProcessDebugObjectHandle value returned by NtQueryInformationProcess for current process,T1057,Process Discovery
"Returns process names of the current process tree (i.e. the current process, the parent process, the grandparent process, etc.)",T1057,Process Discovery
obtains the list of processes,T1057,Process Discovery
extract specific information about running processes,T1057,Process Discovery
regularly obtains the list of running processes.,T1057,Process Discovery
examines all the processes on the system,T1057,Process Discovery
looks for specific processes,T1057,Process Discovery
"acquires handles for all running processes on the system, which results in either winlogon.exe or explorer.exe obtaining numerous process handles.",T1057,Process Discovery
When it detects a starting first (or a stopping last) instance of a process from the list,T1057,Process Discovery
running processes,T1057,Process Discovery
a part of code from the .text section (roughly 8 KB) is overwritten with heavily obfuscated code,T1027,Obfuscated Files or Information
obfuscated code,T1027,Obfuscated Files or Information
obfuscated trampoline in the .text section.,T1027,Obfuscated Files or Information
This trampoline is protected with an obfuscator,T1027,Obfuscated Files or Information
obfuscated with FinSpy Mutator,T1027,Obfuscated Files or Information
This module is an obfuscated shellcode.,T1027,Obfuscated Files or Information
obfuscated DLL,T1027,Obfuscated Files or Information
obfuscated with FinSpy VM.,T1027,Obfuscated Files or Information
It is encrypted with a 256-byte RC4 key.,T1027,Obfuscated Files or Information
conceals memory areas that contain the Trojan components’ code and data.,T1027,Obfuscated Files or Information
encrypts the Orchestrator’s pages with a cipher based on XOR and ROL operations and assigns the PAGE_NOACCESS attribute to them,T1027,Obfuscated Files or Information
protected with an obfuscator,T1027,Obfuscated Files or Information
An obfuscator similar to OLLVM is used to protect FinSpy,T1027,Obfuscated Files or Information
It is obfuscated with a protector resembling the open source OLLVM obfuscator.,T1027,Obfuscated Files or Information
The encrypted VFS file.,T1027,Obfuscated Files or Information
"The setup configuration file, which is encrypted with RC4",T1027,Obfuscated Files or Information
an obfuscator resembling OLLVM or both these protectors,T1027,Obfuscated Files or Information
a call to the CreateWindowExW,T1106,Native API
the NtTerminateProcess and ExitProcess functions,T1106,Native API
CreateFileW API.,T1106,Native API
API function,T1106,Native API
various WinAPI functions.,T1106,Native API
low-level API functions (such as NtEnumerateValueKey or NtQuerySystemInformation),T1106,Native API
NtTestAlert function,T1106,Native API
call the NtTestAlert function,T1106,Native API
NtTestAlert function,T1106,Native API
CreateProcessInternalW API function,T1106,Native API
 NtQueueAPCThread function,T1106,Native API
KiUserExceptionDispatcher function,T1106,Native API
WinAPI file manipulation functions.,T1106,Native API
calling API functions from this library,T1106,Native API
hooks the kernel’s PsCreateSystemThread function,T1106,Native API
launches a slightly modified Metasploit Reverse HTTPS stager,T1071.001,Application Layer Protocol: Web Protocols
connects to a configured C2 server using HTTPS for communication.,T1071.001,Application Layer Protocol: Web Protocols
Makes an initial POST request to the C2 server,T1071.001,Application Layer Protocol: Web Protocols
to the C2 server via a POST request.,T1071.001,Application Layer Protocol: Web Protocols
All communications between the server are encrypted with RC4,T1573.001,Encrypted Channel: Symmetric Cryptography
encrypted with RC4,T1573.001,Encrypted Channel: Symmetric Cryptography
A snippet of the RC4 key generation function,T1573.001,Encrypted Channel: Symmetric Cryptography
"Returns the list of network adapter types, IP and MAC addresses assigned to them.",T1016,System Network Configuration Discovery
Returns names of shortcuts in the Desktop directory.,T1083,File and Directory Discovery
Returns the path to the ‘Program Files’ folder.,T1083,File and Directory Discovery
Returns the short form of the user’s profile folder,T1083,File and Directory Discovery
Returns the user’s profile folder,T1083,File and Directory Discovery
Returns the list of object names in the \GLOBAL?? directory.,T1083,File and Directory Discovery
Retrieve the list of files,T1083,File and Directory Discovery
gets the list of recent files,T1083,File and Directory Discovery
"search, delete files.",T1083,File and Directory Discovery
file listings,T1083,File and Directory Discovery
Create file listing recordings,T1083,File and Directory Discovery
Returns the path to the user’s temporary folder.,T1083,File and Directory Discovery
Returns the current domain SID,T1033,System Owner/User Discovery
Returns the current user’s name,T1033,System Owner/User Discovery
Returns the current user’s SID.,T1033,System Owner/User Discovery
WMI query,T1047,Windows Management Instrumentation
Creates a scheduled task that runs at system startup,T1053.005,Scheduled Task/Job: Scheduled Task
The Task Scheduler launches it at system startup,T1053.005,Scheduled Task/Job: Scheduled Task
scheduled task properties,T1053.005,Scheduled Task/Job: Scheduled Task
a DLL obfuscated with VMProtect.,T1027,Obfuscated Files or Information
unpacking the Orchestrator,T1027,Obfuscated Files or Information
unpacks it with aPLib.,T1027,Obfuscated Files or Information
Orchestrator is unpacked,T1027,Obfuscated Files or Information
The Orchestrator (as well as plugins) are packed with aPLib and encrypted with AES.,T1027,Obfuscated Files or Information
unpacks with aPLib,T1027,Obfuscated Files or Information
encrypted with XOR and compressed with aPLib.,T1027,Obfuscated Files or Information
unpacks it with aPLib,T1027,Obfuscated Files or Information
takes a screenshot,T1113,Screen Capture
screenshots,T1113,Screen Capture
screen,T1113,Screen Capture
"take screenshots during, online conversations.",T1113,Screen Capture
Capture the screen area around mouse click locations,T1113,Screen Capture
"Take screenshots with a specified frame rate, and livestream or record them.",T1113,Screen Capture
screenshots,T1113,Screen Capture
Commands are used to download and install plugins,T1105,Ingress Tool Transfer
Commands are used to download and run the Trojan Installer.,T1105,Ingress Tool Transfer
"Upload, download",T1105,Ingress Tool Transfer
downloading and executing specific utilities,T1105,Ingress Tool Transfer
downloads Security Shellcodes from the C2 server,T1105,Ingress Tool Transfer
may save recording files in the working directory,T1074.001,Data Staged: Local Data Staging
stored in the working directory,T1074.001,Data Staged: Local Data Staging
the malware’s working directory,T1074.001,Data Staged: Local Data Staging
"Once the working directory is prepared,",T1074.001,Data Staged: Local Data Staging
keylogs,T1056.001,Input Capture: Keylogging
keystrokes,T1056.001,Input Capture: Keylogging
record keystrokes,T1056.001,Input Capture: Keylogging
Delete a recording with a given filename from the system.,T1070.004,Indicator Removal: File Deletion
Uninstall the backdoor.,T1070.004,Indicator Removal: File Deletion
wipes all the files and registry keys created by the backdoor,T1070.004,Indicator Removal: File Deletion
delete files.,T1070.004,Indicator Removal: File Deletion
creating an APC (Asynchronous Procedure Call) with the procedure address pointing to the start of the shellcode.,T1055,Process Injection
APC injections,T1055,Process Injection
The asynchronous procedure places a hook on the NtTestAlert function and then exits,T1055,Process Injection
will be loaded with the help of the APC injection loader.,T1055,Process Injection
the hooked process creation function clears a possible hook of the  NtQueueAPCThread function and then uses it to create an APC procedure in the new process.,T1055,Process Injection
junk code created by the ProcessWorm loader,T1027,Obfuscated Files or Information
entries point to buffers of randomly generated junk code,T1027,Obfuscated Files or Information
method names contain junk.,T1027,Obfuscated Files or Information
The executable is prepended with 0x4000 random bytes and encrypted with RC4,T1027,Obfuscated Files or Information
documents sent to the printer.,T1005,Data from Local System
Steal files which are printed by the victim,T1005,Data from Local System
recently opened documents,T1005,Data from Local System
Uninstall a plugin from the machine,T1027,Obfuscated Files or Information
Sets up persistence by creating an entry in the HKCU\Software\Microsoft\Windows\CurrentVersion\Run registry key.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
adds it to the HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run key,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
Bash script,T1059.003,Command and Scripting Interpreter: Windows Command Shell
launched on every startup by rundll32.exe,T1218.011,System Binary Proxy Execution: Rundll32
creates a thread in the kernel that injects the next stage into winlogon.exe.,T1055,Process Injection
A thread with trampoline shellcode is created inside exe.,T1055,Process Injection
The victim downloads a Trojanized application and executes it.,T1204.002,User Execution: Malicious File
we identified numerous legitimate applications backdoored,T1072,Software Deployment Tools
TeamViewer,T1219,Remote Access Software
Cleans  API functions potentially hooked by security solutions,T1562.001,Impair Defenses: Disable or Modify Tools
attackers also exploited vulnerabilities such as PrintNightmare to escalate privileges,T1068,Exploitation for Privilege Escalation
"Software vulnerabilities, such as PrintNightmare (CVE-2021-1675) and (CVE-2021-34527), may be exploited in an attempt to elevate privileges.",T1068,Exploitation for Privilege Escalation
has operated sites on the Tor network using the following .onion,T1090,Proxy
this key is typically obfuscated with AES 256 encryption.,T1027,Obfuscated Files or Information
encrypted PowerShell.,T1027,Obfuscated Files or Information
"Upon execution, the ransomware binary deletes itself",T1070.004,Indicator Removal: File Deletion
Creating the HKCU\Software\Zeppelin registry key,T1112,Modify Registry
by modifying the Registry.,T1112,Modify Registry
valid credentials have been used by Vice Society to gain initial access.,T1078,Valid Accounts
"Internet-facing applications and systems vulnerabilities can be exploited, such as PrintNightmare (CVE-2021-1675) and (CVE-2021-34527), to gain initial access.",T1190,Exploit Public-Facing Application
Batch files are used,T1059.003,Command and Scripting Interpreter: Windows Command Shell
features multiple flags that could be set as command line arguments,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Persistence is maintained after boot/reboot via malicious autostart registry keys.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
utilizes legitimate programs to side-load the group’s own DLL to execute their payload.,T1574.002,Hijack Execution Flow: DLL Side-Loading
Malicious commands are executed via WMI as a means of “living off the land” and avoiding detection.,T1047,Windows Management Instrumentation
execute commands via scheduled tasks/jobs.,T1053.005,Scheduled Task/Job: Scheduled Task
Files dropped in the victim’s environment by Vice Society may have been altered to appear legitimate.,T1036.005,Masquerading: Match Legitimate Name or Location
attempts to disable Windows Defender,T1562.001,Impair Defenses: Disable or Modify Tools
"Attempts to disable or modify endpoint security, such as Microsoft Defender, on compromised devices.",T1562.001,Impair Defenses: Disable or Modify Tools
utilizes comsvcs.dll to dump credentials from Local Security Authority Subsystem Service.,T1003.001,OS Credential Dumping: LSASS Memory
RDP is used by the group for lateral movement.,T1021.001,Remote Services: Remote Desktop Protocol
"Lateral tool transfers have been used to move tools and files from one compromised system to another, including SMB and RDP.",T1570,Lateral Tool Transfer
to exfiltrate data to external C2 servers.,T1041,Exfiltration Over C2 Channel
to exfiltrate data directly to C2 servers.,T1041,Exfiltration Over C2 Channel
Tools such as SystemBC and proprietary backdoors are known to be used,T1219,Remote Access Software
"Legitimate processes have been corrupted by Vice Society via code injection, as a means to evade defenses.",T1055,Process Injection
"malware is designed to steal sensitive information from victims' systems,",T1005,Data from Local System
attackers used an innocent-looking email to lure victims into opening an attachment.,T1566.001,Phishing: Spearphishing Attachment
"we found the original email that included a ZIP file attached, which contained an ISO file.",T1566.001,Phishing: Spearphishing Attachment
sample uses obfuscation,T1027,Obfuscated Files or Information
This file is an obfuscated .NET file,T1027,Obfuscated Files or Information
only uses one code obfuscation technique: API hashing.,T1027,Obfuscated Files or Information
"Payload
Obfuscation",T1027,Obfuscated Files or Information
"each data byte in the HTTP based C2 communication,",T1071.001,Application Layer Protocol: Web Protocols
submitted to the C2 server through HTTP protocol using the POST method.,T1071.001,Application Layer Protocol: Web Protocols
the HTTP C2 Communication section.,T1071.001,Application Layer Protocol: Web Protocols
HTTP C2 Communication,T1071.001,Application Layer Protocol: Web Protocols
to the C2 through the HTTP protocol.,T1071.001,Application Layer Protocol: Web Protocols
can be found in the two bytes of the HTTP payload,T1071.001,Application Layer Protocol: Web Protocols
shows a HTTP POST request and its corresponding message body.,T1071.001,Application Layer Protocol: Web Protocols
"the Content-Key, which is a custom HTTP header whose value corresponds to a hash generated out of the HTTP header.",T1071.001,Application Layer Protocol: Web Protocols
HTTP POST request (type 27 / data exfiltration).,T1071.001,Application Layer Protocol: Web Protocols
then uploads this information to an attacker-controlled machine via HTTP POST.,T1041,Exfiltration Over C2 Channel
exfiltrates information to the C2 through the HTTP protocol.,T1041,Exfiltration Over C2 Channel
HTTP POST request (type 27 / data exfiltration).,T1041,Exfiltration Over C2 Channel
an ISO file opener that mounts and opens the file with a simple double-click.,T1204.002,User Execution: Malicious File
"To the victim, the opening process simply looks like a regular directory.",T1204.002,User Execution: Malicious File
"obfuscated .NET file using process hollowing, which is a code injection technique in which an attacker removes legitimate code from an executable and replaces it with malicious code.",T1055,Process Injection
process hollowing was used to inject a malicious PE file into the legitimate process called aspnet_compiler.exe.,T1055,Process Injection
use this technique to retrieve export functions from loaded libraries,T1106,Native API
the corresponding APIs in the appropriate library.,T1106,Native API
via the MoveFileExW or CopyFileW Windows API.,T1106,Native API
"Then, it creates and sets a new value for the registry key HKCU\Software\Microsoft\Windows\CurrentVersion\Run.",T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
"In order to establish persistence on the targeted host, the malware starts by saving a copy of itself in a new folder in the %APPDATA% directory",T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
"searches for and exfiltrates the following information:
OS architecture
Built-in admin
Domain host name
Hostname
Local admin
Operating system
Screen resolution",T1082,System Information Discovery
Username information,T1033,System Owner/User Discovery
Exfiltrate keylogger data,T1056.001,Input Capture: Keylogging
Keylogger database,T1056.001,Input Capture: Keylogging
can use additional payload types,T1105,Ingress Tool Transfer
Exfiltrate screenshots,T1113,Screen Capture
Potential hidden files,T1564.001,Hide Artifacts: Hidden Files and Directories
"It collects sensitive data from web browsers,",T1552.001,Unsecured Credentials: Credentials In Files
"These functions are made to steal credentials from different types of applications and services on the Windows operating system:
Browsers: Safari, Internet Explorer, Firefox and Chromium-based browsers",T1552.001,Unsecured Credentials: Credentials In Files
adopting publicly disclosed proof-of-concept (POC) code shortly after it is released to exploit vulnerabilities in internet-facing applications.,T1190,Exploit Public-Facing Application
"their initial exploitation of vulnerable internet-facing applications,",T1190,Exploit Public-Facing Application
"continues to use older vulnerabilities, especially Log4Shell, to compromise unpatched devices",T1190,Exploit Public-Facing Application
"After gaining initial access to an organization by exploiting a vulnerability with a public POC,",T1190,Exploit Public-Facing Application
"as several adversaries are exploiting CVE-2022-47966 for initial access.
Apache Log4j2 (aka Log4Shell)",T1190,Exploit Public-Facing Application
enable RDP connections.,T1021.001,Remote Services: Remote Desktop Protocol
can use the Active Directory database to access credentials for users’ accounts.,T1078,Valid Accounts
"credentials are accessed and the target organization has not reset corresponding passwords, the actors can log in with stolen credentials and masquerade as legitimate users,",T1078,Valid Accounts
The actors could also gain access to other systems where individuals may have reused their passwords.,T1078,Valid Accounts
to persist in target environments and deploy additional tools.,T1105,Ingress Tool Transfer
backdoor with the ability to download and run additional tools,T1105,Ingress Tool Transfer
create scheduled tasks for persistence.,T1053.005,Scheduled Task/Job: Scheduled Task
Scheduled Task Creation or,T1053.005,Scheduled Task/Job: Scheduled Task
Remote Task Creation/Update using Schtasks Process,T1053.005,Scheduled Task/Job: Scheduled Task
"the group crafts bespoke phishing emails, often purporting to contain information on security policies that affect countries in the Middle East, to deliver weaponized documents to individuals of interest.",T1566.001,Phishing: Spearphishing Attachment
"can read files,",T1083,File and Directory Discovery
"gather information on an infected host, and send details back to the attackers.",T1005,Data from Local System
Commands executed by WMI on new hosts,T1047,Windows Management Instrumentation
script to deobfuscate the control flow of shellcode,T1140,Deobfuscate/Decode Files or Information
Malware immediately decrypts the third layer,T1140,Deobfuscate/Decode Files or Information
it decrypts the c2 URL,T1140,Deobfuscate/Decode Files or Information
Use NtQueryInformationProcess API,T1140,Deobfuscate/Decode Files or Information
"It decrypts an encrypted payload,",T1140,Deobfuscate/Decode Files or Information
Payload decryption function.,T1140,Deobfuscate/Decode Files or Information
the payload decryption key,T1140,Deobfuscate/Decode Files or Information
deobfuscated code of GuLoader’s shellcode.,T1140,Deobfuscate/Decode Files or Information
using stack to decrypt strings,T1140,Deobfuscate/Decode Files or Information
script to restore deobfuscate control flow.,T1140,Deobfuscate/Decode Files or Information
control flow obfuscation,T1027,Obfuscated Files or Information
encrypted shellcode’s file,T1027,Obfuscated Files or Information
encrypted payload from c2.,T1027,Obfuscated Files or Information
obfuscated arithmetic value calculations,T1027,Obfuscated Files or Information
an encrypted payload,T1027,Obfuscated Files or Information
shellcode control flow obfuscation,T1027,Obfuscated Files or Information
control flow obfuscation.,T1027,Obfuscated Files or Information
Unpacking of GuLoader’s shellcodes.,T1027,Obfuscated Files or Information
packed using NSIS installer.,T1027,Obfuscated Files or Information
UNPACKING GULOADER’S SHELLCODE,T1027,Obfuscated Files or Information
It then calls CallWindowProcW API.,T1106,Native API
Uses EnumWindows API,T1106,Native API
Uses EnumDeviceDrivers and GetDeviceDriverBaseNameA APIs.,T1106,Native API
Uses MsiEnumProductsA and MsiGetProductInfoA APIs.,T1106,Native API
Uses OpenSCManagerA and EnumServicesStatusA APIs.,T1106,Native API
Uses NtSetInformationThread API,T1106,Native API
DbgBreakPoint and DbgUiRemoteBreakin API,T1106,Native API
it starts payload execution using the ZwCreateThreadEx API.,T1106,Native API
call RtlAddVectoredExceptionHandler API,T1106,Native API
"This shellcode has complex obfuscation, consisting of junk code",T1027,Obfuscated Files or Information
dynamic API resolution,T1027,Obfuscated Files or Information
use process hollowing to inject decrypted payload into child process and resolves its Import Address Table.,T1055,Process Injection
"DLL sideloading,",T1574.002,Hijack Execution Flow: DLL Side-Loading
"program first sideloads u2ec.dll, which then loads the payload file usb.ini",T1574.002,Hijack Execution Flow: DLL Side-Loading
malware rzlog4cpp.dll is sideloaded,T1574.002,Hijack Execution Flow: DLL Side-Loading
which is used for the first sideloading.,T1574.002,Hijack Execution Flow: DLL Side-Loading
including the use of DLL sideloading,T1574.002,Hijack Execution Flow: DLL Side-Loading
"Once the malicious DLL is sideloaded, it will drop the legitimate EXE file and the malicious DLL file, which are embedded in the resource section of the DLL file.",T1574.002,Hijack Execution Flow: DLL Side-Loading
First-stage legitimate executable for DLL sideloading,T1574.002,Hijack Execution Flow: DLL Side-Loading
Second-stage legitimate executable for DLL sideloading,T1574.002,Hijack Execution Flow: DLL Side-Loading
files have XOR-encrypted content to prevent detection,T1027,Obfuscated Files or Information
contains another payload that is XOR-encrypted,T1027,Obfuscated Files or Information
applies obfuscation techniques,T1027,Obfuscated Files or Information
 reads the encrypted configuration filecan,T1027,Obfuscated Files or Information
an encrypted configuration.,T1027,Obfuscated Files or Information
the logging strings are encrypted with a single byte in XOR operations as,T1027,Obfuscated Files or Information
and obfuscation mechanisms.,T1027,Obfuscated Files or Information
an increasing number of obfuscations are being adopted to thwart static analysis.,T1027,Obfuscated Files or Information
containing one-byte XOR encrypted sections,T1027,Obfuscated Files or Information
"will decrypt this file with a single byte in XOR operations, find the PE header, and drop the payload to the specified path.",T1140,Deobfuscate/Decode Files or Information
after decrypting the frData member in,T1140,Deobfuscate/Decode Files or Information
The decryption function,T1140,Deobfuscate/Decode Files or Information
It will then decrypt the encrypted payload with the predefined RC4 key,T1140,Deobfuscate/Decode Files or Information
"After decryption, it then checks if the first byte of the decrypted payload",T1140,Deobfuscate/Decode Files or Information
The decrypted payload,T1140,Deobfuscate/Decode Files or Information
"After this is decrypted,",T1140,Deobfuscate/Decode Files or Information
The malware will continue to read and decrypt goopdate,T1140,Deobfuscate/Decode Files or Information
C&C traffic of the PUBLOAD HTTP variant,T1071.001,Application Layer Protocol: Web Protocols
"it communicates to its C&C servers over the MQTT protocol, which is commonly used in internet-of-things (IoT) devices",T1071.001,Application Layer Protocol: Web Protocols
malware that communicates over the MQTT protocol.,T1071.001,Application Layer Protocol: Web Protocols
Command codes in the PUBLOAD HTTP variant,T1071.001,Application Layer Protocol: Web Protocols
HTTP variant,T1071.001,Application Layer Protocol: Web Protocols
HTTP variant,T1071.001,Application Layer Protocol: Web Protocols
"The data in the HTTP body is the same as the past variant,",T1071.001,Application Layer Protocol: Web Protocols
HTTP variant,T1071.001,Application Layer Protocol: Web Protocols
supports data upload,T1105,Ingress Tool Transfer
the group used certutil.exe to download the legitimate WinRAR binary as rar1.exe from the server,T1105,Ingress Tool Transfer
PowerShell downloading malware,T1105,Ingress Tool Transfer
The certutil.exe program downloads the WinRAR binary,T1105,Ingress Tool Transfer
the threat actors used PowerShell to download multiple malware and archives from the server,T1105,Ingress Tool Transfer
command execution.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
its shell open command.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
create a reverse shell.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
It will then create a reverse shell via ncat.exe to the server,T1059.003,Command and Scripting Interpreter: Windows Command Shell
backdoor that is capable of executing commands,T1059.003,Command and Scripting Interpreter: Windows Command Shell
including adding more command-line arguments,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"also supports command-line arguments,",T1059.003,Command and Scripting Interpreter: Windows Command Shell
we discovered several tools used for UAC bypass in Windows 10.,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
HackTool.Win32.ABPASS is a tool used to bypass UAC in Windows 10.,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
HackTool.Win32.CCPASS is another tool that is also used for Windows 10 UAC bypass,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
This service has the highest privileges that can be abused for Windows 10 UAC bypass.,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
UAC bypass will be executed via the AppInfo RPC service.,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
UAC Bypass via the CMSTPLUA COM interface,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
UAC Bypass via the AppInfo RPC service,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
UAC bypass will be executed,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
UAC bypass is executed via token manipulation.,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
UAC bypass is executed,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
net user <username>,T1033,System Owner/User Discovery
and the following data is written into registry:,T1112,Modify Registry
Registry keys changed,T1112,Modify Registry
It creates a new Shell in the registry.,T1112,Modify Registry
it installs itself to %programdata% and then sets the registry run key for persistence.,T1112,Modify Registry
It invokes the undocumented API UserAssocSet to update the file association.,T1106,Native API
strings and the APIs used by,T1106,Native API
It installs itself by creating an InstallSvc service,T1543.003,Create or Modify System Process: Windows Service
creating aservice called InstallSvc,T1543.003,Create or Modify System Process: Windows Service
Creates a service,T1543.003,Create or Modify System Process: Windows Service
which is injected to conduct backdoor behaviors.,T1055,Process Injection
and inject it into winver.exe for the next-stage payload,T1055,Process Injection
"It will read the next stage payloads, free.plg and main.plg, and inject them into dllhost.exe.",T1055,Process Injection
It is also able to communicate through different network protocols such as UDP (User Datagram Protocol) and TCP (Transmission Control Protocol).,T1095,Non-Application Layer Protocol
Delete file,T1070.004,Indicator Removal: File Deletion
Delete file,T1070.004,Indicator Removal: File Deletion
Keystrokes and windows monitoring,T1056.001,Input Capture: Keylogging
Monitor keystrokes and windows,T1056.001,Input Capture: Keylogging
Keylogging,T1056.001,Input Capture: Keylogging
will check if the running processes,T1057,Process Discovery
will check if the process avp.exe exists.,T1057,Process Discovery
It sets up a run key for via the command C:\ProgramData\GoogleUpdate\googleupdate.exe work for persistence.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
It sets up a run key for the command C:\programdata\netsky\netsky.exe online for persistence.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
Sets Run Key with “work/online”,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
It installs itself by creating aservice called InstallSvc which will trigger “C:\programdata\netsky\netsky.exe online”.,T1569.002,System Services: Service Execution
"malware first generates a key blob randomly, with the key being encrypted in a custom algorithm.",T1573.001,Encrypted Channel: Symmetric Cryptography
"Regardless of whether the file content is compressed or not, it will be encrypted in XOR operations with a specific string",T1573.001,Encrypted Channel: Symmetric Cryptography
is another example of custom malware used for packing files;,T1027,Obfuscated Files or Information
Victims will receive and interact with a decoy document containing a Google Drive link and a corresponding password instead of an archive download link embedded in the email.,T1204.002,User Execution: Malicious File
Victims will receive and interact with a decoy document containing a Google Drive link and a corresponding password instead of an archive download link embedded in the email.,T1566.001,Phishing: Spearphishing Attachment
that had the remote desktop service enabled.,T1021.001,Remote Services: Remote Desktop Protocol
and the creation of a schedule task.,T1053.005,Scheduled Task/Job: Scheduled Task
conceal its true code through either encryption or compression,T1027,Obfuscated Files or Information
make the malicious payload smaller and avoid detection based on static malware analysis techniques,T1027,Obfuscated Files or Information
UPX is an open-source packing algorithm,T1027,Obfuscated Files or Information
MPRESS is a free packer.,T1027,Obfuscated Files or Information
Andromeda is a custom packer,T1027,Obfuscated Files or Information
"compress (and if it has the functionality of a crypter also encrypts) the original executable, which is saved in one of the sections of the final packed file.",T1027,Obfuscated Files or Information
"entry point of the original file is relocated, and so is the Import Address Table (IAT).",T1027,Obfuscated Files or Information
"change the final payload’s section names,",T1027,Obfuscated Files or Information
have very few imports as they don’t rely on external libraries,T1027,Obfuscated Files or Information
"allocate memory, change permissions, read the encrypted/packed chunk of code, decrypt it, load it to the allocated memory space and execute it",T1027,Obfuscated Files or Information
use system calls,T1027,Obfuscated Files or Information
VirtualAlloc used for allocating memory in the current process,T1027,Obfuscated Files or Information
VirtualProtect changes the permissions of the given virtual address.,T1027,Obfuscated Files or Information
RtlDecompressBuffer decompresses the provided buffer.,T1027,Obfuscated Files or Information
CreateProcessInternalW creates a new process.,T1027,Obfuscated Files or Information
can create a new threat with the malicious unpacked payload.,T1027,Obfuscated Files or Information
"initial code usually called a stub, decrypts or decompresses the real code",T1140,Deobfuscate/Decode Files or Information
stub is a small part of code that implements the decompression (and decryption) of the originally packed file,T1140,Deobfuscate/Decode Files or Information
the payload of the malware can be part of the loader’s file,T1027,Obfuscated Files or Information
strongly indicates that it contains another component that is dropped/loaded.,T1027,Obfuscated Files or Information
"it can be downloaded from a remote location (by the loader, also known as a Downloader).",T1105,Ingress Tool Transfer
use system calls,T1106,Native API
VirtualAlloc used for allocating memory in the current process,T1106,Native API
VirtualProtect changes the permissions of the given virtual address,T1106,Native API
RtlDecompressBuffer decompresses the provided buffer.,T1106,Native API
CreateProcessInternalW creates a new process,T1106,Native API
"not see them in the imported function list, and they not even be part of the strings in the sample.",T1027,Obfuscated Files or Information
try to hide these system calls,T1027,Obfuscated Files or Information
function and the corresponding library are dynamically loaded at runtime – also known as explicit linking,T1027,Obfuscated Files or Information
this executable then downloads and executes additional payloads,T1105,Ingress Tool Transfer
This executable binary insecurely downloads and executes additional payloads from the Internet.,T1105,Ingress Tool Transfer
Downloading and running further executables,T1105,Ingress Tool Transfer
It downloads and runs an executable payload,T1105,Ingress Tool Transfer
This is a Windows Native Binary executable embedded inside of UEFI firmware binary,T1027,Obfuscated Files or Information
This Windows executable is embedded into UEFI firmware,T1027,Obfuscated Files or Information
the embedded Windows executable,T1027,Obfuscated Files or Information
an embedded executable,T1027,Obfuscated Files or Information
This executable uses the Windows Native API,T1106,Native API
It then sets registry entries,T1112,Modify Registry
to run this executable as a Windows Service.,T1569.002,System Services: Service Execution
when using the HTTPS-enabled options,T1071.001,Application Layer Protocol: Web Protocols
implants made their native Windows executables look like legitimate update tools.,T1036.005,Masquerading: Match Legitimate Name or Location
the Windows payload was named “IntelUpdater.exe”,T1036.005,Masquerading: Match Legitimate Name or Location
Capturing screenshots,T1113,Screen Capture
Real-time screen monitoring,T1113,Screen Capture
a legitimate tool which is frequently used by bad actors for malicious purposes in ways similar to TeamViewer,T1219,Remote Access Software
"NetSupport Manager, used maliciously or otherwise, provides full and complete control over the target device.",T1219,Remote Access Software
"As NetSupport Manager is a legitimate tool that has a long history of development, it is highly attractive to attackers as it can be relied on to work ‘out of the box’.",T1219,Remote Access Software
"has been observed in multiple ISO files masquerading as legitimate software,",T1036.005,Masquerading: Match Legitimate Name or Location
The RAT installation is disguised to look similar to a Google Chrome installation.,T1036.005,Masquerading: Match Legitimate Name or Location
RAT installer disguised as Google Chrome setup,T1036.005,Masquerading: Match Legitimate Name or Location
threat actors are able to masquerade the dropper or installer,T1036.005,Masquerading: Match Legitimate Name or Location
The sample is obfuscated via the Babadeda crypter.,T1027,Obfuscated Files or Information
a base64 encoded string is used to specify various parameters,T1027,Obfuscated Files or Information
Base64 encoded RAT execution command,T1027,Obfuscated Files or Information
"Persistence for the RAT is achieved via registry entry, and a shortcut to the installed RAT executable is written to the Startup folder.",T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
Persistence via Scheduled Task,T1053.005,Scheduled Task/Job: Scheduled Task
"In addition, the sample generates a scheduled task with multiple triggers.",T1053.005,Scheduled Task/Job: Scheduled Task
Network adapter details are pulled via GetAdaptersAddresses,T1016,System Network Configuration Discovery
Additional data is gleaned via WMI queries,T1047,Windows Management Instrumentation
SELECT * FROM Win32_ComputerSystem,T1082,System Information Discovery
all running processes are enumerated and logged via EnumProcesses (32-bit processes).,T1057,Process Discovery
has the ability to drop and execute additional components.,T1105,Ingress Tool Transfer
These files are all self-deleted after launch,T1070.004,Indicator Removal: File Deletion
threat actors using this tool are very quick to update their lures and find ways to entice their victims into installing the malicious remote control software.,T1204.002,User Execution: Malicious File
decoded command,T1140,Deobfuscate/Decode Files or Information
Downloads the miner and watcher.,T1105,Ingress Tool Transfer
then a malware downloader is uploaded to the device,T1105,Ingress Tool Transfer
Reconfigures Windows Defender to exclude the user profile path and the entire system drive from scanning.,T1562.001,Impair Defenses: Disable or Modify Tools
"its “intelligent” way of brute forcing: it checks the prompt and, based on the prompt, it selects the appropriate credentials.",T1110,Brute Force
This method speeds up the brute forcing process,T1110,Brute Force
“intelligent brute forcing”,T1110,Brute Force
then determines the processor architecture,T1082,System Information Discovery
"Is able to steal/gather information on CPU type, screen resolution",T1082,System Information Discovery
"The downloading of the actual malware is done via a variety of possible commands (for example, wget, curl, tftp and ftpget).",T1570,Lateral Tool Transfer
via the shell “echo” commands.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
keystroke,T1056.001,Input Capture: Keylogging
download a malicious file,T1204.002,User Execution: Malicious File
executes a malicious script,T1204.002,User Execution: Malicious File
"JavaScript is the module that has to be manually executed by the victim,",T1204.002,User Execution: Malicious File
zip archive,T1027,Obfuscated Files or Information
comes with an embedded PE payload,T1027,Obfuscated Files or Information
PE is stored as a Base64 encoded string,T1027,Obfuscated Files or Information
"stored as a list of registry keys, yet we also observed a variant in which similar content was written into a TXT file.",T1027,Obfuscated Files or Information
obfuscated Powershell script that runs another Base64 obfuscated layer that finally decodes the .NET payload.,T1027,Obfuscated Files or Information
embedded inside as a base64 encoded buffer,T1027,Obfuscated Files or Information
In its resources we can find another PE,T1027,Obfuscated Files or Information
been obfuscated in order to hide its real intentions,T1027,Obfuscated Files or Information
"Base64 encoded string, and in the other as a hexadecimal string",T1027,Obfuscated Files or Information
PE file was encoded as an obfuscated hexadecimal string.,T1027,Obfuscated Files or Information
Base64 encoded script,T1027,Obfuscated Files or Information
Base64,T1027,Obfuscated Files or Information
obfuscated by XOR,T1027,Obfuscated Files or Information
three layers where one decodes content for the next,T1140,Deobfuscate/Decode Files or Information
decodes the next element:,T1140,Deobfuscate/Decode Files or Information
deobfuscates and runs another block of code,T1140,Deobfuscate/Decode Files or Information
deobfuscate it.,T1140,Deobfuscate/Decode Files or Information
decodes it,T1140,Deobfuscate/Decode Files or Information
deobfuscate the file,T1140,Deobfuscate/Decode Files or Information
decoding,T1140,Deobfuscate/Decode Files or Information
decoding,T1140,Deobfuscate/Decode Files or Information
Decoded content,T1140,Deobfuscate/Decode Files or Information
Decoded content,T1140,Deobfuscate/Decode Files or Information
deobfuscates,T1140,Deobfuscate/Decode Files or Information
was decoded,T1140,Deobfuscate/Decode Files or Information
"decoding the base64-encoded content,",T1140,Deobfuscate/Decode Files or Information
decompressed,T1140,Deobfuscate/Decode Files or Information
reading/writing registry keys,T1112,Modify Registry
"written to the registry, as a list of keys.",T1112,Modify Registry
JavaScript fetched from the C2 server,T1105,Ingress Tool Transfer
downloaded code chunk,T1105,Ingress Tool Transfer
GET request with C2 server,T1071.001,Application Layer Protocol: Web Protocols
Process Hollowing – one of the classic methods of PE injection,T1055,Process Injection
"PE injection, manual loading into the parent process",T1055,Process Injection
fetches IcedID from a remote resource,T1105,Ingress Tool Transfer
Malicious OneNote attachment,T1566.001,Phishing: Spearphishing Attachment
"The “Forked” version of the malware loader first appeared in February 2023, distributed directly through thousands of personalized invoice-themed phishing emails.",T1566.001,Phishing: Spearphishing Attachment
These messages used Microsoft OneNote attachments (.one) to execute a malicious HTA file,T1566.001,Phishing: Spearphishing Attachment
string-decryption code,T1140,Deobfuscate/Decode Files or Information
sending basic host info to the C2,T1041,Exfiltration Over C2 Channel
"took place over an unencrypted HTTP channel, the network traffic was plainly visible.",T1071.001,Application Layer Protocol: Web Protocols
"When the user double clicks or opens the lnk file,",T1204.002,User Execution: Malicious File
lures the user to open a document.lnk file which will execute the malicious DLL loader,T1204.002,User Execution: Malicious File
"The execution phase started with that password protected zip, which after extracting would show the user an ISO file that after the user double clicks",T1204.002,User Execution: Malicious File
starts a hidden file in the directory,T1564.001,Hide Artifacts: Hidden Files and Directories
"then proceeded to inject into various other processes on the host (explorer.exe, rundll32.exe).",T1055,Process Injection
"From these injected processes,",T1055,Process Injection
the different processes they injected into,T1055,Process Injection
a process where Cobalt Strike was injected into,T1055,Process Injection
The process injection technique was used multiple times to inject into different processes,T1055,Process Injection
Almost every post-exploitation job was launched from an injected process.,T1055,Process Injection
a process where the threat actors injected:,T1055,Process Injection
where they were previously injected into,T1055,Process Injection
Threat actors performed the first lateral movement from the beachhead to the server using RDP with an Administrator account,T1055,Process Injection
previously injected into,T1055,Process Injection
"Process injections in svchost process via CreateRemoteThread, Default named pipes, etc",T1055,Process Injection
processes which threat actors injected into:,T1055,Process Injection
"After injecting into various processes on the host,",T1055,Process Injection
various injections across hosts,T1055,Process Injection
injected into multiple processes on different hosts.,T1055,Process Injection
the threat actors began discovery tasks using Windows utilities,T1059.003,Command and Scripting Interpreter: Windows Command Shell
These batch scripts’ purposes,T1059.003,Command and Scripting Interpreter: Windows Command Shell
then two batch scripts were dropped and run.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"using the following command line:


C:\Windows\System32\cmd.exe /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C powershell.exe -nop -w hidden -c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
launching the getsystem command in the wrong console (shell console rather than the beacon console).,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C getsystem,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C :\Windows\system32\cmd.exe /C shell,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Threat actors used two scripts named s.bat (for servers) and w.bat,T1059.003,Command and Scripting Interpreter: Windows Command Shell
bat script:,T1059.003,Command and Scripting Interpreter: Windows Command Shell
bat script:,T1059.003,Command and Scripting Interpreter: Windows Command Shell
using Windows utilities like ping and tasklist.,T1057,Process Discovery
tasklist,T1057,Process Discovery
tasklist was also used in order to enumerate processes on multiple hosts remotely,T1057,Process Discovery
process list,T1057,Process Discovery
the threat actor started their first lateral movement using RDP,T1021.001,Remote Services: Remote Desktop Protocol
they accessed the server via RDP,T1021.001,Remote Services: Remote Desktop Protocol
"Threat actors used explorer.exe, where they were previously injected into, to initiate a proxied RDP connection to a server:",T1021.001,Remote Services: Remote Desktop Protocol
the threat actor started their first lateral movement using RDP to pivot to a server using the local Administrator account.,T1078,Valid Accounts
the first lateral movement from the beachhead to the server using RDP with an Administrator account:,T1078,Valid Accounts
and again on a server with Administrator privileges.,T1078,Valid Accounts
using the Administrator account each time,T1078,Valid Accounts
"to execute Procdump, which was used to dump lsass.",T1003.001,OS Credential Dumping: LSASS Memory
"they used yet another technique to dump LSASS on the beachhead host, this time using a built in Windows tool comsvcs.dll.",T1003.001,OS Credential Dumping: LSASS Memory
dumping their LSASS process,T1003.001,OS Credential Dumping: LSASS Memory
LSASS Dump,T1003.001,OS Credential Dumping: LSASS Memory
Threat actors dumped the LSASS process from the beachhead using the comsvcs.dll MiniDump technique,T1003.001,OS Credential Dumping: LSASS Memory
C:\programdata\procdump64.exe -accepteula -ma lsass.exe C:\ProgramData\lsass.dmp,T1003.001,OS Credential Dumping: LSASS Memory
"Threat actors also dropped procdump.exe and procdump64.exe on multiple workstations remotely, dumped LSASS,",T1003.001,OS Credential Dumping: LSASS Memory
"Next, the threat actor transferred Sysinternals tool Procdump over SMB, to the ProgramData folders on multiple hosts in the environment.",T1570,Lateral Tool Transfer
"Using the Cobalt Strike beacon, the threat actors transferred AnyDesk (1).exe file from the beachhead to a server:",T1570,Lateral Tool Transfer
The threat actors also transferred ProcDump from the beachhead to multiple workstations:,T1570,Lateral Tool Transfer
This first lateral movement was performed in order to drop and install AnyDesk.,T1570,Lateral Tool Transfer
threat actors remotely dropped AnyDesk binary on a server from the beachhead:,T1570,Lateral Tool Transfer
used PowerShell to download and execute,T1105,Ingress Tool Transfer
which downloaded obfuscated PowerShell and executed it in memory:,T1105,Ingress Tool Transfer
"just C2 communications; until around 3 hours later, Bumblebee dropped a Cobalt Strike beacon",T1105,Ingress Tool Transfer
dropping and the execution of several payloads using multiple techniques,T1105,Ingress Tool Transfer
"threat actors used CS as the main Command and Control tool, dropped several payloads,",T1105,Ingress Tool Transfer
the threat actors used a service account to execute a Cobalt Strike beacon remotely on a Domain Controller.,T1569.002,System Services: Service Execution
"C:\Windows\System32\cmd.exe /c start rundll32 namr.dll,IternalJob",T1218.011,System Binary Proxy Execution: Rundll32
Sysmon File Created event showing wab.exe created by rundll32.exe,T1218.011,System Binary Proxy Execution: Rundll32
cmd.exe /C rundll32.exe,T1218.011,System Binary Proxy Execution: Rundll32
C:\Windows\System32\rundll32.exe,T1218.011,System Binary Proxy Execution: Rundll32
"Because rundll32.exe executed PowerShell, we can see that rundll32.exe created",T1218.011,System Binary Proxy Execution: Rundll32
were initiated from the rundll32.exe process,T1218.011,System Binary Proxy Execution: Rundll32
The random (PsExec) service runs a rundll32.exe process without any arguments.,T1218.011,System Binary Proxy Execution: Rundll32
"The metadata included TA machine’s hostname,",T1082,System Information Discovery
systeminfo,T1082,System Information Discovery
"wmic product get name,version",T1082,System Information Discovery
“Display information about current Windows version,T1082,System Information Discovery
MAC address,T1016,System Network Configuration Discovery
ipconfig /all,T1016,System Network Configuration Discovery
showing wab.exe executed by WMI,T1047,Windows Management Instrumentation
wmic /node,T1047,Windows Management Instrumentation
wmic,T1047,Windows Management Instrumentation
obfuscated PowerShell,T1027,Obfuscated Files or Information
"Once deobfuscated,",T1140,Deobfuscate/Decode Files or Information
its installation as a service was used in order to persist and create a backdoor to the network.,T1543.003,Create or Modify System Process: Windows Service
the win32 function CreateServiceA was used by the malware in order to create a remote service over RPC on the server.,T1543.003,Create or Modify System Process: Windows Service
"a remote service was created with random alphanumeric characters, service name and service file name",T1543.003,Create or Modify System Process: Windows Service
Below is an example of the service edc603a that was created,T1543.003,Create or Modify System Process: Windows Service
A new service was created,T1543.003,Create or Modify System Process: Windows Service
Threat actors obtained and abused credentials of privilege domain accounts,T1078,Valid Accounts
"A service account, with Domain Administration permissions, was used to create a remote service on a Domain Controller to move laterally.",T1078,Valid Accounts
the service account logged into one of the Domain Controllers from the beachhead.,T1078,Valid Accounts
"We observed the threat actors deleting their tools (Procdump, Network scanning scripts, etc.) from hosts.",T1027,Obfuscated Files or Information
ProcDump deletion from the ProgramData folder of all targeted workstations after dumping their LSASS process:,T1027,Obfuscated Files or Information
"Threat actors also dropped procdump.exe and procdump64.exe on multiple workstations remotely, dumped LSASS, and deleted them from the ProgramData folder:",T1027,Obfuscated Files or Information
whoami,T1033,System Owner/User Discovery
C :\Windows\system32\cmd.exe /C shell whoami /all,T1033,System Owner/User Discovery
the win32 function CreateServiceA was used by the malware,T1106,Native API
The account used to perform this lateral movement,T1078,Valid Accounts
Threat actors executed this tool on patient 0 with low-level privileges multiple times,T1078,Valid Accounts
"The threat actor then deployed Anydesk, which was the only observed persistence mechanism used during the intrusion.",T1219,Remote Access Software
they accessed the server via Anydesk.,T1219,Remote Access Software
AnyDesk and its installation as a service was used,T1219,Remote Access Software
"AnyDesk logs, %ProgramData%\AnyDesk\ad_svc.trace and %AppData%\AnyDesk\ad.trace, show that it was used during Day 1 and Day 7 of this intrusion",T1219,Remote Access Software
"The threat actors managed to get access to the beachhead host after the successful execution of a lnk file within an ISO, which are usually distributed through email campaigns.",T1566.001,Phishing: Spearphishing Attachment
Threat actors also created a remote thread in svchost.exe,T1055,Process Injection
"Right after its execution, the wab.exe process created two remote threads in order to inject code into explorer.exe and rundll32.exe:",T1055,Process Injection
the service account password was weak and cracked offline by threat actors.,T1110,Brute Force
Named pipes were created in order to establish communication between CS processes,T1090,Proxy
Named piped are commonly used by Cobalt Strike perform various techniques.,T1090,Proxy
used CMD-based scripts,T1059.003,Command and Scripting Interpreter: Windows Command Shell
CMD-based scripts,T1059.003,Command and Scripting Interpreter: Windows Command Shell
CMD-based scripts,T1059.003,Command and Scripting Interpreter: Windows Command Shell
gets executed via the “SHELLEXECUTE”.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
The first .CMD file set seen to use AutoIt in its execution,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Each email has an HTML attachment.,T1566.001,Phishing: Spearphishing Attachment
"The email text employs scare tactics, such as evidence of a traffic violation, prompting the user to open the HTML attachment",T1566.001,Phishing: Spearphishing Attachment
prompting the user to open the HTML attachment,T1204.002,User Execution: Malicious File
contains some junk code and data in HEX format.,T1027,Obfuscated Files or Information
The data blob in HEX decodes,T1140,Deobfuscate/Decode Files or Information
slightly obfuscated URL address,T1027,Obfuscated Files or Information
two base64 encoded data blobs and code instructions for its execution.,T1027,Obfuscated Files or Information
base64 data block execution,T1027,Obfuscated Files or Information
The first base64 data blob,T1027,Obfuscated Files or Information
All data is then sent back to the attacker's C2,T1041,Exfiltration Over C2 Channel
the attacker's C2 via the HTTP POST method.,T1071.001,Application Layer Protocol: Web Protocols
The C2 is constructed with the victim's enumerated data,T1005,Data from Local System
"extract sensitive information,",T1005,Data from Local System
operating system version,T1082,System Information Discovery
OS architecture (x86 or x64),T1082,System Information Discovery
keyboard layout,T1082,System Information Discovery
Opening the attached “multa_de_transito_502323.html” file triggers the embedded JavaScript,T1027,Obfuscated Files or Information
download a “.VBS” file,T1105,Ingress Tool Transfer
It proceeds by downloading the “sqlite3.dll” file,T1105,Ingress Tool Transfer
"to steal Outlook data such as server, user, and password from POP3, SMPT, and IMAP registry keys",T1012,Query Registry
exploiting vulnerable web-facing devices,T1190,Exploit Public-Facing Application
"exfiltrate proprietary or confidential information,",T1005,Data from Local System
decrypting a shellcode,T1140,Deobfuscate/Decode Files or Information
starts by decrypting its initial configuration data,T1140,Deobfuscate/Decode Files or Information
It starts its code by decrypting its initial configuration,T1140,Deobfuscate/Decode Files or Information
the code of the decryption algorithm used by RedLine Stealer to decrypt its initial configuration data,T1140,Deobfuscate/Decode Files or Information
Once the initial configuration data has been decrypted,T1140,Deobfuscate/Decode Files or Information
to decrypt the password stored,T1140,Deobfuscate/Decode Files or Information
"Once the master key is decrypted,",T1140,Deobfuscate/Decode Files or Information
to decrypt it using AES GCM algorithm,T1140,Deobfuscate/Decode Files or Information
The decrypted password,T1140,Deobfuscate/Decode Files or Information
Try to disable Windows Defender service “WinDefend”,T1562.001,Impair Defenses: Disable or Modify Tools
Try to disable Tamper Protection settings of Windows Defender,T1562.001,Impair Defenses: Disable or Modify Tools
"Try to Disable AntiSpyware, Real Time Protection and notification of Windows Defender.",T1562.001,Impair Defenses: Disable or Modify Tools
"Disable Windows update services such as (“wuauserv”, “WaaSMedicSvc”, “UsoSvc”)",T1562.001,Impair Defenses: Disable or Modify Tools
Disable Automatic Update and change Windows configurations related to Windows Update ,T1562.001,Impair Defenses: Disable or Modify Tools
which is often encoded or encrypted to prevent detection,T1027,Obfuscated Files or Information
combination of Base64 and XOR functions.,T1027,Obfuscated Files or Information
The master key is encoded with Base64 and encrypted,T1027,Obfuscated Files or Information
to grab the encoded and encrypted master key,T1027,Obfuscated Files or Information
it will parse the AES IV (Initialization vector) and the encrypted password,T1027,Obfuscated Files or Information
to steal information from the compromised or targeted host,T1005,Data from Local System
has the ability to collect or extract various types of system information from a targeted or compromised computer,T1082,System Information Discovery
func_GetHostSerialNumber(),T1082,System Information Discovery
host serial number,T1082,System Information Discovery
"Retrieves  system default language, timezone and OS version",T1082,System Information Discovery
"Get processor information of the compromised host by executing ""SELECT * FROM Win32_Processor""",T1082,System Information Discovery
func_GetProcessor(),T1082,System Information Discovery
func_GetLanguageTimeZoneOsVersion(),T1082,System Information Discovery
func_GetGraphicCards,T1082,System Information Discovery
"Get AdapterRAM and Graphic Card Name and type by executing  ""root\\CIMV2"", ""SELECT * FROM Win32_VideoController""",T1082,System Information Discovery
func_GetTotalRAM(),T1082,System Information Discovery
"Get the total RAM size of compromised host by executing ""SELECT * FROM Win32_OperatingSystem"" and look for ""TotalVisibleMemorySize""",T1082,System Information Discovery
"Retrieve the user domain name, username",T1033,System Owner/User Discovery
Get the user name of the compromised host,T1033,System Owner/User Discovery
func_GetUserName(),T1033,System Owner/User Discovery
"Parse firewall and Anti Virus Product install in the compromised host by running
""SELECT * FROM ROOT\\SecurityCenter2""
""SELECT * FROM ROOT\\SecurityCenter""
""SELECT * FROM AntivirusProduct""
""SELECT * FROM FirewallProduct""
""SELECT * FROM AntiSpyWareProduct""",T1518.001,Software Discovery: Security Software Discovery
func_GetFirewalls(),T1518.001,Software Discovery: Security Software Discovery
func_ListProcesses(),T1057,Process Discovery
Retrieve process list and process information by running 'SELECT * FROM Win32_Process',T1057,Process Discovery
Screen Capture,T1113,Screen Capture
func_ScanScreen() is the one responsible for this screen capture capability,T1113,Screen Capture
has a functionality to capture a screenshot of the targeted or compromised host as part of its data collection and exfiltration,T1113,Screen Capture
uses .NET Graphics class CopyFromScreen Function() to transfer a bit block of color data from the screen to the Graphic drawing surface that will be saved in memory stream for data exfiltration.,T1113,Screen Capture
Parse all installed application in the compromised host by querying 'SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall' registry,T1012,Query Registry
"Parse browser application and browser version installed in the compromised host by querying ""SOFTWARE\WOW6432Node\Clients\StartMenuInternet"" or ""SOFTWARE\Clients\StartMenuInternet"" registry",T1012,Query Registry
uses .NET Graphics class CopyFromScreen Function(),T1106,Native API
using Windows CryptProtectData() API.,T1106,Native API
cracking browser sensitive information like passwords,T1110,Brute Force
The decrypted password will be sent to its C2 Server as part of its data exfiltration.,T1041,Exfiltration Over C2 Channel
it enumerates several known Crypto Wallet directories and looks for files related to crypto currencies by looking for files having “wallet” substring on its file name.,T1083,File and Directory Discovery
"used a compiled remote desktop malware,",T1021.001,Remote Services: Remote Desktop Protocol
then executed RDPEnable on the infected machine.,T1021.001,Remote Services: Remote Desktop Protocol
There were also instances of the malware actors using PsEXEC to enable the remote desktop protocol (RDP) of a target system,T1021.001,Remote Services: Remote Desktop Protocol
It enumerates files and directories,T1083,File and Directory Discovery
File enumeration,T1083,File and Directory Discovery
"using FindFirstFileW, FindNextFileW, and FindClose APIs",T1083,File and Directory Discovery
For each directory it traverses,T1083,File and Directory Discovery
"using FindFirstFileW, FindNextFileW, and FindClose APIs",T1106,Native API
installing remote access software.,T1219,Remote Access Software
"actors used tools such as PCHunter, PowerTool, GMER, and Process Hacker to disable any security-related services running in the system.",T1562.001,Impair Defenses: Disable or Modify Tools
by listing accessible local IPs,T1016,System Network Configuration Discovery
It checks for the number of processors in the infected system,T1082,System Information Discovery
Checking the number of processors,T1082,System Information Discovery
"This is a multi-stage attack that involves sideloading DLLs,",T1574.002,Hijack Execution Flow: DLL Side-Loading
involves sideloading DLLs along,T1574.002,Hijack Execution Flow: DLL Side-Loading
icon files with encrypted data appended to the end of the files.,T1027,Obfuscated Files or Information
"These encrypted strings,",T1027,Obfuscated Files or Information
"once decrypted, contained the C2 domains for additional malicious artifacts.",T1140,Deobfuscate/Decode Files or Information
attempt to obtain system information,T1082,System Information Discovery
the malware attempts to retrieve additional malicious artifacts,T1105,Ingress Tool Transfer
Inject and execute DLLs,T1055,Process Injection
Manipulate processes (list,T1057,Process Discovery
Manipulate files and directories (list,T1083,File and Directory Discovery
"Manipulate files and directories (list, download, upload, view, delete",T1070.004,Indicator Removal: File Deletion
"download, upload",T1105,Ingress Tool Transfer
Take screenshots,T1113,Screen Capture
Execute commands via Command Prompt,T1059.003,Command and Scripting Interpreter: Windows Command Shell
executed using ShellExecute with the following command line:,T1059.003,Command and Scripting Interpreter: Windows Command Shell
This type of threats is usually delivered as email attachments.,T1566.001,Phishing: Spearphishing Attachment
Encoded binary payload,T1027,Obfuscated Files or Information
Encrypted and compressed payload,T1027,Obfuscated Files or Information
Start of encrypted and compressed loader configuration and payload,T1027,Obfuscated Files or Information
"an encoded payload split across several nodes, further complicating its extraction.",T1027,Obfuscated Files or Information
That node contains the encoded payload.,T1027,Obfuscated Files or Information
the encoded payload,T1027,Obfuscated Files or Information
"To hide the strings it uses during its execution, it primarily uses a simple encoding by subtracting 35 from each character of the original string and encoding the result with Base64",T1027,Obfuscated Files or Information
"Similar to decoding strings, the binary payload is extracted by decoding the data using Base64 and adding 35.",T1140,Deobfuscate/Decode Files or Information
the resulting bytes are further decoded with xor 82.,T1140,Deobfuscate/Decode Files or Information
The decoded payload,T1140,Deobfuscate/Decode Files or Information
Once the payload is decoded,T1140,Deobfuscate/Decode Files or Information
After decrypting and decompressing the payload,T1140,Deobfuscate/Decode Files or Information
Decrypted and decompressed payload,T1140,Deobfuscate/Decode Files or Information
Decodes sensitive memory regions in the current process with the same XOR key,T1140,Deobfuscate/Decode Files or Information
it locates a packed and compressed payload,T1027,Obfuscated Files or Information
Injection type: Current process (1) or in the new process,T1055,Process Injection
Process to inject into,T1055,Process Injection
 Process to inject into,T1055,Process Injection
this loader prepends a stub containing 79 bytes of junk instructions before the actual payload shellcode.,T1027,Obfuscated Files or Information
The bytes at 25 hardcoded offsets within this stub are replaced with random bytes to hinder shellcode detection.,T1027,Obfuscated Files or Information
"To launch the shellcode, the loader calls ZwCreateThreadEx to create a new suspended injection thread hidden from debuggers using the THREAD_CREATE_FLAGS_CREATE_SUSPENDED (0x01) and THREAD_CREATE_FLAGS_HIDE_FROM_DEBUGGER (0x4) thread creation flags.",T1055,Process Injection
by redirecting calls to the Windows Sleep API to its own function,T1106,Native API
communicates with the C2 server specified in the configuration via HTTP or HTTPS POST requests,T1071.001,Application Layer Protocol: Web Protocols
shared with the C2 server on the initial check-in request (Figure 11) for encrypting subsequent data communicated between the agent and C2 server with AES-256-CTR.,T1573.001,Encrypted Channel: Symmetric Cryptography
the execution of the downloaded DLL via the tool rundll32.exe.,T1218.011,System Binary Proxy Execution: Rundll32
performs the download of a file,T1105,Ingress Tool Transfer
PowerShell script that downloads and executes a dropper,T1105,Ingress Tool Transfer
downloads a payload,T1105,Ingress Tool Transfer
malware dynamically calls the API NtAllocateVirtualMemory,T1106,Native API
AES Cryptographic Provider from WinCrypt APIs,T1106,Native API
the API Web RESTful that provides access to Microsoft Cloud service resources.,T1106,Native API
using the Microsoft Graph API,T1106,Native API
uses the Microsoft Graph API,T1106,Native API
decrypted using the RSA,T1140,Deobfuscate/Decode Files or Information
The malware proceeds to de-obfuscate strings using a XOR loop,T1140,Deobfuscate/Decode Files or Information
de-obfuscated strings:,T1140,Deobfuscate/Decode Files or Information
decrypted through an AES-256-CBCdecryption algorithm,T1140,Deobfuscate/Decode Files or Information
decrypted,T1140,Deobfuscate/Decode Files or Information
the decrypted content,T1140,Deobfuscate/Decode Files or Information
The code in the injected PE,T1055,Process Injection
"injects in itself a new PE (Portable Executable) file,",T1055,Process Injection
passes the execution to the region of memory in which the copied PE is allocated,T1055,Process Injection
the imported code dynamically calls VirtualAlloc to allocate a new region of memory in which a new PE file is copied.,T1055,Process Injection
the full HTTP request to make the first connection to the C&C,T1071.001,Application Layer Protocol: Web Protocols
enumerating the child files in the check OneDrive subdirectory.,T1083,File and Directory Discovery
The execution triggers the setting of the following registry key,T1112,Modify Registry
triggered when the user starts the presentation mode and moves the mouse,T1204.002,User Execution: Malicious File
triggered when the user starts the presentation mode and moves the mouse,T1204.002,User Execution: Malicious File
"A new file, again with a JPEG extension",T1027,Obfuscated Files or Information
"Contents of the .img file, including the hidden files",T1564.001,Hide Artifacts: Hidden Files and Directories
hiding the rest of its files from the user.,T1564.001,Hide Artifacts: Hidden Files and Directories
to run the subsequent BAT scripts,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the attacker’s BAT file to run,T1059.003,Command and Scripting Interpreter: Windows Command Shell
The BAT script,T1059.003,Command and Scripting Interpreter: Windows Command Shell
a BAT file (4.2) to be run on logon as another UI shell,T1059.003,Command and Scripting Interpreter: Windows Command Shell
executes another BAT script,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Some variants used a known UAC bypass method abusing the legitimate fodhelper.exe,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
UAC bypass implementation,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
"If it fails, it sets in the registry",T1112,Modify Registry
Register a new service,T1543.003,Create or Modify System Process: Windows Service
a new service that will run its VBS script (4.1) using sc.exe.,T1569.002,System Services: Service Execution
the malicious executable to unpack itself.,T1027,Obfuscated Files or Information
"which is unpacked only when run with a unique password, allow evading traditional signature-based detection.",T1027,Obfuscated Files or Information
decrypting and running the ransomware,T1140,Deobfuscate/Decode Files or Information
The user is then prompted to open the single visible shortcut (2) file.,T1204.002,User Execution: Malicious File
contains obfuscated VBA scripts or a binary with a JPG extension,T1027,Obfuscated Files or Information
to trick users into opening the malicious attachments in,T1204.002,User Execution: Malicious File
"If a target opens the malicious attachment,",T1204.002,User Execution: Malicious File
using three possible types of messages to try to get a target to open the email and malicious attachment.,T1204.002,User Execution: Malicious File
"The attachment, if opened,",T1204.002,User Execution: Malicious File
spear phishing emails pretending to be from financial vendors or partners to trick users into opening the malicious attachments in the emails.,T1566.001,Phishing: Spearphishing Attachment
a malicious attachment sent via phishing emails,T1566.001,Phishing: Spearphishing Attachment
"the malicious attachment,",T1566.001,Phishing: Spearphishing Attachment
the email and malicious attachment.,T1566.001,Phishing: Spearphishing Attachment
sends emails pretending to be related to a shipment notice for the target which contain a malicious attachment.,T1566.001,Phishing: Spearphishing Attachment
Both send information to command and control (C2) servers,T1041,Exfiltration Over C2 Channel
keylogging every tap,T1056.001,Input Capture: Keylogging
obtain logs of the infected machine’s keystrokes,T1056.001,Input Capture: Keylogging
exfiltrate data from messaging applications such as WhatsApp and Viber,T1005,Data from Local System
The malware can deliver payloads from the command and control (C2) server,T1105,Ingress Tool Transfer
This vulnerability allows for a threat actor to obtain system privileges,T1068,Exploitation for Privilege Escalation
take screenshots,T1113,Screen Capture
"This version of CEIDPageLock has VMProtect, which makes analysis and unpacking difficult",T1027,Obfuscated Files or Information
then proceeded to dump credentials from LSASS.,T1003.001,OS Credential Dumping: LSASS Memory
the threat actors again used Get-System to elevate and then dumped LSASS.,T1003.001,OS Credential Dumping: LSASS Memory
"Cobalt Strike beacons accessing LSASS on multiple occasions, on almost every compromised host.",T1003.001,OS Credential Dumping: LSASS Memory
threat actor injected into a dllhost.exe process,T1055,Process Injection
which is then injected into svchost and dllhost.,T1055,Process Injection
Process injection was observed during the intrusion,T1055,Process Injection
direct Cobalt Strike processes and the injected processes,T1055,Process Injection
"injecting into multiple other processes, such as explorer.exe and svchost.exe, to execute further payloads.",T1055,Process Injection
dumped from an injection into the SearchIndexer process,T1055,Process Injection
This was achieved by transferring a Cobalt Strike DLL over SMB,T1570,Lateral Tool Transfer
the SMB lateral transfer of one of the Atera Agent MSI installers (1.msi) used to gain access laterally on a host and provide persistence for later access.,T1570,Lateral Tool Transfer
SMB to transfer DLL's into the ProgramData folder of hosts for purposes of lateral movement.,T1570,Lateral Tool Transfer
and executing via a remote service on another workstation.,T1569.002,System Services: Service Execution
using a batch file named find.bat.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Windows discovery commands,T1059.003,Command and Scripting Interpreter: Windows Command Shell
using a batch script,T1059.003,Command and Scripting Interpreter: Windows Command Shell
batch script,T1059.003,Command and Scripting Interpreter: Windows Command Shell
basic discovery tasks on the host using built in Windows utilities.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
via the find.bat batch script.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
which was then fed to a batch script,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"The batch file contained one line,",T1059.003,Command and Scripting Interpreter: Windows Command Shell
began enumerating the network using native Windows binaries,T1059.003,Command and Scripting Interpreter: Windows Command Shell
via the interactive shell,T1059.003,Command and Scripting Interpreter: Windows Command Shell
wrote a registry run key for persistence,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
used a registry run key to maintain persistence.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
systeminfo,T1082,System Information Discovery
systeminfo,T1082,System Information Discovery
C:\Windows\system32\cmd.exe /C systeminfo,T1082,System Information Discovery
ipconfig,T1016,System Network Configuration Discovery
ipconfig /all,T1016,System Network Configuration Discovery
sending new emails with attached xls and zip files.,T1566.001,Phishing: Spearphishing Attachment
The document came in via email in the form of a zip file which included an xls file.,T1566.001,Phishing: Spearphishing Attachment
"The emails were sent through various compromised email accounts, propagating additional malicious xls files",T1566.001,Phishing: Spearphishing Attachment
Using the remote admin tools,T1219,Remote Access Software
the threat actor deployed several Atera/Splashtop remote access tools across the environment as an alternative means of access to the environment,T1219,Remote Access Software
Threat actors used Atera and Splashtop remote access tools on two compromised hosts during the intrusion.,T1219,Remote Access Software
after a user opened an Excel document and enabled macros.,T1204.002,User Execution: Malicious File
To deobfuscate the document the tool xlmdeobfuscator was used with the following output.,T1140,Deobfuscate/Decode Files or Information
After deobfuscation,T1140,Deobfuscate/Decode Files or Information
used process hollowing to launch under the context of the Dllhost.exe process,T1055,Process Injection
"the following URLs are hard coded, and obfuscated",T1027,Obfuscated Files or Information
to download the second stage.,T1105,Ingress Tool Transfer
malware pulled down and executed a Cobalt Strike payload on,T1105,Ingress Tool Transfer
ran another round of discovery activity with native windows utilities,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
“C:\Windows\System32\cmd.exe” CommandLine: “C:\Windows\system32\cmd.exe /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C gpupdate ,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C gpupdate ,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C gpupdate ,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C gpupdate ,T1059.003,Command and Scripting Interpreter: Windows Command Shell
whoami.exe,T1033,System Owner/User Discovery
cmd.exe /C whoami,T1033,System Owner/User Discovery
The threat actors continued by moving laterally to the domain controllers on the network using SMB to transfer and execute a Cobalt Strike Beacon,T1570,Lateral Tool Transfer
"the threat actors used PsExec, to copy and execute a Cobalt Strike Beacon DLL on most of the systems in the network.",T1570,Lateral Tool Transfer
"They utilized RDP,",T1021.001,Remote Services: Remote Desktop Protocol
the threat actor was seen establishing RDP connections,T1021.001,Remote Services: Remote Desktop Protocol
"Cobalt Strike was used to enable RDP,",T1021.001,Remote Services: Remote Desktop Protocol
remotedesktop mode = enable cmd,T1021.001,Remote Services: Remote Desktop Protocol
RDP connections were established from the beachhead host to systems throughout the environment,T1021.001,Remote Services: Remote Desktop Protocol
details of the RDP session,T1021.001,Remote Services: Remote Desktop Protocol
"the initial vector used by the threat actor was a zip file, which included a malicious JavaScript file, delivered through a phishing campaign.",T1566.001,Phishing: Spearphishing Attachment
"This RDP activity was being proxied through the IcedID process running on that host, to a remote proxy over port 8080.",T1090,Proxy
"in an effort to evade any detection and prevention mechanisms, they disabled Windows Defender",T1562.001,Impair Defenses: Disable or Modify Tools
"To evade detection, the threat actors disabled Windows Defender",T1562.001,Impair Defenses: Disable or Modify Tools
they disabled Windows Defender via a group policy modification.,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
by adding the below to an already linked GPO.,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
They then force updated the GPO on all clients using Cobalt Strike.,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
Cobalt Strike Beacon was dropped and executed on the system,T1105,Ingress Tool Transfer
was executed via rundll32.exe,T1218.011,System Binary Proxy Execution: Rundll32
including the computer name and the OS version of the compromised system were sent,T1082,System Information Discovery
cmd.exe /C reg add,T1112,Modify Registry
"HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiSpyware 
DeleteValue ",T1112,Modify Registry
"HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Monitoring\DisableRealtimeMonitoring 
DeleteValue ",T1112,Modify Registry
"HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Monitoring\DisableBehaviorMonitoring 
DeleteValue ",T1112,Modify Registry
"HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Monitoring\DisableIntrusionPreventionSystem 
DeleteValue ",T1112,Modify Registry
"HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection 
DeleteKey ",T1112,Modify Registry
The threat actor used a redirector (38.135.122[.]194:8080) to proxy the RDP traffic being passed,T1090,Proxy
This proxied traffic,T1090,Proxy
"LSASS was accessed by an unusual process “runonce.exe” on multiple hosts, including a domain controller.",T1003.001,OS Credential Dumping: LSASS Memory
systems injected the Conti DLL into memory,T1055,Process Injection
web application vulnerabilities,T1190,Exploit Public-Facing Application
exploiting vulnerabilities in Apache and Apache Spark (CVE-2021-42013 and CVE-2022-33891,T1190,Exploit Public-Facing Application
GrandstreamCVE-2020-25223WebAdmin of Sophos SG UTMCVE-2021-42013ApacheCVE-2022-31137Roxy-WICVE-2022-33891Apache SparkZSL-,T1190,Exploit Public-Facing Application
"CVE-2018-12613, a phpMyAdmin vulnerability that could allow threat actors to view or execute files",T1190,Exploit Public-Facing Application
propagating through brute force attacks on vulnerable devices with insecure configurations that use default or weak credentials,T1110,Brute Force
default or weak credentials,T1078,Valid Accounts
using a combination of eight common usernames and 130 passwords,T1110,Brute Force
malicious payload,T1105,Ingress Tool Transfer
downloads,T1105,Ingress Tool Transfer
downloads the Zerobot binary,T1105,Ingress Tool Transfer
download and execute binaries of various architectures until it succeeds,T1105,Ingress Tool Transfer
"download this RAT,",T1105,Ingress Tool Transfer
identify the architecture,T1082,System Information Discovery
copies itself to the Startup folder,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
methodDescriptionUDP_LEGITSends UDP packets without data,T1095,Non-Application Layer Protocol
TCP_HANDSHAKEFloods with TCP handshakes.TCP_SOCKETContinuously sends random payloads on an open TCP socket.,T1095,Non-Application Layer Protocol
TLS_SOCKETContinuously sends random payloads on an open TLS socket.,T1095,Non-Application Layer Protocol
"methodDescriptionUDP_RAWSends UDP packets where the payload is customizable.ICMP_FLOODSupposed to be an ICMP flood, but the packet is built incorrectly.TCP_CUSTOMSends TCP packets where the payload and flags are fully customizable.TCP_SYNSends SYN packets.TCP_ACKSends ACK packets.TCP_SYNACKSends SYN-ACK packets.TCP_XMASChristmas tree attack (all TCP flags are set).",T1095,Non-Application Layer Protocol
HTTP_HANDLESends HTTP GET requests using a Golang standard library.HTTP_RAWFormats and sends HTTP GET requests.HTTP_BYPASSSends HTTP GET requests with spoofed headers.HTTP_NULLHTTP headers are each one random byte (,T1071.001,Application Layer Protocol: Web Protocols
Zerobot HTTP requests,T1071.001,Application Layer Protocol: Web Protocols
"open-source remote administration tool (RAT) with various features such as managing processes, file operations, screenshotting, and running commands.",T1219,Remote Access Software
running commands,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"screenshotting,",T1113,Screen Capture
This attachment (unless zipped) is the MyDoom executable.,T1566.001,Phishing: Spearphishing Attachment
"executables attached to its phishing e-mails have an extension hidden by default by most Windows deployments (.cmd, .scr, .com, etc.).",T1566.001,Phishing: Spearphishing Attachment
the file is a 32-bit Windows executable packed using the UPX (Ultimate Packer for Executables) packer (https://en.wikipedia.org/wiki/UPX) to compress and make it more difficult to analyze.,T1027,Obfuscated Files or Information
The packer decompresses and executes,T1027,Obfuscated Files or Information
"Upon execution, an attempt to alter the Windows firewall settings is made.",T1562.001,Impair Defenses: Disable or Modify Tools
"makes a copy of itself, places it in the “Temp” folder (C:\Users\<user>\AppData\Local\Temp), and changes the name to a known Windows application/process.",T1036.005,Masquerading: Match Legitimate Name or Location
The activity thereafter included dumps of LSASS,T1003.001,OS Credential Dumping: LSASS Memory
process enumerations.,T1057,Process Discovery
then launched by cmd.exe,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the executable ‘3ujwy2rz7v.exe’ was downloaded,T1105,Ingress Tool Transfer
that uses command and control servers to collect information on compromised systems,T1041,Exfiltration Over C2 Channel
A user had to click on this in order to execute the malware.,T1204.002,User Execution: Malicious File
the malware immediately begins to look for EDR and antivirus software.,T1518.001,Software Discovery: Security Software Discovery
Phishing emails spoof legitimate senders to deliver RokRAT via LNK files,T1566.001,Phishing: Spearphishing Attachment
Email attachments mimic legitimate documents,T1566.001,Phishing: Spearphishing Attachment
several Zip Archives files hosting multiple lure documents likely sent via phishing campaigns,T1566.001,Phishing: Spearphishing Attachment
targets for phishing emails containing this type of decoy document.,T1566.001,Phishing: Spearphishing Attachment
"campaigns typically begin with a phishing email with a ZIP file attachment, containing a LNK file disguised as a Word document",T1566.001,Phishing: Spearphishing Attachment
containing obfuscated PowerShell scripts,T1027,Obfuscated Files or Information
the obfuscation technique for the dropped files being hex-encoding vs. string concatenation,T1027,Obfuscated Files or Information
"contain an encoded PowerShell,",T1027,Obfuscated Files or Information
PowerShell scripts in charge of downloading a second stage RokRAT shellcode,T1105,Ingress Tool Transfer
file download/upload,T1105,Ingress Tool Transfer
to start the download process,T1105,Ingress Tool Transfer
downloads the payload,T1105,Ingress Tool Transfer
keylogging,T1056.001,Input Capture: Keylogging
"Optical Disc Image files (ISO) containing LNK files that had slightly modified PowerShell scripts, and Hangul Word Processor decoy documents",T1027,Obfuscated Files or Information
The ISO files that X-Force observed contained a LNK file,T1027,Obfuscated Files or Information
a JPEG decoy file are dropped,T1027,Obfuscated Files or Information
the JPEG decoy file,T1027,Obfuscated Files or Information
a batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
a batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
drop batch files,T1059.003,Command and Scripting Interpreter: Windows Command Shell
then the payload is executed using Windows API functions (VirtualProtect).,T1106,Native API
"the payload that is decoded using the first byte as a key,",T1140,Deobfuscate/Decode Files or Information
packed into a Windows executable file,T1027,Obfuscated Files or Information
stealing sensitive data from the victim’s networks.,T1005,Data from Local System
the adversary identifies data of interest from the network of the victim,T1005,Data from Local System
"This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intellectual property (IP), and data scraped from memory.",T1005,Data from Local System
the adversary collected the data from various sources within the victim’s network.,T1005,Data from Local System
Credential theft and password spraying,T1110,Brute Force
"password spraying attack against the victim’s remote services,",T1110,Brute Force
"With this list of administrator-accounts, the adversary performs another password spraying attack until a valid admin account is compromised",T1110,Brute Force
"The adversary started a password spraying attack against those domain admin accounts,",T1110,Brute Force
The user account was possibly compromised on the Linux server by using credential stuffing or password spraying:,T1110,Brute Force
Logfiles on the Linux-system show traces which can be attributed to a credential stuffing or password spraying attack.,T1110,Brute Force
Password spraying,T1110,Brute Force
or password spraying.,T1110,Brute Force
This adversary starts with obtaining usernames,T1033,System Owner/User Discovery
The built-in Windows quser-command to show logged on users is also heavily used by them.,T1033,System Owner/User Discovery
"To identify if privileged users are active on remote servers, the adversary makes use of PsLogList from Microsoft Sysinternals",T1033,System Owner/User Discovery
to identify if privileged users are active on the systems,T1033,System Owner/User Discovery
These credentials are used in a credential stuffing,T1110,Brute Force
The user account was possibly compromised on the Linux server by using credential stuffing,T1110,Brute Force
Logfiles on the Linux-system show traces which can be attributed to a credential stuffing or password spraying attack.,T1110,Brute Force
credential stuffing,T1110,Brute Force
more specifically by credential stuffing,T1110,Brute Force
"After obtaining a valid account, they use this account to access the victim’s VPN, Citrix or another remote service that allows access to the network of the victim.",T1078,Valid Accounts
"With this valid admin account, a Cobalt Strike beacon is loaded into memory of patient zero.",T1078,Valid Accounts
the adversary used the valid account to directly login,T1078,Valid Accounts
The threat used valid accounts against remote services:,T1078,Valid Accounts
the adversary accessed the company portal with the valid account.,T1078,Valid Accounts
"cloud drive, or other cloud resources accessible by the compromised account.",T1078,Valid Accounts
"the adversary now armed with the valid account, was able to access a document stored in SharePoint Online, part of Microsoft Office 365.",T1078,Valid Accounts
starts using the Cobalt Strike beacon for remote access and command and control.,T1219,Remote Access Software
"If the obtained valid account is already member of the domain admins group, the first lateral move in the network is usually to a domain controller",T1078,Valid Accounts
"After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network,",T1078,Valid Accounts
"and finds the trust relationships and jump hosts, attempting to move into the other domains and security zones.",T1078,Valid Accounts
successfully got a valid domain admin account this way.,T1078,Valid Accounts
"In other cases, the adversary moved laterally to another system with a domain admin logged in.",T1078,Valid Accounts
"This can be anything from file and directory-listings,",T1083,File and Directory Discovery
"the adversary copying results of the discovery phase, like file- and directory lists from local systems,",T1083,File and Directory Discovery
"If the data is small enough, it is exfiltrated through the command and control channel of the Cobalt Strike beacons.",T1041,Exfiltration Over C2 Channel
The adversary uses the command and control channel to exfiltrate small amounts of data.,T1041,Exfiltration Over C2 Channel
adversary executes Cobalt Strike’s built-in Mimikatz to dump its password hashes.,T1003.001,OS Credential Dumping: LSASS Memory
We observed the use of Mimikatz on this system and saw the hashes of the logged in domain admin account going,T1003.001,OS Credential Dumping: LSASS Memory
the actor executes Cobalt Strike’s built-in Mimikatz to dump its credentials or password hash,T1003.001,OS Credential Dumping: LSASS Memory
", staged on another system of the victim, and from there copied to a OneDrive-account controlled by the adversary.",T1074.001,Data Staged: Local Data Staging
Files and folders of interest are collected as well and staged for exfiltration.,T1074.001,Data Staged: Local Data Staging
We’ve seen the adversary staging data on a remote system or on the local system.,T1074.001,Data Staged: Local Data Staging
This activity group always uses a renamed version of rar.exe.,T1036.005,Masquerading: Match Legitimate Name or Location
The adversary copied those tools over SMB from compromised system to compromised system wherever they needed these tools.,T1570,Lateral Tool Transfer
The DLL’s used were side-loaded in memory on compromised systems.,T1574.002,Hijack Execution Flow: DLL Side-Loading
File deletion,T1070.004,Indicator Removal: File Deletion
Use scheduled tasks,T1053.005,Scheduled Task/Job: Scheduled Task
The adversary heavily relies on scheduled tasks for executing a batch-file (.bat) to perform their tasks.,T1053.005,Scheduled Task/Job: Scheduled Task
"An example of the creation of such a scheduled task by the adversary:
schtasks /create /ru ""SYSTEM"" /tn ""update"" /tr ""cmd /c c:\windows\temp\update.bat"" /sc once /f /st 06:59:00",T1053.005,Scheduled Task/Job: Scheduled Task
batch files for automation.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"The batch-files appear to be used to load the Cobalt Strike beacon, but also to perform discovery commands on the compromised system.",T1059.003,Command and Scripting Interpreter: Windows Command Shell
executing a batch-file (.bat) to perform their tasks.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
They switched to C2 encapsulated in HTTPS in Q3 2019.,T1071.001,Application Layer Protocol: Web Protocols
the adversary achieving credentials access by brute force,T1110,Brute Force
The adversary installs a hackers best friend during the intrusion: Cobalt Strike.,T1105,Ingress Tool Transfer
"the adversary also searches for VPN and firewall configs,",T1518.001,Software Discovery: Security Software Discovery
"This lures users to double-click the graphic to view the content,",T1204.002,User Execution: Malicious File
Malicious documents that implement this technique require users to double-click a document element.,T1204.002,User Execution: Malicious File
capturing screenshots,T1113,Screen Capture
and enumerating files and drives,T1083,File and Directory Discovery
establish persistence by creating a registry key under \SOFTWARE\Microsoft\Windows\CurrentVersion\Run only if the victim’s machine name differs.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
include exfiltrating system information,T1005,Data from Local System
"implement different obfuscation techniques of varying intensities, for example, simple function name malformation and dynamic string resolution.",T1027,Obfuscated Files or Information
the obfuscation techniques used,T1027,Obfuscated Files or Information
"obfuscated using Crypto Obfuscator,",T1027,Obfuscated Files or Information
malicious dynamic link library (DLL) file that’s eventually side-loaded to the application.,T1574.002,Hijack Execution Flow: DLL Side-Loading
to a side-loading vulnerability that,T1574.002,Hijack Execution Flow: DLL Side-Loading
"We’ve seen the payload delivered in diverse ways including DLL side-loading,",T1574.002,Hijack Execution Flow: DLL Side-Loading
abuse legitimate applications vulnerable to DLL side-loading attack.,T1574.002,Hijack Execution Flow: DLL Side-Loading
DLL Side-Loading,T1574.002,Hijack Execution Flow: DLL Side-Loading
"A benign, legitimate executable abused to side-load the malicious DLL",T1574.002,Hijack Execution Flow: DLL Side-Loading
The malicious side loaded DLL,T1574.002,Hijack Execution Flow: DLL Side-Loading
WDSyncService.exe executable abused to side-load a malicious DLL ,T1574.002,Hijack Execution Flow: DLL Side-Loading
Side loaded malicious DLL ,T1574.002,Hijack Execution Flow: DLL Side-Loading
abused to side-load the malicious DLL.,T1574.002,Hijack Execution Flow: DLL Side-Loading
executable abused to side-load malicious DLL ,T1574.002,Hijack Execution Flow: DLL Side-Loading
DLL Side-Loading,T1574.002,Hijack Execution Flow: DLL Side-Loading
DLL Side-Loading,T1574.002,Hijack Execution Flow: DLL Side-Loading
that is abused to side-load a malicious DLL,T1574.002,Hijack Execution Flow: DLL Side-Loading
executable that dropped a legitimate WD Discovery app to side-load the malicious WDLocal.dll,T1574.002,Hijack Execution Flow: DLL Side-Loading
side-loads malicious WDLocal.dll The side-loaded DLL,T1574.002,Hijack Execution Flow: DLL Side-Loading
DLL side-loading is a highly effective technique for tricking Windows systems into loading malicious code.,T1574.002,Hijack Execution Flow: DLL Side-Loading
Adversaries use side-loading attacks for execution,T1574.002,Hijack Execution Flow: DLL Side-Loading
"Once the executable starts running, it side-loads the malicious DLL",T1574.002,Hijack Execution Flow: DLL Side-Loading
to lure victims into downloading a malicious file,T1204.002,User Execution: Malicious File
"designed to steal sensitive information, including login data, cookies, and Facebook ad and business account information.",T1005,Data from Local System
"The scripts are encoded using different techniques,",T1027,Obfuscated Files or Information
(base64 encoded with string replacements),T1027,Obfuscated Files or Information
uses are compressed and encrypted,T1027,Obfuscated Files or Information
Base64 encoded string with several string replacements.,T1027,Obfuscated Files or Information
self-written extensions that obfuscate the PHP scripts.,T1027,Obfuscated Files or Information
And malicious payloads are also sometimes encrypted/packed or obfuscated,T1027,Obfuscated Files or Information
obfuscated with SmartAssembly,T1027,Obfuscated Files or Information
base64 encoded with some string modifications,T1027,Obfuscated Files or Information
"it downloads the file from its command and control (C2) server,",T1105,Ingress Tool Transfer
they’re downloaded from the C2,T1105,Ingress Tool Transfer
"executes, it drops a PHP application with additional files",T1105,Ingress Tool Transfer
Download and run,T1105,Ingress Tool Transfer
Downloads a file from the given URL and executes it with the given arguments.,T1105,Ingress Tool Transfer
the given task the downloaded file,T1105,Ingress Tool Transfer
the new stealer is downloaded and executed,T1105,Ingress Tool Transfer
  Upload file function ,T1105,Ingress Tool Transfer
then decodes and executes it.,T1140,Deobfuscate/Decode Files or Information
"In the main thread the SFX/ZIP file is executed/decompressed,",T1140,Deobfuscate/Decode Files or Information
DLL that decodes and drops three files,T1140,Deobfuscate/Decode Files or Information
It starts with de-obfuscating the next stage (string replacements + base64 decoding),T1140,Deobfuscate/Decode Files or Information
"Once decoded, this executable, written in Rust and compiled with Cargo, gets the current date and time, and decrypts Chromium-based browsers’ encryption key ",T1140,Deobfuscate/Decode Files or Information
It does this by decoding the rss.txt into an executable,T1140,Deobfuscate/Decode Files or Information
the executable decodes and drops the next stage,T1140,Deobfuscate/Decode Files or Information
it creates a scheduled task that runs the Rust executable by passing it as an argument to rhc.exe.,T1053.005,Scheduled Task/Job: Scheduled Task
registers a new scheduled task to trigger every day and repeat every hour with option “d” as an argument.,T1053.005,Scheduled Task/Job: Scheduled Task
Creates a scheduled task to be executed with d as an argument ,T1053.005,Scheduled Task/Job: Scheduled Task
Responsible for installing persistence via scheduled tasks,T1053.005,Scheduled Task/Job: Scheduled Task
The attacker must know the time to set it in the scheduled task.,T1053.005,Scheduled Task/Job: Scheduled Task
createTS—creates scheduled task. createLG—creates scheduled task at logon ,T1053.005,Scheduled Task/Job: Scheduled Task
"it creates a scheduled task that executes the updated routine, which triggers at log-on and every 30 minutes.",T1053.005,Scheduled Task/Job: Scheduled Task
registers two scheduled tasks:,T1053.005,Scheduled Task/Job: Scheduled Task
embeds legitimate DLLs using the SmartAssembly feature ,T1027,Obfuscated Files or Information
"Once the execution completes, the file is deleted to leave no evidence on the machine.",T1070.004,Indicator Removal: File Deletion
the file is deleted to remove evidence from the machine.,T1070.004,Indicator Removal: File Deletion
passes this command line as an argument,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"Gets a command to run, executes it",T1059.003,Command and Scripting Interpreter: Windows Command Shell
 Gets command from C2 and executes it ,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Executable that accepts an executable as an argument and executes it with hidden console,T1059.003,Command and Scripting Interpreter: Windows Command Shell
“wmic os get LocalDateTime /value”.,T1047,Windows Management Instrumentation
to steal the victim’s Facebook information and send it back to the C2.,T1041,Exfiltration Over C2 Channel
Extract victim’s sensitive Facebook data using the graph API and send the results to a C2 server ,T1041,Exfiltration Over C2 Channel
The malware can extract this information and send it to its command and control (C2) server,T1041,Exfiltration Over C2 Channel
API functions.,T1106,Native API
API calls,T1106,Native API
the API calls,T1106,Native API
calls point to a suspicious API,T1106,Native API
"creation functions like NtCreateUserProcess, NtCreateProcessEx, CreateProcessInternalW, CreateProcessA or CreateProcessW.",T1106,Native API
an exported function from one of the Windows libraries,T1106,Native API
suspicious APIs often used in code injection techniques like CreateRemoteThread or NtSetContextThread.,T1106,Native API
frequently called API function,T1106,Native API
critical APIs,T1106,Native API
Microsoft Outlook Messaging API (MAPI) module,T1106,Native API
process creation library functions,T1106,Native API
calls the NtProtectVirtualMemory function where the NewAccessProtection argument is PAGE_EXECUTE_READWRITE and the BaseAddress argument is an address to a library function,T1106,Native API
uses a variation of AtomBombing that queues an APC to call memset to clean an RW region in ntdll.dll.,T1055,Process Injection
dispatch an asynchronous procedure call (APC) to the APC queue of a target process thread using NtQueueApcThread,T1055,Process Injection
the injector process dispatches another APC using NtQueueApcThread to force the remote process to execute NtSetContextThread.,T1055,Process Injection
it queues an APC into the patched GlobalGetAtomA to get the payload running.,T1055,Process Injection
"APC routine argument in the case of NtQueueApcThread,",T1055,Process Injection
"AtomBombing is the write-primitive, which allows writing to the remote process using atom tables and APC.",T1055,Process Injection
AtomBombing Injection Technique,T1055,Process Injection
AtomBombing is a technique that allows malware to inject code while avoiding calling suspicious APIs,T1055,Process Injection
"Malware using the AtomBombing technique first writes the payload into the global atom table, which can be accessed by all processes.",T1055,Process Injection
uses a slightly modified AtomBombing technique that injects one of its stages into a Windows process,T1055,Process Injection
the malware can read HTTP-POST headers,T1071.001,Application Layer Protocol: Web Protocols
injects the main bot into svchost.exe.,T1055,Process Injection
Injected Processes,T1055,Process Injection
Process Injection via Hooking,T1055,Process Injection
use this technique to inject themselves into other processes,T1055,Process Injection
"they inject their main bot into a Windows process, and then inject their other modules into different processes according to the module’s purpose",T1055,Process Injection
an injection into a web browser process.,T1055,Process Injection
injected thread,T1055,Process Injection
they suspend the remote process threads,T1055,Process Injection
The injected process,T1055,Process Injection
goes through processes one by one,T1057,Process Discovery
used to steal victims’ sensitive data.,T1005,Data from Local System
injects its main bot into a hollowed instance of svchost.exe,T1055,Process Injection
"implemented process hollowing by first using VirtualProtectEx on the process entrypoint, and then writing the hook stub using WriteProcessMemory.",T1055,Process Injection
"Process hollowing is a process injection technique that creates a new legitimate process in a suspended mode, unmaps its main image and replaces it with malicious code.",T1055,Process Injection
The malicious code is written into the newly created process and the suspended thread context instruction pointer is changed using NtGetContextThread/NtSetContextThread.,T1055,Process Injection
for process hollowing from a WoW64 process into a 64-bit svchost.exe,T1055,Process Injection
Evasive Process Hollowing By Entrypoint Patching,T1055,Process Injection
Evasive Process,T1055,Process Injection
Evasive Process Hollowing by Entrypoint Patching,T1055,Process Injection
Decompresses a local buffer,T1140,Deobfuscate/Decode Files or Information
Common injection methods used by banking Trojans involve writing a mapped PE into a remote process using WriteProcessMemory,T1055,Process Injection
"obscure the call by wiping artifacts from the buffer, such as wiping the PE header.",T1027,Obfuscated Files or Information
malware disguised as Hancom Office document files.,T1036.005,Masquerading: Match Legitimate Name or Location
“Who and What Threatens the World (Column).exe” and is designed to deceive users by using an icon that is similar to that of Hancom Office.,T1036.005,Masquerading: Match Legitimate Name or Location
creating a folder named onedrivenew in the AppData directory and self-copying itself with the filename onedrivenew.exe to appear as a normal file.,T1036.005,Masquerading: Match Legitimate Name or Location
malware creating and executing a normal Hancom Office file with the same filename as the malware within the same directory where the malware was executed.,T1036.005,Masquerading: Match Legitimate Name or Location
connect to a certain URL every 60 minutes using the normal Windows file mshta.exe.,T1036.005,Masquerading: Match Legitimate Name or Location
URL registered in the task scheduler appears to be a normal homepage,T1036.005,Masquerading: Match Legitimate Name or Location
Decompressing the compressed file,T1027,Obfuscated Files or Information
Decompressing,T1140,Deobfuscate/Decode Files or Information
injected and executed within the normal Windows process called mstsc.exe.,T1055,Process Injection
of mstsc.exe being executed after being injected with malware,T1055,Process Injection
deleted using the cmd command.,T1070.004,Indicator Removal: File Deletion
registers its file with the name onedrivenew under the Run key,T1112,Modify Registry
registers its file with the name onedrivenew under the Run key in order to make it run after the system is rebooted.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
schtasks.exe command to register the file to the task scheduler with,T1053.005,Scheduled Task/Job: Scheduled Task
URL registered in the task scheduler,T1053.005,Scheduled Task/Job: Scheduled Task
connect to a certain URL every 60 minutes using the normal Windows file mshta.exe.,T1071.001,Application Layer Protocol: Web Protocols
using an obfuscated Meterpreter stager,T1027,Obfuscated Files or Information
One of the techniques to conceal the traffic from DNS-based filtering is Domain Fronting.,T1090,Proxy
Domain fronting uses legitimate or high-reputation domains to remain undetected by defenders.,T1090,Proxy
domains for domain fronting may indicate an interest in the geopolitics of this area of the world.,T1090,Proxy
the domain fronting functionality before launching the attack.,T1090,Proxy
"The actor in this campaign has used domain fronting, which is a technique which can use high reputation domains to conceal the Cobalt Strike command and control traffic.",T1090,Proxy
Domain fronting can be achieved with a redirect between the malicious server and the target.,T1090,Proxy
actors may misuse various content delivery networks (CDNs) to set up redirects of serving content to the content served by attacker-controlled C2 hosts.,T1090,Proxy
The beacons are of particular interest due to the domain fronting technique using a government host as the initial DNS lure.,T1090,Proxy
The DNS request for the initial host resolves to a Cloudflare-owned IP address that allows the attacker to employ domain fronting and send the traffic to the actual C2 host,T1090,Proxy
Domain fronting is a technique used by attackers to circumvent protection based on DNS filtering.,T1090,Proxy
modify the subsequent HTTPs requests header to instruct the CDN to direct the traffic to an attacker-controlled host.,T1090,Proxy
The threat actor in this case uses domain fronting with the Cloudflare Content Delivery Network,T1090,Proxy
.]net via HTTP Get and POST metadata specified in the beacon's configuration.,T1071.001,Application Layer Protocol: Web Protocols
"relies on other parts of the HTTP request, including the Host header and the actual C2",T1071.001,Application Layer Protocol: Web Protocols
suspicious section .kxrt with the packed and encoded malicious code.,T1027,Obfuscated Files or Information
decryption routine is executed that decrypts the remaining malicious code in the .kxrt section and writes it to the virtual memory.,T1140,Deobfuscate/Decode Files or Information
Decoder routine to decrypt the beacon DLL.,T1140,Deobfuscate/Decode Files or Information
The decrypted malicious code,T1140,Deobfuscate/Decode Files or Information
"Once decoded, the loader's execution jumps to the beginning of the DLL",T1140,Deobfuscate/Decode Files or Information
now responsible for decoding the configuration.,T1140,Deobfuscate/Decode Files or Information
by calling WinHTTPGetProxyForUrlEx and WinHTTPCreateProxyResolver,T1106,Native API
calls the VirtualProtect function,T1106,Native API
modifies the victim's system power and lid open/close policies in the registry.,T1112,Modify Registry
can also manage the system power policies registry keys to set the minimum and maximum sleep times and the lid open and close action policy.,T1112,Modify Registry
routed through European TOR VPN exit nodes.,T1090,Proxy
VPN access using Single Factor authentication.,T1078,Valid Accounts
Minidump of LSASS process memory,T1003.001,OS Credential Dumping: LSASS Memory
The minidump function of comsvcs.dll can be used to dump lsass.exe.,T1003.001,OS Credential Dumping: LSASS Memory
leveraging comsvcs.dll with proxy execution by rundll32.exe.,T1218.011,System Binary Proxy Execution: Rundll32
"do rundll32.exe C:\windows\System32\comsvcs.dll,",T1218.011,System Binary Proxy Execution: Rundll32
Conducting discovery indirectly via schedule tasks named “Windows Update”,T1053.005,Scheduled Task/Job: Scheduled Task
performing remote directory listings.,T1083,File and Directory Discovery
to discover interesting to them directories,T1083,File and Directory Discovery
"Leveraging a dual-use tool, PCHunter64, to acquire detailed process and system information.",T1082,System Information Discovery
Threat actors can use windows binaries and commands,T1059.003,Command and Scripting Interpreter: Windows Command Shell
RDP connection established,T1021.001,Remote Services: Remote Desktop Protocol
"Remote Desktop Protocol (RDP), and the threat actor was able to move freely across the network",T1021.001,Remote Services: Remote Desktop Protocol
the threat actor was able to RDP unencumbered across the organization’s infrastructure.,T1021.001,Remote Services: Remote Desktop Protocol
The threat actor executed two actions to bypass Windows Defender,T1562.001,Impair Defenses: Disable or Modify Tools
"the threat actor leveraged one of the most popular dual-use agents, AnyDesk, to provide persistent remote access into the affected organization on multiple systems.",T1219,Remote Access Software
"several files were staged for possible, but unconfirmed exfiltration",T1074.001,Data Staged: Local Data Staging
spear phishing emails that contain a .csv or .xlt file attachment,T1566.001,Phishing: Spearphishing Attachment
The email is directed to “Non-Resident Alien” tax payers to have them fill out a PDF file (that is attached to the email),T1566.001,Phishing: Spearphishing Attachment
"a cyber-attack in the form of credential stuffing,",T1110,Brute Force
Enduring Credential Stuffing,T1110,Brute Force
using login credentials from what the company suspects are past data breaches from other companies,T1110,Brute Force
replace the “ServiceManager.exe” file from the driver folder with a malicious file to trick the driver into running the tainted file,T1036.005,Masquerading: Match Legitimate Name or Location
log keystrokes,T1056.001,Input Capture: Keylogging
a vulnerability in unencrypted Wi-Fi routers that makes them susceptible to a TCP exploit.,T1210,Exploitation of Remote Services
"A threat actor could take advantage of this vulnerability by creating a specific file that contains data that is stored in the JET database format, and having the targeted user open it, which would then allow for remote code execution at the level of the current process",T1210,Exploitation of Remote Services
"This vulnerability, registered as “CVE-2018-14327,” allows a low-privileged user account to escalate privileges on any Windows machine that had connected to the EE Mini modem via USB.",T1068,Exploitation for Privilege Escalation
decrypts that specific payload code,T1140,Deobfuscate/Decode Files or Information
A threat actor could establish an administrator session,T1078,Valid Accounts
a payload download code that grabs malware to download and install the backdoor.,T1105,Ingress Tool Transfer
then sign on as a legitimate user,T1078,Valid Accounts
decrypting database passwords from Windows registry values,T1140,Deobfuscate/Decode Files or Information
decrypting them from Windows registry values,T1140,Deobfuscate/Decode Files or Information
decrypt the more sensitive data in the user’s database.,T1140,Deobfuscate/Decode Files or Information
"decrypt these database passwords,",T1140,Deobfuscate/Decode Files or Information
decryption,T1140,Deobfuscate/Decode Files or Information
decryption,T1140,Deobfuscate/Decode Files or Information
decrypts the password,T1140,Deobfuscate/Decode Files or Information
decrypted dba user password.,T1140,Deobfuscate/Decode Files or Information
decrypts this payload,T1140,Deobfuscate/Decode Files or Information
decrypting the appropriate loader,T1140,Deobfuscate/Decode Files or Information
decryption,T1140,Deobfuscate/Decode Files or Information
decrypts the payload,T1140,Deobfuscate/Decode Files or Information
decrypting them,T1140,Deobfuscate/Decode Files or Information
gather database passwords,T1005,Data from Local System
steal database passwords and configuration information,T1005,Data from Local System
steal credentials by decrypting them from registry values.,T1005,Data from Local System
Exfiltrated credentials,T1078,Valid Accounts
decrypt these database passwords,T1078,Valid Accounts
decrypts the password for the dba username,T1078,Valid Accounts
decrypted dba user password.,T1078,Valid Accounts
successfully obtain the database passwords,T1078,Valid Accounts
steal credentials by decrypting them from registry values,T1078,Valid Accounts
the encryption key for sensitive data,T1027,Obfuscated Files or Information
encrypted,T1027,Obfuscated Files or Information
encryption,T1027,Obfuscated Files or Information
encryption,T1027,Obfuscated Files or Information
XORed with the value,T1027,Obfuscated Files or Information
encrypted using its own XOR key,T1027,Obfuscated Files or Information
encrypted payload,T1027,Obfuscated Files or Information
write module to the encrypted storage,T1027,Obfuscated Files or Information
"unpacks and loads the next stage of the malware, namely the main module",T1027,Obfuscated Files or Information
unpacking the main module and,T1027,Obfuscated Files or Information
handles communication between the modules and attacker’s C&C server.,T1041,Exfiltration Over C2 Channel
"0x10000013data for C&C server (execution logs, stolen data, …)",T1041,Exfiltration Over C2 Channel
upload data to C&C,T1041,Exfiltration Over C2 Channel
exfiltrates data over its C&C channel.,T1041,Exfiltration Over C2 Channel
acquire a list of the running processes and their loaded modules,T1057,Process Discovery
"collect information about currently running processes, including: name, process identifier (PID), parent process PID, number of threads, token owner, token domain, process creation time, and command line",T1057,Process Discovery
collect information about loaded modules for each of the running processes,T1057,Process Discovery
0x10000025get handle of the process with specified PID,T1057,Process Discovery
enumerates running processes,T1057,Process Discovery
get information about processes running on a system,T1057,Process Discovery
stored in DataS5 (for dba) and DataS6 (for micros) registry values within one of the following registry keys,T1112,Modify Registry
Windows registry Run key,T1112,Modify Registry
GetComputerName API,T1106,Native API
GetTickCount Windows API,T1106,Native API
PeekNamedPipe Windows API function,T1106,Native API
information about specific registry keys,T1012,Query Registry
"queries the Registry for ORACLE MICROS RES 3700 POS version, database passwords and other configuration data",T1012,Query Registry
is injected into one of the processes specified by the C&C,T1055,Process Injection
module is injected into one of the processes specified by the C&C,T1055,Process Injection
is injected only into processes running under WOW64.,T1055,Process Injection
its injection into one of the following processes,T1055,Process Injection
0x10000012inject and execute received module in specified process,T1055,Process Injection
"injected first,",T1055,Process Injection
inject a networking module,T1055,Process Injection
inject processes that are expected to communicate over the network,T1055,Process Injection
0x0AInject and execute received module in specified process,T1055,Process Injection
0x0BInject and execute received module in specified process,T1055,Process Injection
inject and execute received module in specified process,T1055,Process Injection
scanning selected IP addresses,T1016,System Network Configuration Discovery
scan specific IP addresses,T1016,System Network Configuration Discovery
IP addresses intended for scanning and the special “ping” IP address,T1016,System Network Configuration Discovery
scanning IPs specified in the command data to collect additional information about the environment,T1016,System Network Configuration Discovery
scan of the selected IP addresses,T1016,System Network Configuration Discovery
downloaded from the C&C along with the ModScan module,T1105,Ingress Tool Transfer
parsing payload received in the C&C responses,T1105,Ingress Tool Transfer
download additional payloads and C&C commands,T1105,Ingress Tool Transfer
TCP ports 50123,T1095,Non-Application Layer Protocol
and 2638,T1095,Non-Application Layer Protocol
by sending a specially crafted TCP packet,T1095,Non-Application Layer Protocol
sends a hardcoded TDS 4.2 & 5.0 Login Packet (Figure 6) to the specified IP address on port 2638,T1095,Non-Application Layer Protocol
"transmitted using the lightweight networking module,",T1095,Non-Application Layer Protocol
Version of the Oracle,T1082,System Information Discovery
information about the database server and the TDS versions used,T1082,System Information Discovery
sending an HTTP Post message,T1071.001,Application Layer Protocol: Web Protocols
module uses HTTP and port 80.,T1071.001,Application Layer Protocol: Web Protocols
avoid system processes that might attract attention if caught communicating over the network,T1071.001,Application Layer Protocol: Web Protocols
HTTP POST or GET methods,T1071.001,Application Layer Protocol: Web Protocols
uses HTTP for command and control,T1071.001,Application Layer Protocol: Web Protocols
stored between data xml tags (<data>%version%</data>) of the response from the service,T1027,Obfuscated Files or Information
"encrypted payload, containing the main functionality of the dropper, is stored in the dropper’s resources as bitmaps named from A to L.",T1027,Obfuscated Files or Information
being the payloads stored in the resources,T1027,Obfuscated Files or Information
encrypted within the main module’s code.,T1027,Obfuscated Files or Information
"with username set to the built-in dba and a hardcoded password, which is potentially the default password in some RES 3700 POS versions.",T1078,Valid Accounts
"hash of the dropped loader to change with each execution,",T1027,Obfuscated Files or Information
creating a Windows service,T1543.003,Create or Modify System Process: Windows Service
create a new service for persistence.,T1543.003,Create or Modify System Process: Windows Service
"Decompiled code responsible for loading the payload from the binary’s resources,",T1027,Obfuscated Files or Information
Communication with the C&C is encrypted using AES in CBC mode,T1573.001,Encrypted Channel: Symmetric Cryptography
XORed with the first 4 bytes of the AES key used to encrypt the message.,T1573.001,Encrypted Channel: Symmetric Cryptography
encrypts communication with C&C using AES in CBC mode,T1573.001,Encrypted Channel: Symmetric Cryptography
using Windows Command Shell to execute the initial dropper.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
use Registry Run key for persistence,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
inject it’s modules into various processes.,T1055,Process Injection
gathers username and computer name from victim machines and reports them to the C&C in initial message.,T1033,System Owner/User Discovery
The attack revolves around a DLL sideloading,T1574.002,Hijack Execution Flow: DLL Side-Loading
"DLL sideloading scenario, the malicious loader (ffmpeg.dll) would replace the clean dependency;",T1574.002,Hijack Execution Flow: DLL Side-Loading
DLL sideloading,T1574.002,Hijack Execution Flow: DLL Side-Loading
DLL sideloading,T1574.002,Hijack Execution Flow: DLL Side-Loading
encoded malware,T1027,Obfuscated Files or Information
encrypted payload,T1027,Obfuscated Files or Information
malicious encoded .ico payload,T1027,Obfuscated Files or Information
generate the HTTP request,T1071.001,Application Layer Protocol: Web Protocols
these appear to be maliciously patched versions of the legitimate ffmpeg.dll,T1036.005,Masquerading: Match Legitimate Name or Location
GetSystemTimeAsFileTime Api call,T1106,Native API
which initiates the payload download,T1105,Ingress Tool Transfer
malware tries to login and get access to the victim server via brute force.,T1110,Brute Force
tries to get access to the server via brute force,T1110,Brute Force
malware samples are packed with UPX Packer.,T1027,Obfuscated Files or Information
Upon unpacking a sample,T1027,Obfuscated Files or Information
"the malware uses a set of credentials that is hard coded into the malware binary,",T1110,Brute Force
Hard-coded credentials for brute forcing.,T1110,Brute Force
from the decrypted configuration,T1140,Deobfuscate/Decode Files or Information
"The malware then de-XORs other strings, with the hard-coded key",T1140,Deobfuscate/Decode Files or Information
Most of the strings are de-XOR’d in a function,T1140,Deobfuscate/Decode Files or Information
simply de-XOR the entire binary,T1140,Deobfuscate/Decode Files or Information
"Also the de-XOR’d strings,",T1140,Deobfuscate/Decode Files or Information
"Once the malware has de-XOR’d all its strings, it invokes a method named go.",T1140,Deobfuscate/Decode Files or Information
we find an XOR loop that decrypts this configuration.,T1140,Deobfuscate/Decode Files or Information
as a hard-coded XOR key,T1027,Obfuscated Files or Information
we find an XOR loop,T1027,Obfuscated Files or Information
This produces strings including a commandline usage:,T1059.003,Command and Scripting Interpreter: Windows Command Shell
can be set via the command-line as well.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
This parses command-line options,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the data will be published on our TOR darknet sites.,T1090,Proxy
--remove       self remove this file after work,T1070.004,Indicator Removal: File Deletion
"this snippet of code invokes ptrace with PT_DENY_ATTACH (0x1f) which will kill the process if a debugger is currently attached,",T1055,Process Injection
the embedded .NET injector and PE payload(s).,T1027,Obfuscated Files or Information
embedded payloads of one of the IronPython scripts.,T1027,Obfuscated Files or Information
the main task of loading malware is done by an embedded process injector.,T1027,Obfuscated Files or Information
IronNetInjector is made of an IronPython script that contains a .NET injector and one or more payloads.,T1027,Obfuscated Files or Information
Contain an encrypted .NET injector and one or more encrypted PE payloads.,T1027,Obfuscated Files or Information
Embedded .NET injector and payload(s) are encoded with Base64 and encrypted with Rijndael.,T1027,Obfuscated Files or Information
script with embedded .NET injector and ComRAT payload,T1027,Obfuscated Files or Information
"the embedded payloads in the IronPython scripts,",T1027,Obfuscated Files or Information
embedded malware:,T1027,Obfuscated Files or Information
the embedded files in the scripts,T1027,Obfuscated Files or Information
These scripts contain an embedded PE loader to execute an embedded malware payload.,T1027,Obfuscated Files or Information
the embedded .NET injector,T1027,Obfuscated Files or Information
which in turn injects the payload(s) into its own or a remote process.,T1055,Process Injection
contains the ability to inject .NET assemblies into unmanaged processes.,T1055,Process Injection
the payload is either loaded into its own process or a remote one.,T1055,Process Injection
remote process the payload gets injected to.,T1055,Process Injection
the second option is used with the PID of explorer.exe to load the ComRAT payload reflectively into the process.,T1055,Process Injection
the injector is its ability to load an assembly into an unmanaged process.,T1055,Process Injection
to load an assembly into an unmanaged process.,T1055,Process Injection
The method InjectAssembly is used to inject a .NET assembly into a native process,T1055,Process Injection
Function and variable names are obfuscated,T1027,Obfuscated Files or Information
Strings are encrypted,T1027,Obfuscated Files or Information
scripts are obfuscated to prevent easy detection.,T1027,Obfuscated Files or Information
Decoded IronPython script,T1140,Deobfuscate/Decode Files or Information
the Rijndael decryption key is passed.,T1140,Deobfuscate/Decode Files or Information
get decoded and decrypted,T1140,Deobfuscate/Decode Files or Information
The decryption key is passed as an argument,T1140,Deobfuscate/Decode Files or Information
full-blown PE injection tools able to load a native x86/64 payload reflectively into a remote process.,T1055,Process Injection
PowerShell Empire’s ReflectivePEInjection script,T1055,Process Injection
The method Invoke is used to inject a native PE into a remote process and InvokeVoid to call any exported function of the injected payload.,T1055,Process Injection
As a command line argument,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Windows task XML file,T1053.005,Scheduled Task/Job: Scheduled Task
The task is used to start an IronPython script,T1053.005,Scheduled Task/Job: Scheduled Task
The task’s description is PythonUpdateSrvc and it runs either on Windows startup when a user logs in or when one of two system events get created:,T1053.005,Scheduled Task/Job: Scheduled Task
the Windows task XML,T1053.005,Scheduled Task/Job: Scheduled Task
The task file is then used to create a task which in turn starts a script when triggered.,T1053.005,Scheduled Task/Job: Scheduled Task
a Windows task XML to start,T1053.005,Scheduled Task/Job: Scheduled Task
the submitter collected the files from different places,T1005,Data from Local System
"This is accomplished with a native bootstrapper DLL, which gets injected into the remote process and prepares it so a .NET assembly can be injected afterwards.",T1055,Process Injection
DLL gets injected,T1055,Process Injection
The output is then parsed to the targeted process ID with the help of tasklist filters.,T1057,Process Discovery
Contains the imported unmanaged function declarations and win32 structures/constants.,T1106,Native API
being able to use the .NET framework APIs directly from Python.,T1106,Native API
can use .NET framework APIs,T1106,Native API
use of the .NET framework APIs,T1106,Native API
when .NET framework APIs are used in the code,T1106,Native API
use of WMI to both store and persist the backdoor,T1047,Windows Management Instrumentation
Windows Management Instrumentation (WMI).,T1047,Windows Management Instrumentation
"to use WMI for storage and
persistence.",T1047,Windows Management Instrumentation
"WMI provides many administrative capabilities
on local and remote systems, including querying system information,
starting and stopping processes, and setting conditional triggers.",T1047,Windows Management Instrumentation
"WMI
can be accessed using a variety of tools, including the Windows WMI
Command-line (wmic.exe), or through APIs accessible to programming and
scripting languages such as PowerShell.",T1047,Windows Management Instrumentation
"WMI permanent event subscriptions can be used to trigger actions
when specified conditions are met.",T1047,Windows Management Instrumentation
"Subscriptions consist of three core WMI classes: a Filter, a
Consumer, and a FilterToConsumerBinding.",T1047,Windows Management Instrumentation
"WMI Consumers specify an
action to be performed, including executing a command, running a
script, adding an entry to a log, or sending an email",T1047,Windows Management Instrumentation
Creating a WMI permanent event subscription,T1047,Windows Management Instrumentation
"WMI Filters
define conditions that will trigger a Consumer, including system
startup, the execution of a program,",T1047,Windows Management Instrumentation
"then created a WMI event subscription in order to execute the
backdoor",T1047,Windows Management Instrumentation
"use WMI to persist a backdoor and also store
the PowerShell backdoor code.",T1047,Windows Management Instrumentation
"created a new
WMI class and added a text property to it in order to store a string
value.",T1047,Windows Management Instrumentation
"The WMI component of the POSHSPY backdoor leverages a Filter to
execute the PowerShell component of the backdoor on a regular basis.",T1047,Windows Management Instrumentation
WMI Component,T1047,Windows Management Instrumentation
"“BfeOnServiceStartTypeChange” WMI
Query Language (WQL) filter condition
The BfeOnServiceStartTypeChange Filter was
bound to the CommandLineEventConsumer WindowsParentalControlsMigration.",T1047,Windows Management Instrumentation
legitimate WMI persistence,T1047,Windows Management Instrumentation
attacker use of WMI,T1047,Windows Management Instrumentation
WMI persistence.,T1047,Windows Management Instrumentation
"decrypted, and executed the backdoor code",T1140,Deobfuscate/Decode Files or Information
Decoded CommandLineTemplate PowerShell code,T1140,Deobfuscate/Decode Files or Information
"wrote the encrypted and base64-encoded PowerShell
backdoor code",T1027,Obfuscated Files or Information
base64-encoded PowerShell command.,T1027,Obfuscated Files or Information
executing PowerShell code as an EncodedCommand,T1027,Obfuscated Files or Information
"to download and execute additional
PowerShell code and Windows binaries",T1105,Ingress Tool Transfer
Downloading and executing PowerShell code,T1105,Ingress Tool Transfer
Encrypting communications using AES and RSA public key cryptography,T1573.001,Encrypted Channel: Symmetric Cryptography
"Writing executables to a randomly-selected directory under Program Files, and naming the EXE to match the
chosen directory name",T1036.005,Masquerading: Match Legitimate Name or Location
"Appending a file signature header to all encrypted data,",T1027,Obfuscated Files or Information
"appended file
headers used to bypass content inspection made this backdoor difficult
to identify",T1027,Obfuscated Files or Information
Word document lure requesting the user to run the VBA macro.,T1204.002,User Execution: Malicious File
"When opened, the user sees a social engineering image telling them that they must click the “Enable editing” button to see the document’s contents.",T1204.002,User Execution: Malicious File
Packed DLL analysis,T1027,Obfuscated Files or Information
packing being used to obfuscate the malware.,T1027,Obfuscated Files or Information
there is indeed some sort of unpacking happening.,T1027,Obfuscated Files or Information
Although the unpacking procedure happens in multiple steps,T1027,Obfuscated Files or Information
As soon as the unpacked executable is running,T1027,Obfuscated Files or Information
An Examination of its Unpacking Routine,T1027,Obfuscated Files or Information
its unpacking routine,T1027,Obfuscated Files or Information
"Once the “.tmp” file is found, it is moved and renamed to the Office templates folder",T1036.005,Masquerading: Match Legitimate Name or Location
loaded using rundll32.exe.,T1218.011,System Binary Proxy Execution: Rundll32
"As a second argument, the macro passes the entry function “DllUnregisterServer” to rundll32.exe so that the execution starts correctly.",T1218.011,System Binary Proxy Execution: Rundll32
runs rundll32.exe to load the malware.,T1218.011,System Binary Proxy Execution: Rundll32
executes it using rundll32.exe,T1218.011,System Binary Proxy Execution: Rundll32
Looking at the decrypted data,T1140,Deobfuscate/Decode Files or Information
the decryption process starts,T1140,Deobfuscate/Decode Files or Information
data that will be decrypted,T1140,Deobfuscate/Decode Files or Information
The algorithm to decrypt the data is simple.,T1140,Deobfuscate/Decode Files or Information
the second decryption stage occurs,T1140,Deobfuscate/Decode Files or Information
the decrypted memory structure,T1140,Deobfuscate/Decode Files or Information
Before the decryption starts,T1140,Deobfuscate/Decode Files or Information
contains the decryption algorithm for the second stage,T1140,Deobfuscate/Decode Files or Information
The output of this decryption,T1140,Deobfuscate/Decode Files or Information
The decryption algorithm,T1140,Deobfuscate/Decode Files or Information
the executable code used to decrypt the encrypted data,T1140,Deobfuscate/Decode Files or Information
After successfully decrypting the C2 URLs,T1140,Deobfuscate/Decode Files or Information
all the decrypted C2 URLs,T1140,Deobfuscate/Decode Files or Information
the malware calls a decryption function,T1140,Deobfuscate/Decode Files or Information
"Although the decoding algorithm of the C2 response looks quite complex, it is actually Base64 decoding, followed by an XOR operation using the key 0x7A.",T1140,Deobfuscate/Decode Files or Information
decryption function.,T1140,Deobfuscate/Decode Files or Information
can be decrypted to an active malware download server,T1140,Deobfuscate/Decode Files or Information
The API function located at the beginning of the memory section are resolved using GetProcAddress,T1106,Native API
Windows API functions,T1106,Native API
Windows API functions,T1106,Native API
After resolving the functions,T1027,Obfuscated Files or Information
The names of Windows API functions are stored in the first 150 bytes,T1027,Obfuscated Files or Information
several Windows API functions are resolved using GetProcAddress,T1027,Obfuscated Files or Information
memory structure contains executable code.,T1027,Obfuscated Files or Information
Data view of the section containing the encrypted malware.,T1027,Obfuscated Files or Information
The area after this contains encrypted data.,T1027,Obfuscated Files or Information
Structure of the encrypted section.,T1027,Obfuscated Files or Information
encrypted URLs contained in the malware itself.,T1027,Obfuscated Files or Information
the encrypted data,T1027,Obfuscated Files or Information
This technique is called self-injection or PE overwrite,T1055,Process Injection
"This function obtains the username,",T1033,System Owner/User Discovery
the computer name and the domain of infected system.,T1082,System Information Discovery
the computer architecture,T1082,System Information Discovery
generated based on the computer architecture.,T1082,System Information Discovery
The subsequent functions collect additional information such as the machine’s public IP address,T1016,System Network Configuration Discovery
"To determine the command and control (C2) servers waiting for the data to be sent to, the malware calls a decryption function that uses the RC4 algorithm",T1573.001,Encrypted Channel: Symmetric Cryptography
"After successfully decrypting the C2 URLs, the data is sent there using a HTTP POST request adding the constructed query string as data",T1071.001,Application Layer Protocol: Web Protocols
making a HTTP GET request,T1071.001,Application Layer Protocol: Web Protocols
"the malware initiates a download, which delivers an executable",T1105,Ingress Tool Transfer
Its main purpose is to download and execute a second stage malware payload,T1105,Ingress Tool Transfer
Thread Execution Hijacking,T1055,Process Injection
Thread Execution Hijacking,T1055,Process Injection
The final execution method Hancitor supports is Thread Execution Hijacking.,T1055,Process Injection
The only difference is that the malware replaces the thread context with the downloaded executable and resumes it afterwards.,T1055,Process Injection
Process Hollowing,T1055,Process Injection
Process Hollowing,T1055,Process Injection
"If the Process Hollowing method is used, a new svchost.exe process is created in a suspended state.",T1055,Process Injection
"The malware then allocates new memory in the newly-created process, writes the executable to it and executes it in a new thread.",T1055,Process Injection
Process Injection method,T1055,Process Injection
the malware was distributed as email Word document attachments,T1566.001,Phishing: Spearphishing Attachment
then recursively searches through all local temp folders.,T1083,File and Directory Discovery
Query string containing system information before being sent to the C2.,T1041,Exfiltration Over C2 Channel
"The backdoor
uses domain fronting to obfuscate its true C2 server",T1090,Proxy
"The fronted
domain is configured by an earlier stage of execution and the actual
domain is hard-coded in the backdoor.",T1090,Proxy
"PowerShell initiated the
first connection to the fronted domain",T1090,Proxy
communicates with its C2 server using HTTPS,T1071.001,Application Layer Protocol: Web Protocols
"its C2 server consists of
JSON data exchanged via HTTP POST requests.",T1071.001,Application Layer Protocol: Web Protocols
"HTTP POST request that contains
the command output.",T1071.001,Application Layer Protocol: Web Protocols
"C2
server via a subsequent HTTP POST request",T1071.001,Application Layer Protocol: Web Protocols
"its C2 server via a
subsequent HTTP POST request.",T1071.001,Application Layer Protocol: Web Protocols
"its C2 server every five
seconds via HTTP POST requests.",T1071.001,Application Layer Protocol: Web Protocols
"backdoor that supports commands, including screen capture",T1113,Screen Capture
Upload a screen capture,T1113,Screen Capture
keystroke capture,T1056.001,Input Capture: Keylogging
"The backdoor writes captured
keystrokes to memory",T1056.001,Input Capture: Keylogging
continuously captures keystrokes,T1056.001,Input Capture: Keylogging
the keylogging utility,T1056.001,Input Capture: Keylogging
This attacker utilized an additional keylogging utility,T1056.001,Input Capture: Keylogging
"The keylogging utility was configured
to capture and record keystrokes to C:\ProgramData\psh\System32Log.txt.",T1056.001,Input Capture: Keylogging
Keylogger Deployment,T1056.001,Input Capture: Keylogging
keylogger,T1056.001,Input Capture: Keylogging
"The backdoor may also download and execute
additional PowerShell commands from its command and control (C2) server.",T1105,Ingress Tool Transfer
Downloaded VBScript and PowerShell,T1105,Ingress Tool Transfer
"a PowerShell script block was executed
to download",T1105,Ingress Tool Transfer
"PowerShell to connect to third-party file sharing
sites to download the UltraVNC application",T1105,Ingress Tool Transfer
"PowerShell to connect to third-party file sharing
sites to download an NGROK utility",T1105,Ingress Tool Transfer
"use UltraVNC to download two LNK
files",T1105,Ingress Tool Transfer
used UltraVNC to download an in-memory dropper,T1105,Ingress Tool Transfer
"using UltraVNC to download and store
a file",T1105,Ingress Tool Transfer
deployed additional tools,T1105,Ingress Tool Transfer
"The Data field may contain RC4-encrypted, Base64-encoded command",T1573.001,Encrypted Channel: Symmetric Cryptography
"The backdoor uses an RC4 key
configured by an earlier stage of execution to encrypt and decrypt the
Data field",T1573.001,Encrypted Channel: Symmetric Cryptography
"observed the RC4 key
UwOdHsFXjdCOIrjTCfnblwEZ used for RC4 encryption and
decryption.",T1573.001,Encrypted Channel: Symmetric Cryptography
"RC4-decrypts command data returned in
the Data field.",T1573.001,Encrypted Channel: Symmetric Cryptography
"The dropper configures
the backdoor with a C2 server address, RC4 encryption key,",T1573.001,Encrypted Channel: Symmetric Cryptography
Base64-decodes,T1140,Deobfuscate/Decode Files or Information
decryption.,T1140,Deobfuscate/Decode Files or Information
"decrypt the
Data field.",T1140,Deobfuscate/Decode Files or Information
decrypts and executes in memory,T1140,Deobfuscate/Decode Files or Information
embedded key to decrypt the source code,T1140,Deobfuscate/Decode Files or Information
the deobfuscated SMOKEDHAM dropper.,T1140,Deobfuscate/Decode Files or Information
"Upload a screen capture to its C2
server",T1041,Exfiltration Over C2 Channel
"The backdoor writes captured
keystrokes to memory and uploads them to its C2 server",T1041,Exfiltration Over C2 Channel
"reg.exe add
HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run",T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
"created a persistence mechanism for NGROK by adding
VirtualHost.vbs to the WindNT value under the current users Run
registry key.",T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
"created a persistence mechanism for UltraVNC by adding the
application to the ConhostNT value under the current users Run
registry key.",T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
"reg.exe add
HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run",T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
"store
a file named update.lnk in the %APPDATA%\Microsoft\Windows\Start
Menu\Programs\Startup\ directory",T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
"the command line argument
provided",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"passed as an argument on the
command line.",T1059.003,Command and Scripting Interpreter: Windows Command Shell
executed using the Command-Line Compiler.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"launched with a command
line",T1059.003,Command and Scripting Interpreter: Windows Command Shell
using Command Prompt.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"backdoor source code is embedded as an encrypted
string.",T1027,Obfuscated Files or Information
whoami.exe,T1033,System Owner/User Discovery
systeminfo.exe,T1082,System Information Discovery
"reg.exe ADD
'HKLM\SOFTWARE\Microsoft\Windows
NT\CurrentVersion\Winlogon\SpecialAccounts\UserList",T1112,Modify Registry
"modifying
Terminal Server registry key values",T1112,Modify Registry
"modifying the Local Security Authority (LSA)
registry key value",T1112,Modify Registry
"reg.exe ADD
'HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server' /v
fDenyTSConnections /t REG_DWORD /d 0 /f",T1112,Modify Registry
"reg.exe ADD
'HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server' /v
fSingleSessionPerUser /t REG_DWORD /d 0 /f",T1112,Modify Registry
"reg.exe ADD
HKLM\SYSTEM\CurrentControlSet\Control\Lsa /v
LimitBlankPasswordUse /t REG_DWORD /d 1 /f",T1112,Modify Registry
"modified the WDigest registry key value
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest\UseLogonCredential
to enable credential caching.",T1112,Modify Registry
"to enable multiple Remote Desktop
connection sessions",T1021.001,Remote Services: Remote Desktop Protocol
"the attacker was observed moving laterally to
different systems in the environment using Remote Desktop Protocol
(RDP) connections.",T1021.001,Remote Services: Remote Desktop Protocol
"attacker dump the LSASS process using Task
Manager to a file named lsass.DMP, and later, zip the dump into two
files named lsass.zip and lsass2.zip located in the
C:\ProgramData\psh\ directory.",T1003.001,OS Credential Dumping: LSASS Memory
LSASS Dumping,T1003.001,OS Credential Dumping: LSASS Memory
"conducted credential harvesting
via dumping LSASS memory.",T1003.001,OS Credential Dumping: LSASS Memory
activity from Tor,T1090,Proxy
hop points to enable their cyber operations while remaining anonymous.,T1090,Proxy
“The Onion Router” (Tor) is often used by cyber threat actors for anonymity and C2.,T1090,Proxy
resulted in confirmed compromises of internet-facing Federal Government agency systems.,T1190,Exploit Public-Facing Application
resulted in confirmed compromises of internet-facing Federal Government agency systems.,T1190,Exploit Public-Facing Application
the actors leveraging CVE-2019-19781 to compromise Citrix Application Delivery Controllers.,T1190,Exploit Public-Facing Application
attack of a Remote Desktop Protocol on a public-facing server.,T1190,Exploit Public-Facing Application
cyber threat actors using external proxy tools,T1090,Proxy
These proxy tools may be commercially available infrastructure as a service (IaaS) or software as a service (SaaS) in the form of a web browser promising anonymity on the internet.,T1090,Proxy
proxy tools depending on their intended use.,T1090,Proxy
activity from a network proxy tool,T1090,Proxy
Cyber threat actors also continue to identify large repositories of credentials that are available on the internet to enable brute-force attacks.,T1110,Brute Force
brute-force passwords.,T1110,Brute Force
threat actors using Mimikatz in conjunction with coin miner protocols and software.,T1003.001,OS Credential Dumping: LSASS Memory
The actors used Mimikatz to dump credentials from the OS using a variety of capabilities resident within the tool.,T1003.001,OS Credential Dumping: LSASS Memory
the actors using Mimikatz during their operations.,T1003.001,OS Credential Dumping: LSASS Memory
a brute-force attack of a Remote Desktop Protocol on a public-facing server.,T1110,Brute Force
such as a keystroke logger,T1056.001,Input Capture: Keylogging
file injection capability,T1055,Process Injection
actors to execute directory traversal attacks,T1083,File and Directory Discovery
or delete files,T1070.004,Indicator Removal: File Deletion
"allows cyber threat actors to execute arbitrary system commands,",T1059.003,Command and Scripting Interpreter: Windows Command Shell
concealed programs and documents at innocuous-seeming locations on victim networks and in victim networks’ “recycle bins.”,T1564.001,Hide Artifacts: Hidden Files and Directories
The lures are designed to socially engineer the recipient to download and open an attached RAR file that contains either a Microsoft Compiled HTML Help (CHM) or Excel payload.,T1566.001,Phishing: Spearphishing Attachment
phishing emails that were used as lures to deliver the files,T1566.001,Phishing: Spearphishing Attachment
download further malware payloads,T1105,Ingress Tool Transfer
to download a next stage EXE payload using cURL,T1105,Ingress Tool Transfer
downloading of the next stage.,T1105,Ingress Tool Transfer
One scheduled task (shown below) runs every 15 minutes,T1053.005,Scheduled Task/Job: Scheduled Task
"""C:\Windows\System32\schtasks.exe"" /create /sc MINUTE /mo 15 /TN",T1053.005,Scheduled Task/Job: Scheduled Task
creates two different scheduled tasks.,T1053.005,Scheduled Task/Job: Scheduled Task
Scheduled task,T1053.005,Scheduled Task/Job: Scheduled Task
"The second scheduled task created attempts to execute the payload downloaded by the other task: 
""C:\Windows\System32\schtasks.exe"" /create /sc MINUTE /mo 20 /TN",T1053.005,Scheduled Task/Job: Scheduled Task
create a scheduled task,T1053.005,Scheduled Task/Job: Scheduled Task
"""C:\Windows\System32\schtasks.exe"" /create /sc minute /mo 15 /tn",T1053.005,Scheduled Task/Job: Scheduled Task
used to create scheduled tasks for persistence,T1053.005,Scheduled Task/Job: Scheduled Task
schtasks /create /tn WinSecurity /sc minute /mo 15,T1053.005,Scheduled Task/Job: Scheduled Task
"These payloads are compressed inside RAR files, this helps avoid static analysis techniques",T1027,Obfuscated Files or Information
The more common payloads contained within the RAR files are Microsoft Compiled HTML Help (CHM) files,T1027,Obfuscated Files or Information
The computer name,T1082,System Information Discovery
the computer name is sent to the C2,T1082,System Information Discovery
the username is also sent to the C2.,T1033,System Owner/User Discovery
The computer name and the username is also sent to the C2.,T1041,Exfiltration Over C2 Channel
the computer name is sent to the C2,T1041,Exfiltration Over C2 Channel
"plugins such as a keylogger,",T1056.001,Input Capture: Keylogging
remote access tool,T1219,Remote Access Software
file stealer,T1005,Data from Local System
"an encoded PowerShell command stage, obfuscating the activity further than just simple string concatenation.",T1027,Obfuscated Files or Information
Encoded PowerShell command,T1027,Obfuscated Files or Information
The decoded command,T1140,Deobfuscate/Decode Files or Information
threat actors obtain initial access to networks is through the use of compromised valid credential pairs,T1078,Valid Accounts
often will search for directories on the network,T1083,File and Directory Discovery
remote desktop protocol (RDP) and secure shell (SSH) accesses,T1021.001,Remote Services: Remote Desktop Protocol
Threat actors will look for networks that have internet-facing servers running RDP and then exploit vulnerabilities in those servers,T1190,Exploit Public-Facing Application
Exposed RDP servers are also abused by threat actors to gain initial access into a targets network.,T1190,Exploit Public-Facing Application
use brute force password attacks,T1110,Brute Force
"The server contained HTTP header data (SimpleHTTP/0.6 Python/3.8.10), indicating the use of a Python library called SIMPLEHTTPSERVER",T1071.001,Application Layer Protocol: Web Protocols
The threat actor also engaged in brute-forcing against the victim's internal web services,T1110,Brute Force
brute forcing tool called FSCAN.,T1110,Brute Force
brute-force attacks on systems,T1110,Brute Force
brute forcing attempts on some of the internal FTP servers inside victim network,T1110,Brute Force
The database used a weak password and was susceptible to brute-force attacks.,T1110,Brute Force
threat actor used the Windows command-line arguments,T1059.003,Command and Scripting Interpreter: Windows Command Shell
received a command-line argument from attacker,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"Used to search for the string ""DBPath"" in all files within the current directory and its subdirectories",T1083,File and Directory Discovery
List of recently opened files and folders on the computer.,T1083,File and Directory Discovery
The threat actor uses stolen passwords from valid accounts,T1078,Valid Accounts
to escalate privileges using valid accounts,T1078,Valid Accounts
the reverse SOCKS proxy activity on the infected device using the open-source tool FRP.,T1090,Proxy
"After establishing the reverse SOCKS proxy connection,",T1090,Proxy
"The threat actor utilized open-source reverse proxy tools to expose local devices located behind a NAT or firewall, to the Internet.",T1090,Proxy
Execution of FRP reverse SOCKS proxy on infected host.,T1090,Proxy
Installation of malicious Windows service.,T1543.003,Create or Modify System Process: Windows Service
it will install a fake Windows service called “windowsupdate”,T1543.003,Create or Modify System Process: Windows Service
"Malicious service installation is accomplished via the below command line argument:
sc create WindowsUpdate binPath= C:\Windows\Temp\svchost.exe start= auto obj= LocalSystem DisplayName= windowsupdate",T1543.003,Create or Modify System Process: Windows Service
Maintain Presence via Windows Service Installation,T1543.003,Create or Modify System Process: Windows Service
"To establish persistent remote access on the victim device, the threat actor abused Windows services to install modified version of Cobalt Strike payload",T1543.003,Create or Modify System Process: Windows Service
installed a second stage persistence backdoor on infected device by abusing Windows Services.,T1543.003,Create or Modify System Process: Windows Service
This service executes a malicious binary (Cobalt Strike Cat payload) under “C:\Windows\Temp\svchost.exe” every time the victim device is started.,T1569.002,System Services: Service Execution
"Windows services ran with the highest privilege, NT AUTHORITY\SYSTEM and execute the malware automatically during system startup, allowing for remote access to the victim device with persistence.",T1569.002,System Services: Service Execution
the threat actor used private proxy addresses from a Chinese underground proxy IP solution called 'Tigercloud Club' to conceal their real IP address.,T1090,Proxy
Reverse proxy tool,T1090,Proxy
Reverse proxy tool,T1090,Proxy
Threat actor uploaded the fast reverse proxy (FRP) binary,T1090,Proxy
One of the main initial access vector is exploitation of publicly exposed web services.,T1190,Exploit Public-Facing Application
Initial Compromise Through Exploiting Publicly Facing Applications,T1190,Exploit Public-Facing Application
the threat actor primarily focuses on four different known remote code execution (RCE) vulnerabilities during their operations:•    CVE-2023-21839      Oracle WebLogic Server RCE [13]•    CVE-2021-3129      Laravel debug mode RCE [14]•    CVE-2020-2551      Oracle WebLogic RCE [15]•    CVE-2021-44228     Apache Log4j [16],T1190,Exploit Public-Facing Application
the victim IP address was publicly serving a web service that contained a phpMyAdmin database.,T1190,Exploit Public-Facing Application
The threat actor primarily focused on exploiting four different remote code execution (RCE) vulnerabilities to target web services,T1210,Exploitation of Remote Services
Decrypting and exporting browser data,T1140,Deobfuscate/Decode Files or Information
the decryption key for the ZIP folder and access the tool,T1140,Deobfuscate/Decode Files or Information
distributed inside an encrypted ZIP folder.,T1027,Obfuscated Files or Information
"executed the ""tasklist /SVC"" command to list all running processes on the victim device.",T1057,Process Discovery
deleted the LaZagne binary after execution to avoid detection from the user's side.,T1070.004,Indicator Removal: File Deletion
The actor leveraged ONE-FOX - a collection of pentest tools - to copy binaries from actor´s system to the victim.,T1570,Lateral Tool Transfer
Recording keystrokes in real time with offline logging available,T1056.001,Input Capture: Keylogging
Downloading files remotely,T1105,Ingress Tool Transfer
the dropper then downloads a custom XMRig miner,T1105,Ingress Tool Transfer
"a script to download, configure and execute",T1105,Ingress Tool Transfer
to download the XMRig payload.,T1105,Ingress Tool Transfer
pulls the XMRig payload,T1105,Ingress Tool Transfer
generating a script to decode the legitimate Mach-O file.,T1140,Deobfuscate/Decode Files or Information
is decoded and unarchived,T1140,Deobfuscate/Decode Files or Information
This value is decoded,T1140,Deobfuscate/Decode Files or Information
The Logic Pro X dropper binary is deleted with the /tmp/ bundle,T1027,Obfuscated Files or Information
"In order to unpack the legitimate binary,",T1027,Obfuscated Files or Information
binary unpacks a customized Mach-O,T1027,Obfuscated Files or Information
previously written Base64 file,T1027,Obfuscated Files or Information
Files are dropped/downloaded as Base64-encoded archives.,T1027,Obfuscated Files or Information
The script first deletes itself from the disk.,T1070.004,Indicator Removal: File Deletion
removes any files,T1070.004,Indicator Removal: File Deletion
deleted every time,T1070.004,Indicator Removal: File Deletion
The script then removes any files,T1070.004,Indicator Removal: File Deletion
script removes the i2pd Mach-O file from the disk.,T1070.004,Indicator Removal: File Deletion
"Even though the scripts produce many on-disk artifacts, the dropper and scripts are quick to remove them",T1070.004,Indicator Removal: File Deletion
Files are deleted after use.,T1070.004,Indicator Removal: File Deletion
to proxy the miner’s network communications.,T1090,Proxy
mining proxy.,T1090,Proxy
The usage of a proxy allows authors to control all of their mining implants and their target pools via a centralized console,T1090,Proxy
the mining proxy,T1090,Proxy
command line arguments,T1059.003,Command and Scripting Interpreter: Windows Command Shell
is executed as a command line argument,T1059.003,Command and Scripting Interpreter: Windows Command Shell
The padded i2pd Mach-O file,T1027,Obfuscated Files or Information
pads the resulting Mach-O with a random number of \x00 bytes,T1027,Obfuscated Files or Information
binaries are padded with a random number of zero bytes to change its hash and expand its size.,T1027,Obfuscated Files or Information
is padded with a random number of \x00 bytes.,T1027,Obfuscated Files or Information
the user will continue to execute the dropper,T1204.002,User Execution: Malicious File
The dropper is executed by the user.,T1204.002,User Execution: Malicious File
As long as the dropper successfully launches its legitimate application,T1036.005,Masquerading: Match Legitimate Name or Location
"The dropper bundle in the applications folder appears legitimate,",T1036.005,Masquerading: Match Legitimate Name or Location
The authors cleverly utilized these legitimate dependencies via symbolic links when dynamically creating the legitimate bundle in the temp folder.,T1036.005,Masquerading: Match Legitimate Name or Location
"The dropper is installed into a legitimate file path, posing as the legitimate application.",T1036.005,Masquerading: Match Legitimate Name or Location
utilize legitimate file paths to mask their execution.,T1036.005,Masquerading: Match Legitimate Name or Location
"In order to appear as a working copy of Logic Pro X, the dropper contains a legitimate copy of the lure application",T1036.005,Masquerading: Match Legitimate Name or Location
The mirrored bundle contains the legitimate application instead of the dropper binary.,T1036.005,Masquerading: Match Legitimate Name or Location
to mirror all directories found in /Applications/Logic Pro X.app/Contents and /Applications/Logic Pro X.app/Contents/MacOS to their respective /tmp/ locations,T1036.005,Masquerading: Match Legitimate Name or Location
The malicious dropper contains a legitimate version of the software and executes it to give the illusion of a properly behaving application.,T1036.005,Masquerading: Match Legitimate Name or Location
a check using pgrep for Activity Monitor processes,T1518.001,Software Discovery: Security Software Discovery
This proxy server is located on the I2P network at the destination of the pool tunnel,T1090,Proxy
config via the XMRig miner’s native API.,T1106,Native API
By modifying the below registry value EnableLUA to “0”,T1112,Modify Registry
"The ConsentPromptBehaviorAdmin key has been set to “0”, indicating that the behavior of the consent prompt for actions requiring administrator privileges has been modified",T1112,Modify Registry
the ransomware modifies specific registry values,T1112,Modify Registry
malware aims to deactivate User Account Control (UAC) on the target system,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
UAC BYPASS,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
"to disable User Access Control (UAC), a security feature in Windows",T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
"By deactivating UAC, the ransomware gets elevated privileges without requiring user permission or administrator credentials",T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
After bypassing UAC,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
the ransomware uses the FindFirstVolumeW() and FindNextVolumeW() API functions,T1106,Native API
using the FindFirstFileW() and FindNextFileW() API functions.,T1106,Native API
"the malware leverages various functions from the CryptoAPI, including CryptAcquireContextW(), CryptImportKey(), CryptSetKeyParam(), and CryptEncrypt().",T1106,Native API
"using the MoveFileExW() API function,",T1106,Native API
to search and identify accessible volumes on the targeted system.,T1083,File and Directory Discovery
the malware proceeds to identify files and directories for encryption by iterating through them,T1083,File and Directory Discovery
This function scans a specified path by finding all files within the given directory and its subdirectories.,T1083,File and Directory Discovery
then iterates over each volume to search for specific files related to virtual machines.,T1083,File and Directory Discovery
This function scans VM volumes on an ESXi server.,T1083,File and Directory Discovery
scanning files in a specified or generic path,T1083,File and Directory Discovery
then iterates over each volume to find files,T1083,File and Directory Discovery
command uses the Windows Management Instrumentation Command-line (WMIC),T1047,Windows Management Instrumentation
This function is responsible for deleting all files and directories in the user’s trash folder.,T1070.004,Indicator Removal: File Deletion
by passing the file path to be encrypted as an argument.,T1027,Obfuscated Files or Information
It removes log files and temporary files from the root directory.,T1027,Obfuscated Files or Information
"It also deletes the ransomware, script file, and ransom note (index.html), ensuring that no evidence remains on the compromised system.",T1027,Obfuscated Files or Information
It uses the esxcli command to list all VM processes,T1057,Process Discovery
"configuring autorun entries,",T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
through legitimate remote access software such as AnyDesk,T1219,Remote Access Software
invoked the wave 2 ransomware immediately from the command line,T1059.003,Command and Scripting Interpreter: Windows Command Shell
both use CreateFile and WriteFile APIs,T1106,Native API
using DeviceControl API methods,T1106,Native API
use of the same DeviceControl API methods,T1106,Native API
DeviceControl API methods,T1106,Native API
DeviceControl API methods,T1106,Native API
ransomware attempts to decrypt,T1140,Deobfuscate/Decode Files or Information
RC4 key for decryption,T1140,Deobfuscate/Decode Files or Information
the RC4 decryption method uses CryptoAPI (CryptDecrypt) instead of the usual substitution box method,T1140,Deobfuscate/Decode Files or Information
execute embedded scripts,T1027,Obfuscated Files or Information
Embedding of EldoS RawDisk driver inside the wiper malware,T1027,Obfuscated Files or Information
the threat actor embedded the signed raw disk driver in the wiper executable,T1027,Obfuscated Files or Information
the raw disk driver was embedded inside the malware,T1027,Obfuscated Files or Information
the download and launch of a suspicious batch file.,T1105,Ingress Tool Transfer
the actor introduced a downloader to fetch and spawn the next stage payload,T1105,Ingress Tool Transfer
the malicious document connects to the remote server and downloads the payload,T1105,Ingress Tool Transfer
install additional malware,T1105,Ingress Tool Transfer
They then returned 18 hours later to install further malware,T1105,Ingress Tool Transfer
when the malicious Word document opens it fetches the next payload from the remote server:,T1105,Ingress Tool Transfer
it fetched an additional script payload,T1105,Ingress Tool Transfer
a different method of fetching and executing the next stage payload,T1105,Ingress Tool Transfer
"a file downloaded from the internet,",T1105,Ingress Tool Transfer
fetch the next stage payload.,T1105,Ingress Tool Transfer
If the fetched data by cURL command,T1105,Ingress Tool Transfer
Fetch the payload with cURL command,T1105,Ingress Tool Transfer
fetching the next stage payload,T1105,Ingress Tool Transfer
fetching a remote payload,T1105,Ingress Tool Transfer
fetches a payload from the embedded URL and loads it.,T1105,Ingress Tool Transfer
launch of a suspicious batch file.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Windows Batch script,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the operator executed several Windows commands,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd.exe /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
The batch file name,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the scriptlet of the batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"cmd.exe"" /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"cmd.exe"" /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
Windows Batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
This script is for executing the PowerShell script via a Windows scheduled task,T1053.005,Scheduled Task/Job: Scheduled Task
Windows displays a warning message when the user tries to open a file downloaded from the internet.,T1204.002,User Execution: Malicious File
strategy to persuade the victim to execute the malicious shortcut file,T1204.002,User Execution: Malicious File
executed when the victim double-clicked on the shortcut file,T1204.002,User Execution: Malicious File
the executable ieinstal.exe was used to bypass UAC.,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
one victim in the UAE was attacked using a malicious Word document,T1566.001,Phishing: Spearphishing Attachment
to gather basic system information.,T1082,System Information Discovery
rundll32.exe,T1218.011,System Binary Proxy Execution: Rundll32
spawns it with the rundll32.exe command with the payload URL,T1218.011,System Binary Proxy Execution: Rundll32
Embedded files of ISO image,T1027,Obfuscated Files or Information
an encrypted Dump.bin file,T1027,Obfuscated Files or Information
downloader contains an encrypted configuration at the end of the file.,T1027,Obfuscated Files or Information
the supplied encrypted decoy document.,T1027,Obfuscated Files or Information
an encrypted decoy document,T1027,Obfuscated Files or Information
The PDF and executable files have numerous spaces before the file extension to hide it and allay suspicions.,T1027,Obfuscated Files or Information
decodes 0x3E8 bytes with that key,T1140,Deobfuscate/Decode Files or Information
The decrypted data,T1140,Deobfuscate/Decode Files or Information
loads the decrypted DLL file,T1140,Deobfuscate/Decode Files or Information
The malware decrypts the configuration data with the RC4 algorithm using an embedded 64-byte key.,T1140,Deobfuscate/Decode Files or Information
the malware decrypts the payload with a delivered 64-byte RC4 key.,T1140,Deobfuscate/Decode Files or Information
the decrypted payload,T1140,Deobfuscate/Decode Files or Information
"checks for the names of the following antivirus vendors: Sophos, Kaspersky, Avast, Avira, Bitdefender, TrendMicro, and Windows Defender",T1518.001,Software Discovery: Security Software Discovery
"If TrendMicro, BitDefender, or Windows Defender products are installed",T1518.001,Software Discovery: Security Software Discovery
If Windows Defender or Bitdefender Antivirus is installed on the victim’s computer,T1518.001,Software Discovery: Security Software Discovery
depending on the antivirus installed.,T1518.001,Software Discovery: Security Software Discovery
the malware can disable the functionalities of EDR/AV products.,T1562.001,Impair Defenses: Disable or Modify Tools
injects the fetched payload into the explorer.exe process,T1055,Process Injection
The Blockchain.pdf file is a malicious HTML application file,T1027,Obfuscated Files or Information
This evasion technique overwrites the .text section of the pre-loaded ntdll library with the freshly loaded one so that the hooked API addresses are recovered with the original API address,T1027,Obfuscated Files or Information
"The campaigns used a variety of email attachments such as Microsoft OneNote attachments and somewhat rare to see .URL attachments,",T1566.001,Phishing: Spearphishing Attachment
This campaign began with thread hijacked emails which contained HTML attachments.,T1566.001,Phishing: Spearphishing Attachment
"The HTML attachments used HTML Smuggling to drop a password protected, zipped Windows Script File (WSF).",T1027,Obfuscated Files or Information
to download and execute an intermediate script which then downloaded and executed the Standard IcedID Loader using a non-standard export “init”.,T1105,Ingress Tool Transfer
used to download and execute an IcedID loader.,T1105,Ingress Tool Transfer
opened it would initiate the download of a batch (.bat) file.,T1105,Ingress Tool Transfer
The batch file would download and execute,T1105,Ingress Tool Transfer
"When opened, the OneNote document instructed the recipient to ""open"" the document by double-clicking the button displayed in the OneNote document.",T1204.002,User Execution: Malicious File
"file was concealed beneath the ""open"" text which, if clicked, executed the HTA file.",T1204.002,User Execution: Malicious File
containing the encrypted bot and DLL loader.,T1027,Obfuscated Files or Information
download of a batch (.bat) file.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
The batch file would download and execute,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"that contained various bat files,",T1059.003,Command and Scripting Interpreter: Windows Command Shell
execute an IcedID loader with rundll32,T1218.011,System Binary Proxy Execution: Rundll32
loader with rundll32,T1218.011,System Binary Proxy Execution: Rundll32
Config decryption within IcedID Lite Loader.,T1140,Deobfuscate/Decode Files or Information
Decryption of the URI within,T1140,Deobfuscate/Decode Files or Information
The domain is decrypted from the configuration and the URI path is decrypted within the function,T1140,Deobfuscate/Decode Files or Information
Decryption is the same across both,T1140,Deobfuscate/Decode Files or Information
This pattern of decrypting strings,T1140,Deobfuscate/Decode Files or Information
the Forked Loader decrypts and copies strings into global variables where they will be later used to resolve required functions.,T1140,Deobfuscate/Decode Files or Information
Decryption of the config buffer in the Forked Loader.,T1140,Deobfuscate/Decode Files or Information
With the config decrypted,T1140,Deobfuscate/Decode Files or Information
"The response gets decrypted with the IcedID decryption routine,",T1140,Deobfuscate/Decode Files or Information
Contains code to decrypt strings and domains,T1140,Deobfuscate/Decode Files or Information
String decryption of the DLL names,T1140,Deobfuscate/Decode Files or Information
"With the DLL strings decrypted, the malware then decrypts the loader configuration by taking the first 64 bytes and XORing it against the next 64 bytes.",T1140,Deobfuscate/Decode Files or Information
The first four bytes of the decrypted buffer will contain the project identifier,T1140,Deobfuscate/Decode Files or Information
This function decrypts strings,T1140,Deobfuscate/Decode Files or Information
decrypts the DLL strings to be used later to resolve handles to the DLLs needed,T1140,Deobfuscate/Decode Files or Information
The strings are decrypted in the same algorithm where the data is split into DWORDs and XOR’d against a random key.,T1140,Deobfuscate/Decode Files or Information
String decryption for the DLL names needed for execution.,T1140,Deobfuscate/Decode Files or Information
"Decryption of “Lite Loader”"" domains.",T1140,Deobfuscate/Decode Files or Information
a function is called that decrypts strings that,T1140,Deobfuscate/Decode Files or Information
there are two domains that are decrypted:,T1140,Deobfuscate/Decode Files or Information
"With the domain names decrypted, the DLL Loader decrypts 10 strings that should be URIs to be appended to the domains.",T1140,Deobfuscate/Decode Files or Information
Decryption of “Lite Loader” filenames.,T1140,Deobfuscate/Decode Files or Information
After the strings are decrypted,T1140,Deobfuscate/Decode Files or Information
Base64 decoding this value,T1140,Deobfuscate/Decode Files or Information
following base64 decoded header,T1140,Deobfuscate/Decode Files or Information
showing the decrypted botpack structure.,T1140,Deobfuscate/Decode Files or Information
that makes the HTTP request.,T1071.001,Application Layer Protocol: Web Protocols
sends an HTTP request that will contain the encrypted bot response.,T1071.001,Application Layer Protocol: Web Protocols
contain the host information,T1082,System Information Discovery
The Base-64 encoded segment,T1027,Obfuscated Files or Information
may also deliver a weaponized Office document that executes the ReconShark reconnaissance malware.,T1566.001,Phishing: Spearphishing Attachment
to distribute password-protected weaponized Office documents,T1566.001,Phishing: Spearphishing Attachment
Office documents weaponized,T1566.001,Phishing: Spearphishing Attachment
hardware information.,T1082,System Information Discovery
to use this tool for remote management of its infrastructure.,T1219,Remote Access Software
"webshells, mostly obfuscated,",T1027,Obfuscated Files or Information
the hacker also changes the content of the file RedirSuiteServiceProxy.aspx to webshell content.,T1036.005,Masquerading: Match Legitimate Name or Location
RedirSuiteServiceProxy.aspx is a legitimate file name available in the Exchange server.,T1036.005,Masquerading: Match Legitimate Name or Location
"the attacker downloads files,",T1105,Ingress Tool Transfer
drops suspicious files on the attacked servers,T1105,Ingress Tool Transfer
"collecting information on the system,",T1005,Data from Local System
“cmd” /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"""cmd"" /c",T1059.003,Command and Scripting Interpreter: Windows Command Shell
the standard Windows command line tool cmd.exe.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Delete file or folder,T1070.004,Indicator Removal: File Deletion
"the hacker also injects malicious DLLs into the memory,",T1055,Process Injection
the DLL was injected into the memory of the svchost.exe process,T1055,Process Injection
executes these files through WMIC.,T1047,Windows Management Instrumentation
", the above files no longer exist on the compromised system, possibly due to the hacker’s evidence deletion.",T1027,Obfuscated Files or Information
Decrypt the request received using AES algorithm,T1140,Deobfuscate/Decode Files or Information
"After decoding,",T1140,Deobfuscate/Decode Files or Information
creates a listener that listens for connections to port 443 at the path https://*:,T1071.001,Application Layer Protocol: Web Protocols
This method is responsible for collecting system information,T1082,System Information Discovery
"Information such as operating system architecture, framework version, operating system version, etc.",T1082,System Information Discovery
"listing directory and file information in the format
 D|-|<Date created> |<Date modified> |<folder or file name>",T1083,File and Directory Discovery
reading files,T1083,File and Directory Discovery
Sending and receiving data with C2 using the RC4 encryption algorithm where the key will be generated at runtime.,T1573.001,Encrypted Channel: Symmetric Cryptography
delivered via phishing email as an attachment,T1566.001,Phishing: Spearphishing Attachment
The archives often include a JavaScript (.js) file,T1027,Obfuscated Files or Information
likely exploited known vulnerabilities in unpatched applications for initial access,T1190,Exploit Public-Facing Application
gains access to the targets through remote exploitation of an unpatched internet-facing device.,T1190,Exploit Public-Facing Application
"to perform initial intrusion leveraging exposed vulnerable applications, for example, continuing to exploit Log4j 2 vulnerabilities in unpatched systems in",T1190,Exploit Public-Facing Application
"Installing legitimate remote access tools, such as RPort, Ligolo and eHorus",T1219,Remote Access Software
common native Windows tools and commands such as netstat,T1016,System Network Configuration Discovery
Windows Management Instrumentation (WMI) to launch commands on devices,T1047,Windows Management Instrumentation
Remote scheduled tasks to launch their customized PowerShell backdoor,T1053.005,Scheduled Task/Job: Scheduled Task
to register a scheduled task used to launch the ransomware payload.,T1053.005,Scheduled Task/Job: Scheduled Task
The threat actors consistently perform extensive lateral movement actions using the acquired credentials within a targeted environment.,T1078,Valid Accounts
GPO was leveraged again to register a scheduled task used to launch the ransomware payload.,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
first interfered with security tools using Group Policy Objects (GPO).,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
the threat actors leveraged highly privileged credentials and access to domain controllers,T1078,Valid Accounts
The threat actors used the compromised administrator account,T1078,Valid Accounts
the threat actors had to first compromise two privileged accounts and leverage them to manipulate the Azure Active Directory (Azure AD) Connect agent.,T1078,Valid Accounts
"the threat actors first used a compromised, highly privileged account to access the device where the Azure Active Directory (Azure AD) Connect agent is installed.",T1078,Valid Accounts
"The first account was the compromised Azure AD Connector account,",T1078,Valid Accounts
the threat actors were observed using compromised credentials to access the Azure AD Connect device.,T1078,Valid Accounts
authentication from a known attacker IP address into the Azure AD Connector cloud account.,T1078,Valid Accounts
the threat actors executed multiple actions in the cloud using two privileged accounts.,T1078,Valid Accounts
The Azure AD Connector account and the compromised administrator account were then used to perform,T1078,Valid Accounts
a successful sign-in to the Microsoft Azure environment was observed.,T1078,Valid Accounts
The threat actors then used these credentials to pivot from the on-premises environment to the Azure AD environment.,T1078,Valid Accounts
the threat actors leveraged RDP for access into the account.,T1021.001,Remote Services: Remote Desktop Protocol
"the threat actors accessed it through RDP, which is an open session that evades MFA blocking their activities.",T1021.001,Remote Services: Remote Desktop Protocol
"Those files will still get executed, if the user clicks on run",T1204.002,User Execution: Malicious File
Full path to file and hidden files,T1564.001,Hide Artifacts: Hidden Files and Directories
As LSASS dumps are nowadays recognized by the dump file itself,T1003.001,OS Credential Dumping: LSASS Memory
LSASS dump in c:\tmp detected and deleted,T1003.001,OS Credential Dumping: LSASS Memory
LSASS dump in the WebDAV detected,T1003.001,OS Credential Dumping: LSASS Memory
"done via the GetAsyncKeyState API,",T1106,Native API
this is done via the popen API,T1106,Native API
uses Windows API functions to execute files,T1106,Native API
"This is done via the GetAsyncKeyState API, with keystrokes being logged",T1056.001,Input Capture: Keylogging
"keylogging are enabled by default,",T1056.001,Input Capture: Keylogging
logs keystrokes for windows with titles containing substrings specified in its configuration,T1056.001,Input Capture: Keylogging
Window titles to keylog,T1056.001,Input Capture: Keylogging
can log keystrokes.,T1056.001,Input Capture: Keylogging
Screenshots are also taken at a configurable interval; the default is once every 30 seconds.,T1113,Screen Capture
"Screenshots and keylogging are enabled by default,",T1113,Screen Capture
can capture screenshots,T1113,Screen Capture
"the shellcode is stored in files instead of the registry, and the stored shellcode is loaded and executed on Dolphin’s startup",T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
"The backdoor periodically checks and creates its own persistence by making sure that Step 1 of the loader is run every time the system is started, via a registry Run value, in the same way as in the installer:
HKCU\Software\Microsoft\Windows\CurrentVersion\Run\<random_run_name>\”%appdata%\Python27({32|64})\pythonw.exe” “<loader_step_1>” “<loader_encrypted_step_2>”",T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
uses Run keys for persistence of its loader,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
can execute shell commands,T1059.003,Command and Scripting Interpreter: Windows Command Shell
creates directory listings,T1083,File and Directory Discovery
The command to get specific files,T1083,File and Directory Discovery
It creates directory listings,T1083,File and Directory Discovery
to get files from drives,T1083,File and Directory Discovery
it searches the drives of compromised systems for interesting files,T1083,File and Directory Discovery
can obtain file and directory listings.,T1083,File and Directory Discovery
"The following file extensions of interest, specific to media, documents, emails, and certificates,",T1005,Data from Local System
can collect files from local drives.,T1005,Data from Local System
Username,T1033,System Owner/User Discovery
obtains the victim’s username.,T1033,System Owner/User Discovery
Computer name,T1082,System Information Discovery
RAM size and usage,T1082,System Information Discovery
OS version,T1082,System Information Discovery
"obtains various system information including OS version, computer name and RAM size.",T1082,System Information Discovery
List of installed security products,T1518.001,Software Discovery: Security Software Discovery
obtains a list of installed security software.,T1518.001,Software Discovery: Security Software Discovery
Local and external IP address,T1016,System Network Configuration Discovery
obtains the device’s local and external IP address.,T1016,System Network Configuration Discovery
XOR-decrypts an embedded PE file,T1140,Deobfuscate/Decode Files or Information
"XOR-decrypts further shellcode carried within itself,",T1140,Deobfuscate/Decode Files or Information
"XOR-decrypts its contents,",T1140,Deobfuscate/Decode Files or Information
a decrypted configuration,T1140,Deobfuscate/Decode Files or Information
injects it into the created process,T1055,Process Injection
in a specified separate process that is created and injected.,T1055,Process Injection
and inject processes.,T1055,Process Injection
it creates a one-time scheduled task.,T1053.005,Scheduled Task/Job: Scheduled Task
uses a temporary scheduled task to start after installation.,T1053.005,Scheduled Task/Job: Scheduled Task
"After execution, the output of commands is uploaded.",T1041,Exfiltration Over C2 Channel
exfiltrates data to Google Drive storage,T1041,Exfiltration Over C2 Channel
it searches the drives of compromised systems for interesting files and exfiltrates them to Google Drive.,T1041,Exfiltration Over C2 Channel
exfiltrates data to Google Drive.,T1041,Exfiltration Over C2 Channel
"The shellcode is stored in the registry,",T1112,Modify Registry
sending an HTTP POST request,T1071.001,Application Layer Protocol: Web Protocols
uses HTTPS to communicate with Google Drive.,T1071.001,Application Layer Protocol: Web Protocols
staging the data in encrypted ZIP archives before upload.,T1074.001,Data Staged: Local Data Staging
stages collected data in a directory before exfiltration,T1074.001,Data Staged: Local Data Staging
"The content is encrypted using AES CBC with random 16-byte keys and IVs,",T1027,Obfuscated Files or Information
Most strings in this version are base64 encoded.,T1027,Obfuscated Files or Information
The base64-encoded strings were plaintext again in this version.,T1027,Obfuscated Files or Information
has encrypted components.,T1027,Obfuscated Files or Information
"another shellcode, XOR-decrypts an embedded PE file – the Dolphin backdoor – and loads and executes it using a custom PE loader.",T1055,Process Injection
"which is vulnerable to a DLL side-loading vulnerability, and loads a file",T1574.002,Hijack Execution Flow: DLL Side-Loading
"sideloading different DLL names, and multiple binary files names being loaded by those DLLs.",T1574.002,Hijack Execution Flow: DLL Side-Loading
the executables and sideloaded files,T1574.002,Hijack Execution Flow: DLL Side-Loading
Side-loaded DLL name,T1574.002,Hijack Execution Flow: DLL Side-Loading
a threat actor abusing a sideloading vulnerability,T1574.002,Hijack Execution Flow: DLL Side-Loading
Name of the malicious side-loaded DLL,T1574.002,Hijack Execution Flow: DLL Side-Loading
Name of the executable vulnerable to side loading,T1574.002,Hijack Execution Flow: DLL Side-Loading
seemingly legitimate executables and their respective sideloaded files,T1574.002,Hijack Execution Flow: DLL Side-Loading
encoded shellcode,T1027,Obfuscated Files or Information
Creates a memory section with the DES-encrypted malware configuration,T1027,Obfuscated Files or Information
to obfuscate their malware.,T1027,Obfuscated Files or Information
used VMProtect to obfuscate one of them.,T1027,Obfuscated Files or Information
that decompresses and loads the first stage in memory.,T1140,Deobfuscate/Decode Files or Information
shellcode decompressing and loading,T1140,Deobfuscate/Decode Files or Information
there was only one stage being decrypted in memory,T1140,Deobfuscate/Decode Files or Information
the malware decrypts the saved passwords,T1140,Deobfuscate/Decode Files or Information
and then decrypts them,T1140,Deobfuscate/Decode Files or Information
and then decrypts the content,T1140,Deobfuscate/Decode Files or Information
calls Stage 1 again via process hollowing with four parameters,T1055,Process Injection
It then runs Stage 2 via process hollowing.,T1055,Process Injection
creates a registry key,T1112,Modify Registry
a service that launches the moved executable rc.exe with one parameter.,T1569.002,System Services: Service Execution
Screenshot grab,T1113,Screen Capture
Drive information retrieval,T1083,File and Directory Discovery
browses a directory,T1083,File and Directory Discovery
Process manager (browses and terminates processes),T1057,Process Discovery
Current process ID,T1057,Process Discovery
"deletes,",T1070.004,Indicator Removal: File Deletion
"uploads, downloads a file",T1105,Ingress Tool Transfer
Command execution,T1059.003,Command and Scripting Interpreter: Windows Command Shell
by calling the GetNetworkParams API function,T1106,Native API
"Collected machine information includes the following:
Randomly generated GUID
Hostname",T1082,System Information Discovery
Processor architecture,T1082,System Information Discovery
Operating system version,T1082,System Information Discovery
Username,T1033,System Owner/User Discovery
Local IP address and port used to send the network packet,T1016,System Network Configuration Discovery
The configuration is encrypted with a hardcoded DES key and is a few bytes long,T1573.001,Encrypted Channel: Symmetric Cryptography
the malware retrieves information on the infected machine and sends it to the C&C encrypted with DES.,T1573.001,Encrypted Channel: Symmetric Cryptography
"information is sent to the C&C, encrypted with a hardcoded key and DES CBC algorithm:",T1573.001,Encrypted Channel: Symmetric Cryptography
the malware retrieves information on the infected machine and sends it to the C&C,T1041,Exfiltration Over C2 Channel
"Then, the malware retrieves information on the compromised computer and sends it to the C&C.",T1041,Exfiltration Over C2 Channel
used as a lure to entice the victim into opening the malicious file.,T1204.002,User Execution: Malicious File
"to extract the URL, login, and password fields from the file",T1552.001,Unsecured Credentials: Credentials In Files
Name of the hardcoded directory where files are copied,T1074.001,Data Staged: Local Data Staging
The malware also established persistence on the host with the creation of a registry run key.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
persistence was achieved by creating a ‘Run’ key,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
These files were transferred to the domain controller over SMB.,T1570,Lateral Tool Transfer
dumped lsass memory on the domain controller.,T1003.001,OS Credential Dumping: LSASS Memory
We observed a process created by Cobalt Strike accessing lsass.exe,T1003.001,OS Credential Dumping: LSASS Memory
is a known indicator of such tools as Mimikatz,T1003.001,OS Credential Dumping: LSASS Memory
most likely using credentials gathered by the previous LSASS access.,T1003.001,OS Credential Dumping: LSASS Memory
then proceeded to access lsass memory on the host to extract credentials.,T1003.001,OS Credential Dumping: LSASS Memory
the threat actor became active by initiating a proxied RDP connection via the Cobalt Strike beacon to the domain controller.,T1021.001,Remote Services: Remote Desktop Protocol
after completing RDP connections to various hosts on the network,T1021.001,Remote Services: Remote Desktop Protocol
which were started via their interactive RDP session,T1021.001,Remote Services: Remote Desktop Protocol
RDP was also used by the threat actor,T1021.001,Remote Services: Remote Desktop Protocol
The threat actor was able to RDP to a backup server,T1021.001,Remote Services: Remote Desktop Protocol
running processes were reviewed,T1057,Process Discovery
the threat actors checked running processes on the accessed hosts via taskmanager,T1057,Process Discovery
"checking on running tasks,",T1057,Process Discovery
the new drive contained a LNK file 6570872.lnk and hidden folder “me”.,T1564.001,Hide Artifacts: Hidden Files and Directories
"The contents of hidden folder “me”, included several files and folders that were used for the execution",T1564.001,Hide Artifacts: Hidden Files and Directories
the folder included a legitimate copy of rundll32.exe,T1218.011,System Binary Proxy Execution: Rundll32
rundll32.exe binary downloaded approximately 0.4 MB of data.,T1218.011,System Binary Proxy Execution: Rundll32
using a renamed copy of rundll32.,T1218.011,System Binary Proxy Execution: Rundll32
Batch script to run,T1059.003,Command and Scripting Interpreter: Windows Command Shell
file would execute a batch script,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"""C:\Windows\syswow64\cmd.exe"" /C",T1059.003,Command and Scripting Interpreter: Windows Command Shell
An instance of cmd.exe was launched through explorer.exe which ran the following command,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd.exe session,T1059.003,Command and Scripting Interpreter: Windows Command Shell
The threat actor also used a batch script to collect a list of all computer objects on the domain using C:\Windows\system32\cmd.exe /C adcomp.bat which contained the PowerShell command:,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"Once the user had mounted the ISO and the LNK file was executed by the user, the complex execution flow started.",T1204.002,User Execution: Malicious File
The names of the registry values changed,T1112,Modify Registry
The last registry key was used to store additional PowerShell code.,T1112,Modify Registry
"This script called a combination of QueueUserAPC, GetCurrentThreadId, OpenThread, and VirtualAlloc",T1106,Native API
the threat actor injected into various processes,T1055,Process Injection
reg.exe query,T1012,Query Registry
started a BITS job to download a Cobalt Strike beacon,T1105,Ingress Tool Transfer
whoami,T1016,System Network Configuration Discovery
whoami  /groups,T1016,System Network Configuration Discovery
ipconfig /all,T1016,System Network Configuration Discovery
threat actor first ran some initial discovery on the host using built-in Windows utilities like ipconfig,T1016,System Network Configuration Discovery
systeminfo,T1082,System Information Discovery
systeminfo,T1082,System Information Discovery
WMI was used to pivot to a domain controller on the network.,T1047,Windows Management Instrumentation
The actor leveraged Impacket’s wmiexec.py to execute commands with a semi-interactive shell,T1047,Windows Management Instrumentation
interacts with remote endpoints via WMI,T1047,Windows Management Instrumentation
a number of WMI requests via DCERPC from one endpoint to a target endpoint based on the ports.,T1047,Windows Management Instrumentation
the ‘Powershell.exe’ process initiated the WMI requests.,T1047,Windows Management Instrumentation
One of the observed commands invoked via WMI was ‘firefox.exe’.,T1047,Windows Management Instrumentation
"The commands executed included directory traversal,",T1083,File and Directory Discovery
Tool Used to Steal Sensitive Information,T1005,Data from Local System
proxying the traffic,T1090,Proxy
initiating a proxied,T1090,Proxy
Several HTTP Post events were observed to the identified domains,T1071.001,Application Layer Protocol: Web Protocols
HTTP stream containing the content,T1071.001,Application Layer Protocol: Web Protocols
The POST event included a MIME part indicating file upload,T1071.001,Application Layer Protocol: Web Protocols
The file that was uploaded 775E.bin was deleted by the injected ‘Explorer.exe’ process from the target endpoint,T1027,Obfuscated Files or Information
The threat actor was able to RDP to a backup server using the admin credentials they acquired.,T1078,Valid Accounts
"This script called a combination of QueueUserAPC, GetCurrentThreadId, OpenThread, and VirtualAlloc to perform process injection of shellcode",T1055,Process Injection
shellcode stored in Base64.,T1027,Obfuscated Files or Information
The mounted file contains a hidden folder,T1564.001,Hide Artifacts: Hidden Files and Directories
a 200+MB padded file,T1027,Obfuscated Files or Information
padding the contents with benign data,T1027,Obfuscated Files or Information
"It included a standalone file padded with over 200MB of blank spaces, likely to impede analysis of the decompressed ISO file.",T1027,Obfuscated Files or Information
executes a CMD file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
The CMD file contains commands,T1059.003,Command and Scripting Interpreter: Windows Command Shell
which use certutil (renamed here as slaughterhouse.exe) to decode,T1140,Deobfuscate/Decode Files or Information
The decoded DLL,T1140,Deobfuscate/Decode Files or Information
thus requires two rounds of decoding using certutil.,T1140,Deobfuscate/Decode Files or Information
chaining together a series of scripts to decode,T1140,Deobfuscate/Decode Files or Information
The victim double clicks the ISO to mount it,T1204.002,User Execution: Malicious File
"Victims can be lured into clicking executable content including binaries, scripts or shortcut files masquerading as benign filetypes such as PDFs or folders.",T1204.002,User Execution: Malicious File
DLL is then executed using rundll32,T1218.011,System Binary Proxy Execution: Rundll32
and injects Qakbot into wermgr.exe.,T1055,Process Injection
"This file is base64 twice,",T1027,Obfuscated Files or Information
or unpack the final payload,T1027,Obfuscated Files or Information
"modifies registry keys to maintain persistence,",T1112,Modify Registry
Modifies the Windows registry,T1112,Modify Registry
modifies the Windows Registry to allow remote desktop connections,T1112,Modify Registry
establishes persistence through the creation of two keys in CurrentVersion\Run.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
Creates registry key for persistence only,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
Creates two registry keys for persistence,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
Keys found in CurrentVersion\Run contain references to programs that will execute when a user logs in.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
operators install and execute remote access tools such as Splashtop on targeted systems.,T1219,Remote Access Software
remote monitoring and management (RMM) software,T1219,Remote Access Software
operators use Splashtop to transfer malicious tools from computer to computer in the victim’s environment.,T1570,Lateral Tool Transfer
It copies other malicious batch and EXE files from a compromised internal Server Message Block (SMB) server to the newly created temp folder,T1570,Lateral Tool Transfer
operators utilize RDP to move laterally in the victim’s environment.,T1021.001,Remote Services: Remote Desktop Protocol
Modifies the Windows registry to allow remote desktop connections.,T1021.001,Remote Services: Remote Desktop Protocol
operators open up an Remote Desktop Protocol (RDP) port,T1021.001,Remote Services: Remote Desktop Protocol
operators use Mimikatz to dump passwords.,T1003.001,OS Credential Dumping: LSASS Memory
operators use Mimikatz to dump passwords from LSASS.,T1003.001,OS Credential Dumping: LSASS Memory
"Mimikatz, which is a tool used for extracting sensitive information such as passwords and authentication credentials from a Windows operating system.",T1003.001,OS Credential Dumping: LSASS Memory
"Mimikatz being leveraged maliciously by threat actors in the following ways:
Credential Loading
Mimikatz loads credentials from various sources such as Windows memory, Local Security Authority Subsystem Service (LSASS) process",T1003.001,OS Credential Dumping: LSASS Memory
"Mimikatz allows the user to manipulate the dumped credentials,",T1003.001,OS Credential Dumping: LSASS Memory
"is a small, UPX-packed password protected binary",T1027,Obfuscated Files or Information
This version of Mimikatz has been compressed using UPX,T1027,Obfuscated Files or Information
"While UPX is often legitimately used to reduce file size, we have observed threat actors utilizing UPX and other packing programs to evade static detection of the underlying payload.",T1027,Obfuscated Files or Information
operators use UPX to pack DC2.exe and DC4.exe to avoid static signature detection.,T1027,Obfuscated Files or Information
the batch file makes the following changes to the system,T1059.003,Command and Scripting Interpreter: Windows Command Shell
executes an embedded batch file.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
is a batch script,T1059.003,Command and Scripting Interpreter: Windows Command Shell
is a batch script that creates a new user,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"creates a batch script that,",T1059.003,Command and Scripting Interpreter: Windows Command Shell
creates a batch script,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Disables the User Account Control (UAC),T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
Attempting to use sc stop and taskkill to stop over 100 services related to various areas ranging from remote desktop tools to Windows Defender,T1562.001,Impair Defenses: Disable or Modify Tools
"The HTML code in this file contains embedded JavaScript functionality,",T1027,Obfuscated Files or Information
cleanup script used to remove evidence of the attack on a system,T1027,Obfuscated Files or Information
cleanup scripts from other threat actors are usually smaller and more specific to the tools used by that actor.,T1027,Obfuscated Files or Information
adds an additional layer of obfuscation to the code,T1027,Obfuscated Files or Information
password-protected executables to obfuscate malware,T1027,Obfuscated Files or Information
operators used Splashtop – a remote access and management (RMM) tool – to transfer the following malware into the target’s environment.,T1072,Software Deployment Tools
operators use Splashtop to move laterally and transfer malware between compromised hosts in the victim’s environment.,T1072,Software Deployment Tools
"utilize Splashtop to transfer netscan.exe, netscan.lic, netscan.xml, newuser.bat, start.bat and turnoff.bat.",T1072,Software Deployment Tools
"operators delete files such as mim.exe, mim32.exe, zam.exe and zam.bat to cover their tracks",T1070.004,Indicator Removal: File Deletion
hid the installer for Advanced Port Scanner within Inno Setup installer to evade static signature detection.,T1027,Obfuscated Files or Information
employing a combination of outdated Microsoft Office document vulnerabilities,T1072,Software Deployment Tools
exploit vulnerabilities in Microsoft Word’s Equation Editor,T1072,Software Deployment Tools
"leverages a specific set of vulnerabilities, including CVE-2018-0802, CVE-2018-0798, and CVE-2017-11882, within the Equation Editor of Microsoft Office",T1072,Software Deployment Tools
employs a forged document linked to G7 to target various governments within the G20 forum.,T1566.001,Phishing: Spearphishing Attachment
spam email comprising an attached MS Office document,T1566.001,Phishing: Spearphishing Attachment
employ the remote template injection method to retrieve the next stage of the malware from the TA’s Command-and-Control (C&C) server.,T1055,Process Injection
download of a new payload from the attacker’s remote server,T1105,Ingress Tool Transfer
download a backdoor module.,T1105,Ingress Tool Transfer
downloads and executes a malicious backdoor,T1105,Ingress Tool Transfer
enables the TAs to create customized documents containing embedded objects that exploit vulnerabilities in Microsoft Word’s Equation Editor,T1027,Obfuscated Files or Information
"drops an embedded payload, which is a DLL file",T1027,Obfuscated Files or Information
includes both an encrypted payload and shellcode,T1027,Obfuscated Files or Information
encrypts the collected information using RC4 encryption with the key “xkYgv127” and encodes it using base64.,T1027,Obfuscated Files or Information
proceeds to decrypt,T1140,Deobfuscate/Decode Files or Information
"scheduled task entry,",T1053.005,Scheduled Task/Job: Scheduled Task
executes the export function “StartA” from the DLL,T1106,Native API
using rundll32.exe,T1218.011,System Binary Proxy Execution: Rundll32
utilizing the “rundll32.exe” command,T1218.011,System Binary Proxy Execution: Rundll32
loader is executed through rundll32.exe,T1218.011,System Binary Proxy Execution: Rundll32
"hostname, operating system name, OS version, username,",T1082,System Information Discovery
"Gather computer-specific information such as computer name, username, gateway address, network adapter details, Windows version, and user type",T1082,System Information Discovery
"Internet information,",T1016,System Network Configuration Discovery
Retrieve TCP/UDP tables,T1016,System Network Configuration Discovery
the presence of any installed anti-virus software on the machine.,T1518.001,Software Discovery: Security Software Discovery
encrypted data is then exfiltrated using the below C&C URL,T1041,Exfiltration Over C2 Channel
encrypted data is then exfiltrated using the below C&C URL,T1573.001,Encrypted Channel: Symmetric Cryptography
C&C server responds with the next stage executable,T1573.001,Encrypted Channel: Symmetric Cryptography
loader establishes a connection with a C&C server in the final stage of the attack.,T1573.001,Encrypted Channel: Symmetric Cryptography
Capture screenshots of victims’ system,T1113,Screen Capture
Obtain information about processes and services running on the machine,T1057,Process Discovery
Retrieve information about registry keys,T1012,Query Registry
using the remote process execution tool PSExec to execute batch files,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Copy down batch scriptsExecute batch scripts,T1059.003,Command and Scripting Interpreter: Windows Command Shell
defaultChanges the Windows Shell from Explorer to their malicious script,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"exe└──cmd.exe: C:\Windows\system32\cmd.exe /c """"rdp.bat""",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"executes the shell (file2.bat),",T1059.003,Command and Scripting Interpreter: Windows Command Shell
tries to start its defined shell which has been swapped to a batch script (file2.bat) by the malicious actor.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Command line flags may be used to change this behavior and invoke one or more of the modules.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
that would cause registry changes,T1112,Modify Registry
"reg.exe: reg  add ""HKLM\System\CurrentControlSet\Control\Terminal Server"" /v ""fDenyTSConnections"" /t REG_DWORD /d 0 /",T1112,Modify Registry
Sets various registry values,T1112,Modify Registry
to enable Remote Desktop sessions (RDP) using reg.exe.,T1021.001,Remote Services: Remote Desktop Protocol
the malicious actor retrieved system administration tools and malicious payloads by using the Background Intelligent Transfer Service,T1105,Ingress Tool Transfer
Storing the ransomware within a 7zip encrypted archive,T1027,Obfuscated Files or Information
"encrypted archive containing the ransomware,",T1027,Obfuscated Files or Information
a decompression utility to extract the ransomware,T1140,Deobfuscate/Decode Files or Information
"drop the defenses of the victim, inhibit monitoring, disable networking",T1562.001,Impair Defenses: Disable or Modify Tools
"stops specific defensive services (Windows Defender, etc)",T1562.001,Impair Defenses: Disable or Modify Tools
Will also skip enumeration and stopping of antivirus software.-,T1562.001,Impair Defenses: Disable or Modify Tools
to authenticate to the site behind the onion link on the TOR network,T1090,Proxy
 ShellExecuteA is also used to launch,T1106,Native API
API call attempts to processes:,T1106,Native API
 The local module utilizes the LookupPrivilegeValueW and AdjustTokenPrivileges that Windows API calls on its own process via GetCurrentProcess and OpenProcessToken to obtain SeDebugPrivilege privileges.,T1106,Native API
using Active Directory group policies allows the malicious actor to hit all systems in the environment for as long as that group policy is active in the victim’s environment.,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
Potential Process Hollowing,T1055,Process Injection
more sophisticated encryption,T1027,Obfuscated Files or Information
this technique for encryption-decryption is easily more discernable during analysis because both the encrypted data and the mapping are in the same file,T1027,Obfuscated Files or Information
for its execution technique of hiding malicious code inside log files.,T1027,Obfuscated Files or Information
The bytes of the encrypted section is a specific index on the byte map,T1027,Obfuscated Files or Information
"Though this is a very rigid method of hiding its codes,",T1027,Obfuscated Files or Information
uses byte remapping to ensure that the shellcode cannot be easily decrypted without the correct byte map,T1027,Obfuscated Files or Information
usually the encrypted payload,T1027,Obfuscated Files or Information
shows that their offsets within the encrypted region remain the same since they result in a similar shellcode even if they are composed of different bytes per binary.,T1027,Obfuscated Files or Information
"The malware checks if there are monitoring tools, specifically Process Monitor, running in the current machine with the following strings:
procmon
procmon64
procmon64a",T1518.001,Software Discovery: Security Software Discovery
"checks for a few installed and active antivirus products, namely:
Windows Defender
ESET",T1518.001,Software Discovery: Security Software Discovery
the malware proceeds to decrypt the PowerShell code,T1140,Deobfuscate/Decode Files or Information
"Furthermore, since the data to be decrypted is in another file, the routine becomes even more difficult to investigate, as analysts would need the correct pair for decryption.",T1140,Deobfuscate/Decode Files or Information
"Afterward, the shellcode will then decrypt and load the main ViperSoftX DLL embedded within the carrier.",T1140,Deobfuscate/Decode Files or Information
"Moreover, all the strings, binaries, and other relevant data within the ViperSoftX DLL also gets decrypted the same way.",T1140,Deobfuscate/Decode Files or Information
The actual bytes of the decrypted shellcode,T1140,Deobfuscate/Decode Files or Information
to crawl through different paths in the system,T1083,File and Directory Discovery
"scans for these cryptocurrency wallets in local directories:
Armory
Atomic Wallet
Binance
Bitcoin
Blockstream Green
Coinomi
Delta
Electrum
Exodus
Guarda
Jaxx Liberty
Ledger Live
Trezor Bridge",T1083,File and Directory Discovery
the use of DLL sideloading for its arrival and execution technique.,T1574.002,Hijack Execution Flow: DLL Side-Loading
found in the sideloaded DLL.,T1574.002,Hijack Execution Flow: DLL Side-Loading
"the sideloaded DLL),",T1574.002,Hijack Execution Flow: DLL Side-Loading
DLL sideloading,T1574.002,Hijack Execution Flow: DLL Side-Loading
While other cybercriminals use sideloading to load another non-binary component,T1574.002,Hijack Execution Flow: DLL Side-Loading
"We have also found that each sideloader DLL has its own pair of executable and byte map,",T1574.002,Hijack Execution Flow: DLL Side-Loading
It still downloads a PowerShell code,T1105,Ingress Tool Transfer
or Windows Scripting,T1059.003,Command and Scripting Interpreter: Windows Command Shell
File-packed Magniber ransomware,T1027,Obfuscated Files or Information
"To obtain the credentials, the team took a snapshot of lsass.exe",T1003.001,OS Credential Dumping: LSASS Memory
"with a tool called nanodump, exported the output, and processed the output offline with Mimikatz.",T1003.001,OS Credential Dumping: LSASS Memory
"The team obtained the cached credentials from a SharePoint server account by taking a snapshot of lsass.exe with a tool called nanodump, exporting the output and processing the output offline with Mimikatz.",T1003.001,OS Credential Dumping: LSASS Memory
They then used forged credentials to move to multiple hosts across different sites in the environment and eventually gained root access to all workstations connected to the organization’s mobile device management (MDM) server.,T1078,Valid Accounts
The team used this root access to move laterally to SBS-connected workstations.,T1078,Valid Accounts
team attempted to determine valid accounts based on group name and purpose,T1078,Valid Accounts
The team attempted to leverage these credentials,T1078,Valid Accounts
"From that host, the team moved laterally to a misconfigured server, from which they compromised the domain controller (DC).",T1078,Valid Accounts
"with a button, which, when clicked, downloaded a “malicious” ISO file",T1204.002,User Execution: Malicious File
"After the download, another button appeared, which, when clicked, executed the file.",T1204.002,User Execution: Malicious File
Users downloaded and executed the team’s initial access payloads after clicking buttons to trigger download and execution.,T1204.002,User Execution: Malicious File
they used compromised workstation and domain admin accounts,T1078,Valid Accounts
Use a previously compromised workstation admin account,T1078,Valid Accounts
Use a previously compromised domain admin account,T1078,Valid Accounts
the team leveraged compromised workstation and domain admin accounts to execute a payload,T1078,Valid Accounts
the team compromised a domain admin account and used it to laterally to multiple workstations and the DC.,T1078,Valid Accounts
they used compromised workstation and domain admin accounts to upload a payload via SMB on several target Workstations and the DC.,T1570,Lateral Tool Transfer
Use a previously compromised workstation admin account to upload and execute a payload via SMB,T1570,Lateral Tool Transfer
Use a previously compromised domain admin account to upload and execute a payload via SMB,T1570,Lateral Tool Transfer
The team’s C2 redirectors used HTTPS reverse proxies to redirect C2 traffic.,T1071.001,Application Layer Protocol: Web Protocols
The team used HTTPS,T1071.001,Application Layer Protocol: Web Protocols
the HTTPS beacon,T1071.001,Application Layer Protocol: Web Protocols
post-exploit tool that leverages HTTP protocols for C2 traffic.,T1071.001,Application Layer Protocol: Web Protocols
used HTTPS reverse proxies to redirect C2 traffic,T1071.001,Application Layer Protocol: Web Protocols
"Establish a session that originates from a target Workstation system directly to an external host over a clear text protocol, such as HTTP.",T1071.001,Application Layer Protocol: Web Protocols
"Establish a session that originates from a target Domain Controller system directly to an external host over a clear text protocol, such as HTTP.",T1071.001,Application Layer Protocol: Web Protocols
used HTTPS reverse proxies to redirect C2 traffic.,T1090,Proxy
the team uploaded and executed well-known malicious files,T1105,Ingress Tool Transfer
to download and execute a payload,T1105,Ingress Tool Transfer
"Upload and execute a well-known (e.g., with a signature) malicious file to a target DC system",T1105,Ingress Tool Transfer
used redirectors to redirect C2 traffic between the target organization’s network and the team’s C2 servers.,T1090,Proxy
used HTTPS reverse proxies to redirect C2 traffic between target network and the team’s Cobalt Strike servers.,T1090,Proxy
The team used these platforms to create flexible and dynamic redirect servers to send traffic to the team’s Cobalt Strike servers,T1090,Proxy
The redirectors used HTTPS reverse proxies to redirect C2 traffic between the target organization’s network and the Cobalt Strike team servers,T1090,Proxy
The team used domain fronting to disguise outbound traffic in order to diversify the domains with which the persistent beacons were communicating.,T1090,Proxy
The team used domain fronting [T1090.004] to disguise outbound traffic in order to diversify the domains with which the persistent beacons were communicating,T1090,Proxy
"This technique, which also leverages CDNs, allows the beacon to appear to connect to third-party domains, such as nytimes.com, when it is actually connecting to the team’s redirect server",T1090,Proxy
This technique leverages CDNs associated with high-reputation domains so that the malicious traffic appears to be directed towards a reputation domain but is actually redirected to the red team-controlled Cobalt Strike servers.,T1090,Proxy
which prompted DC authentication to the SharePoint server using the server’s NTLM hash. The team then deployed Rubeus to capture the incoming DC TGT,T1557.001,Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay
"The team performed an NTLM-relay attack to obtain the DC’s TGT, followed by a golden ticket attack on a SharePoint server with Unconstrained Delegation to gain the ability to impersonate any Site 1 AD account.",T1557.001,Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay
"The team ran the DFSCoerce python script, which prompted DC authentication to a server using the server’s NTLM hash. The team then deployed Rubeus to capture the incoming DC TGT.",T1557.001,Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay
"The team ran the DFSCoerce python script, which prompted DC authentication to a server using the server’s NTLM hash",T1557.001,Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay
"In some instances, they used Windows Management Instrumentation (WMI) Event Subscriptions",T1047,Windows Management Instrumentation
The team used WMI Event Subscriptions to move laterally between sites.,T1047,Windows Management Instrumentation
command-line tool,T1059.003,Command and Scripting Interpreter: Windows Command Shell
which stored credentials in a database file.,T1552.001,Unsecured Credentials: Credentials In Files
"searched files on the server, and found plaintext credentials",T1552.001,Unsecured Credentials: Credentials In Files
the plaintext credentials in PowerShell scripts,T1552.001,Unsecured Credentials: Credentials In Files
the team found a .txt file containing plaintext credentials for the user,T1552.001,Unsecured Credentials: Credentials In Files
The team found plaintext credentials to an API user account stored in PowerShell scripts on an MDM server.,T1552.001,Unsecured Credentials: Credentials In Files
"Using the pattern discovered in these credentials, the team was able to crack the user’s workstation account password",T1110,Brute Force
The team cracked a user’s workstation account password after learning the user’s patterns from plaintext credentials.,T1110,Brute Force
Detect and Identify source IP,T1016,System Network Configuration Discovery
Detect and Identify source IP,T1016,System Network Configuration Discovery
Detect and identify source IP,T1016,System Network Configuration Discovery
Detect and identify source IP,T1016,System Network Configuration Discovery
Detect and identify source IP,T1016,System Network Configuration Discovery
Windows Service Creation,T1543.003,Create or Modify System Process: Windows Service
Windows Service Creation,T1543.003,Create or Modify System Process: Windows Service
Windows Service Creation,T1543.003,Create or Modify System Process: Windows Service
"execute a payload via SMB and Windows Service Creation, respectively, on several target Workstations.",T1569.002,System Services: Service Execution
"execute a payload via SMB and Windows Service Creation, respectively, on a target DC.",T1569.002,System Services: Service Execution
execute a payload via Windows Service Creation on target workstations and the DC.,T1569.002,System Services: Service Execution
The team used the organization’s MDM system to gain root access to machines across the organization’s network without being detected.,T1072,Software Deployment Tools
The krbtgt account is a domain default account,T1078,Valid Accounts
Use of non-secure default configurations,T1078,Valid Accounts
The organization used default configurations for hosts with Windows Server 2012 R2.,T1078,Valid Accounts
The default configuration allows unprivileged users to query group membership of local administrator groups,T1078,Valid Accounts
The red team used and identified several standard user accounts with administrative access from a Windows Server 2012 R2 SharePoint server.,T1078,Valid Accounts
The team discovered several standard user accounts that have local administrator access to critical servers.,T1078,Valid Accounts
This misconfiguration allowed the team to use the low-level access of a phished user to move laterally to an Unconstrained Delegation host and compromise the entire domain.,T1078,Valid Accounts
"If a user with administrative access is compromised, an actor can access servers without needing to elevate privileges",T1078,Valid Accounts
Some workstations allowed unprivileged accounts to have local administrator access,T1078,Valid Accounts
keylogged a user during a mandatory password change,T1056.001,Input Capture: Keylogging
spear phishing attachments.,T1566.001,Phishing: Spearphishing Attachment
spear phishing attachments for Initial Access,T1566.001,Phishing: Spearphishing Attachment
As attackers can quickly change spear phishing attachments,T1566.001,Phishing: Spearphishing Attachment
suspicious email attachments or other phishing techniques.,T1566.001,Phishing: Spearphishing Attachment
modification of Registry Keys/Startup folder for persistence,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
Using valid accounts,T1078,Valid Accounts
valid accounts,T1078,Valid Accounts
"and protocols, such as for Remote Desktop Protocol",T1021.001,Remote Services: Remote Desktop Protocol
used to download files…,T1105,Ingress Tool Transfer
"The second stage payload, which was later determined to likely be the penetration testing framework ""Brute Ratel,"" was then downloaded via a connection",T1105,Ingress Tool Transfer
“RClone” was downloaded on the file servers,T1105,Ingress Tool Transfer
which allowed the threat actor to move freely between domains.,T1078,Valid Accounts
"Two "".bat"" files were sent throughout the organization.",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"before running the "".cmd"" file contained within the ISO.",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"this CMD file calls the ""db"" file. In both samples,",T1059.003,Command and Scripting Interpreter: Windows Command Shell
""".bat"" files",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"USING "".BAT"" FILES",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"The two "".bat"" files that were sent",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"""cc.bat"" is a simple script",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"""w.bat"" as viewed through the bash command ""cat"":",T1059.003,Command and Scripting Interpreter: Windows Command Shell
"these are the same commands as observed in the "".bat"" files:",T1059.003,Command and Scripting Interpreter: Windows Command Shell
Both were designed to turn off antivirus and anti-malware software.,T1562.001,Impair Defenses: Disable or Modify Tools
""".bat"" files designed to disable Cisco AMP / Microsoft Defender",T1562.001,Impair Defenses: Disable or Modify Tools
"the command ""net stop Cisco AMP"".",T1562.001,Impair Defenses: Disable or Modify Tools
showing the “uninstall” commands for Windows Defender:,T1562.001,Impair Defenses: Disable or Modify Tools
"DISABLING ANTIVIRUS/MALWARE SOFTWARE USING "".BAT"" FILES",T1562.001,Impair Defenses: Disable or Modify Tools
were both designed to turn off Antivirus and Antimalware software.,T1562.001,Impair Defenses: Disable or Modify Tools
designed to stop Cisco AMP.,T1562.001,Impair Defenses: Disable or Modify Tools
Stopping Cisco AMP /  Disabling Microsoft Defender,T1562.001,Impair Defenses: Disable or Modify Tools
"From the two phishing emails, both attachments contain similar malware.",T1566.001,Phishing: Spearphishing Attachment
The phishing attachment was submitted to the target in a response to an ongoing conversation,T1566.001,Phishing: Spearphishing Attachment
"When downloaded, the initial attachment is a local HTML file.",T1027,Obfuscated Files or Information
were able to be decrypted by leveraging the decryption script,T1053.005,Scheduled Task/Job: Scheduled Task
adds itself to a scheduled task.,T1053.005,Scheduled Task/Job: Scheduled Task
The emulated C2 Server is now running an HTTPS server,T1071.001,Application Layer Protocol: Web Protocols
shows that this connection was likely HTTPS,T1071.001,Application Layer Protocol: Web Protocols
the communication is consistent with HTTP/S traffic.,T1071.001,Application Layer Protocol: Web Protocols
on TCP port 2222.,T1095,Non-Application Layer Protocol
most of the connection attempts to the C2 IP’s are conducted over TCP port 443.,T1095,Non-Application Layer Protocol
"Due to TCP port 2222’s common use as an alternate port for SSH communication, the Malware Analyst recorded a manual SSH connection to the emulated C2 host",T1095,Non-Application Layer Protocol
some data exfiltration or interaction with the downloaded second stage from the C2.,T1041,Exfiltration Over C2 Channel
show the transfer of files using SMB.,T1570,Lateral Tool Transfer
Files commonly observed transferred via SMB include,T1570,Lateral Tool Transfer
Showing the Transfer of Cobalt Strike Beacons using RDPClip:,T1570,Lateral Tool Transfer
allows for lateral movement leveraging RPC to create SMB traffic.,T1570,Lateral Tool Transfer
indicating the use of Remote Desktop Protocol.[,T1021.001,Remote Services: Remote Desktop Protocol
Showing the Transfer of Cobalt Strike Beacons using RDPClip:,T1021.001,Remote Services: Remote Desktop Protocol
the use of RDP by the Threat Actor,T1021.001,Remote Services: Remote Desktop Protocol
The second encoded Base64 string was not only base64 but also Gziped for size and obfuscation.,T1027,Obfuscated Files or Information
has some simple but clever obfuscation in place.,T1027,Obfuscated Files or Information
This shows the decoded and uncompressed data.,T1140,Deobfuscate/Decode Files or Information
payload decoder from Github,T1140,Deobfuscate/Decode Files or Information
used to decode the body,T1140,Deobfuscate/Decode Files or Information
"Task manager was then use to reveal the service running on PID 3488,",T1057,Process Discovery
requests using RC4 encryption,T1573.001,Encrypted Channel: Symmetric Cryptography
was abused by the attacker to steal client data.,T1005,Data from Local System
"the malware copied itself to ""$CURRENTUSER\AppData\Roaming\Microsoft\Isoaahffo\djkuuhd.dll,"" as confirmed by the file's hashes shown below, and sets itself to auto run.",T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
"the process imbedded itself into wermgr.exe, the Windows Error Reporting Manager (Process ID 6660).",T1055,Process Injection
"This uses a mixture of disguising the ASCII as UTF-16 via manipulating the start of the file, as well as obfuscating the data using a simple cypher.",T1027,Obfuscated Files or Information
running the malware sets itself up as the service,T1543.003,Create or Modify System Process: Windows Service
"after reaching the local DC, the attacker was able to gain a better lay of the land and observe the presence of the other two domains.",T1078,Valid Accounts
a technique leveraging the Windows Management Instrumentation (WMI) service to execute malicious code.,T1047,Windows Management Instrumentation
indicating that the user deleted the collected data.,T1070.004,Indicator Removal: File Deletion
group utilizes sideloading,T1574.002,Hijack Execution Flow: DLL Side-Loading
DLL for sideloading,T1574.002,Hijack Execution Flow: DLL Side-Loading
The group uses DLL sideloading,T1574.002,Hijack Execution Flow: DLL Side-Loading
detect and remove Alibaba Cloud Security from compromised instances,T1518.001,Software Discovery: Security Software Discovery
relied on their victims to execute the malicious MSI installers,T1204.002,User Execution: Malicious File
uses cmd.exe to download files from Alibaba Cloud Object Storage Service.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
executes OSSUTIL (included in the installer package as ssu.exe) to download files,T1059.003,Command and Scripting Interpreter: Windows Command Shell
use API calls such as VirtualAlloc to load and execute malicious components into memory,T1106,Native API
invokes the Windows API function DisableThreadLibraryCalls,T1106,Native API
create scheduled tasks to achieve persistence,T1053.005,Scheduled Task/Job: Scheduled Task
Create scheduled tasks to execute the loader and updater components,T1053.005,Scheduled Task/Job: Scheduled Task
"scheduled tasks created for the updater,",T1053.005,Scheduled Task/Job: Scheduled Task
four scheduled tasks are created:,T1053.005,Scheduled Task/Job: Scheduled Task
creates a registry Run key to achieve persistence,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
use various encryption algorithms to hide payloads and strings.,T1027,Obfuscated Files or Information
execute an encrypted payload located in the embedded DLL,T1027,Obfuscated Files or Information
"contains an XOR-encrypted payload, divided into three files",T1027,Obfuscated Files or Information
"encrypted with a different, single byte XOR key",T1027,Obfuscated Files or Information
use dynamic API resolution to avoid detection.,T1027,Obfuscated Files or Information
calling an export function of the DLL,T1027,Obfuscated Files or Information
"reconstructs the imports table of the DLL and calls the DllEntryPoint,",T1027,Obfuscated Files or Information
"the DLL will find the address of an export function called SVP7, which contains the entry point of the malware,",T1027,Obfuscated Files or Information
used DLL side-loading to execute their malicious payloads,T1574.002,Hijack Execution Flow: DLL Side-Loading
"side-loading a malicious DLL, libpng13.dll",T1574.002,Hijack Execution Flow: DLL Side-Loading
"by side-loading dr.dll, used by a legitimate, signed binary",T1574.002,Hijack Execution Flow: DLL Side-Loading
", side-loaded by the same legitimate executable",T1574.002,Hijack Execution Flow: DLL Side-Loading
contains shellcode and an embedded DLL file that loads FatalRAT,T1027,Obfuscated Files or Information
contains an embedded DLL,T1027,Obfuscated Files or Information
execute an encrypted payload located in the embedded DLL,T1027,Obfuscated Files or Information
has keylogger functionalities,T1056.001,Input Capture: Keylogging
Capture keystrokes,T1056.001,Input Capture: Keylogging
encrypts data with a custom encryption algorithm before it is sent to the C&C server.,T1573.001,Encrypted Channel: Symmetric Cryptography
uses TCP for C&C communications.,T1095,Non-Application Layer Protocol
exfiltrates data over the same channel used for C&C,T1041,Exfiltration Over C2 Channel
Drop a file named ossutilconfig in the %USERPROFILE% directory,T1036.005,Masquerading: Match Legitimate Name or Location
Drop and execute the legitimate installer in C:\Program Files\Common Files (see CommonFiles64Folder).,T1036.005,Masquerading: Match Legitimate Name or Location
"by side-loading dr.dll, used by a legitimate, signed binary",T1036.005,Masquerading: Match Legitimate Name or Location
The original libpng13.dll is also included in the installer package (renamed to what appears to be a random name) because the malicious DLL forwards its exported functions to the original DLL.,T1055,Process Injection
download files from an attacker-controlled bucket in Alibaba Cloud,T1105,Ingress Tool Transfer
download and execute further shellcode,T1105,Ingress Tool Transfer
obfuscated the loader with many calls to a function that just prints some hardcoded values,T1027,Obfuscated Files or Information
"decrypt,",T1140,Deobfuscate/Decode Files or Information
decrypts the payload is the same as the function used in FatalRAT to decrypt its configuration,T1140,Deobfuscate/Decode Files or Information
decrypt its configuration strings,T1140,Deobfuscate/Decode Files or Information
the decompiled code used to decrypt strings,T1027,Obfuscated Files or Information
Decompiled code of a function used by a FatalRAT,T1027,Obfuscated Files or Information
using a variety of software packers,T1027,Obfuscated Files or Information
one Zip contained a benign file named screenshot1242.jpeg and another contained a file named privatecopy.pdf.,T1027,Obfuscated Files or Information
"When someone tries to double-click these decoy files, Windows (or the application mapped to the relevant filetype) throws an error because the file isn’t the type of file it appears to be",T1027,Obfuscated Files or Information
"The target would then, naturally, double click the other file in the Zip archive",T1204.002,User Execution: Malicious File
"command pulls down a Visual Basic script, drops it into the C:\Windows\Tasks folder, and executes it.",T1105,Ingress Tool Transfer
90 other encrypted,T1027,Obfuscated Files or Information
 A heavily obfuscated VBS,T1027,Obfuscated Files or Information
"The initial infector is a Visual Basic script, heavily obfuscated",T1027,Obfuscated Files or Information
"A block of base64-encoded, encrypted data comprises almost 150KB of that script,",T1027,Obfuscated Files or Information
segments of base64 data,T1027,Obfuscated Files or Information
along with code that decodes and decrypts the block of base64.,T1140,Deobfuscate/Decode Files or Information
"When decoded, the content of the Ir8 variable (a segment of which is shown below) turns out to be just another encoded PowerShell script, which the VBS decodes and then executes.",T1140,Deobfuscate/Decode Files or Information
The PowerShell script decoded from the Ir8 variable uses Reflection.,T1140,Deobfuscate/Decode Files or Information
performs a BXOR to decode the bytes,T1140,Deobfuscate/Decode Files or Information
for the Ir8 script to decode.,T1140,Deobfuscate/Decode Files or Information
These work in tandem to insert data into the Windows Registry,T1112,Modify Registry
"The concatenated segments of base64 data from O7 get inserted into the Registry,",T1112,Modify Registry
to load the final payload into memory from a Registry value without,T1112,Modify Registry
It created a Run key in the Registry,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
And that Run key references a different Registry key,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
"On one machine, we found that the malware injected itself, using process hollowing, into ielowutil.exe",T1055,Process Injection
obfuscated with legitimate resources,T1027,Obfuscated Files or Information
encrypted stack strings,T1027,Obfuscated Files or Information
Embedded Resource,T1027,Obfuscated Files or Information
shellcode from the .data section,T1027,Obfuscated Files or Information
shellcode that was stored in the .data section is now stored in the .rsc section,T1027,Obfuscated Files or Information
advapi32.CryptHashData,T1106,Native API
will create a key using advapi32.CryptDeriveKey,T1106,Native API
advapi32.CryptEncrypt,T1106,Native API
"kernel32.LoadLibraryA, kernel32.GetProcAddress, kernel32.VirtualAlloc, kernel32.VirtualProtect and ntdll.ZwFlushInstructionCache",T1106,Native API
kernel32.VirtualALloc,T1106,Native API
"kernel32.VirtualProtect,",T1106,Native API
kernel32.GetLastError,T1106,Native API
kernel32.CreateMutexA,T1106,Native API
"wininet.HttpSendRequestA,",T1106,Native API
shellcode injection,T1055,Process Injection
copy each PE section one at a time,T1055,Process Injection
"creating another PE in memory,",T1055,Process Injection
injecting a PE executable,T1055,Process Injection
handle to the current process for the purpose of allocating memory with PAGE_EXECUTE_READWRITE permissions,T1055,Process Injection
decrypt the shellcode,T1140,Deobfuscate/Decode Files or Information
decyrpt its C2 configuration,T1140,Deobfuscate/Decode Files or Information
get a pointer to the encrypted shellcode and to decrypt it have been broken out into their own separate functions,T1140,Deobfuscate/Decode Files or Information
will need to resolve these APIs dynamically to interact with the Windows operating system,T1027,Obfuscated Files or Information
resolving many different Windows APIs using kernel32.GetProcAddress,T1027,Obfuscated Files or Information
enumerating the Process Environment Block (PEB),T1057,Process Discovery
HTTP HEAD request,T1071.001,Application Layer Protocol: Web Protocols
check if it is connected to the internet by making a request,T1071.001,Application Layer Protocol: Web Protocols
will make a HTTP GET request,T1071.001,Application Layer Protocol: Web Protocols
will make a POST request,T1078,Valid Accounts
NBTScan for network reconnaissance,T1016,System Network Configuration Discovery
System Network Connections Discovery,T1016,System Network Configuration Discovery
PsExec for lateral movement,T1569.002,System Services: Service Execution
obtained credentials for pivoting with Mimikatz,T1078,Valid Accounts
detect memory dumps of the lsass process,T1003.001,OS Credential Dumping: LSASS Memory
OS Credential Dumping: LSASS Memory,T1003.001,OS Credential Dumping: LSASS Memory
had been archived,T1027,Obfuscated Files or Information
encrypted copy,T1027,Obfuscated Files or Information
encrypting the base encryption key with RSA (with a hard-coded 1024-byte public key) and encoding it in Base64.,T1027,Obfuscated Files or Information
uploaded.,T1041,Exfiltration Over C2 Channel
Exfiltration Over C2 Channel,T1041,Exfiltration Over C2 Channel
to run bruteforcing offline.,T1110,Brute Force
"scan hosts for so-called Eternal* SMB vulnerabilities with SMBTouch and then, where possible, run the EternalBlue exploit and infect the computer",T1210,Exploitation of Remote Services
Exploitation of Remote Services,T1210,Exploitation of Remote Services
SysUpdate and HyperBro backdoors were installed,T1105,Ingress Tool Transfer
"push Polar ransomware to computers and run it,",T1105,Ingress Tool Transfer
Three files are sent to the victim's computer:,T1105,Ingress Tool Transfer
obtained the credentials of a domain administration at headquarters,T1078,Valid Accounts
account of the compromised domain admin,T1078,Valid Accounts
Valid Accounts: Domain Accounts,T1078,Valid Accounts
"is a .NET DLL library (compiled on April 29, 2020) imported when GDFInstall.exe is run",T1036.005,Masquerading: Match Legitimate Name or Location
XOR decrypted with key ABCSCDFRWFFSDJJHGYUOIj.,T1140,Deobfuscate/Decode Files or Information
decoded with Base64,T1140,Deobfuscate/Decode Files or Information
decrypts a third component,T1140,Deobfuscate/Decode Files or Information
decrypted and decoded version,T1140,Deobfuscate/Decode Files or Information
Deobfuscate/Decode Files or Information,T1140,Deobfuscate/Decode Files or Information
payload and intermediate library are deleted before completion,T1070.004,Indicator Removal: File Deletion
deletes the intermediate DLL library and encrypted ransomware,T1070.004,Indicator Removal: File Deletion
del,T1070.004,Indicator Removal: File Deletion
del,T1070.004,Indicator Removal: File Deletion
yielding a PE file that is loaded and run in memory with .NET.,T1027,Obfuscated Files or Information
wmic,T1047,Windows Management Instrumentation
Windows Management Instrumentation,T1047,Windows Management Instrumentation
wmic,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"""cmd.exe",T1059.003,Command and Scripting Interpreter: Windows Command Shell
Command and Scripting Interpreter: Windows Command Shell,T1059.003,Command and Scripting Interpreter: Windows Command Shell
looks for,T1057,Process Discovery
list of connected disks and starts recursive traversal of directories,T1083,File and Directory Discovery
sends an HTTP POST request with the name of the victim's computer to a server,T1071.001,Application Layer Protocol: Web Protocols
"T1071
Application Layer Protocol: Web Protocols",T1071.001,Application Layer Protocol: Web Protocols
SCHTASKS /Create,T1053.005,Scheduled Task/Job: Scheduled Task
schtasks /run,T1053.005,Scheduled Task/Job: Scheduled Task
Scheduled Task/Job: Scheduled Task,T1053.005,Scheduled Task/Job: Scheduled Task
Scheduled Task/Job: Scheduled Task,T1053.005,Scheduled Task/Job: Scheduled Task
Exploit Public-Facing Application,T1190,Exploit Public-Facing Application
Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
Valid Accounts: Default Accounts,T1078,Valid Accounts
Exploitation for Privilege Escalation,T1068,Exploitation for Privilege Escalation
System Information Discovery,T1082,System Information Discovery
Lateral Tool Transfer,T1570,Lateral Tool Transfer
Data from Local System,T1005,Data from Local System
Encrypted Channel: Symmetric Cryptography,T1573.001,Encrypted Channel: Symmetric Cryptography
Unpacked file names,T1027,Obfuscated Files or Information
obfuscation of the GuLoader shellcode and payloads,T1027,Obfuscated Files or Information
to download additional malicious files,T1105,Ingress Tool Transfer
subsequently download Remcos on the target system,T1105,Ingress Tool Transfer
:taking full control of the infected machinerecording keystrokes in real time with,T1056.001,Input Capture: Keylogging
The second shellcode revealed after the unpacking algorithm finished processing,T1027,Obfuscated Files or Information
this executable is an archive that can be unpacked with the help of 7zip,T1027,Obfuscated Files or Information
"Once we unpack the file, we can see several elements, as well as directories typical for NSIS:",T1027,Obfuscated Files or Information
It is unpacked,T1027,Obfuscated Files or Information
This packer has been around for many years,T1027,Obfuscated Files or Information
Then the functions are used to load and decrypt the payload.,T1140,Deobfuscate/Decode Files or Information
The decryption function is custom,T1140,Deobfuscate/Decode Files or Information
custom decryption algorithm is being applied on the buffer,T1140,Deobfuscate/Decode Files or Information
The algorithm used for the buffer decryption differs across the samples.,T1140,Deobfuscate/Decode Files or Information
This shellcode is used for decrypting,T1140,Deobfuscate/Decode Files or Information
the key that will be used for the decryption is prepared.,T1140,Deobfuscate/Decode Files or Information
After the PE is decrypted,T1140,Deobfuscate/Decode Files or Information
we can see decryption of the next stage with the help of a custom algorithm,T1140,Deobfuscate/Decode Files or Information
It contains a very similar function dedicated to decrypting and loading the final payload,T1140,Deobfuscate/Decode Files or Information
"Both of them are encrypted,",T1027,Obfuscated Files or Information
loading the final payload (PE file) from the third of the encrypted files.,T1027,Obfuscated Files or Information
The authors used several common techniques to obfuscate this process.,T1027,Obfuscated Files or Information
passing the path to the encrypted component as a parameter.,T1027,Obfuscated Files or Information
obfuscating malicious elements.,T1027,Obfuscated Files or Information
"As before, they are resolved by their hashes.",T1027,Obfuscated Files or Information
"Then, a function defined by its hash is retrieved (using the same hashing algorithm that was used to retrieve imports from normally loaded DLLs):",T1027,Obfuscated Files or Information
"By extracting the syscalls, and executing them manually, the malware can use the API of the operating system, without a need of calling functions from the DLL.",T1027,Obfuscated Files or Information
functions has been resolved by their hashes.,T1027,Obfuscated Files or Information
The hashing function used for import resolving,T1027,Obfuscated Files or Information
"By extracting the syscalls, and executing them manually, the malware can use the API of the operating system,",T1106,Native API
"using low level APIs: NtCreateSection, NtMapViewOfSection",T1106,Native API
"Functions are always the same – dedicated to reading the file from the disk: CreateFileW, GetTempPathW, lstrcatW, ReadFile, VirtualAlloc, GetTempPathW.",T1106,Native API
The function GetTempPathW is used,T1106,Native API
"The low-level functions, directly related with performing the injection, are called via raw syscalls",T1106,Native API
PE injection,T1055,Process Injection
The payload is implanted into a newly created suspended process (a new instance of the current executable) using one of the most popular techniques of PE injection: Process Hollowing,T1055,Process Injection
"a second, encrypted component, which carries the payload.",T1027,Obfuscated Files or Information
a check against blacklisted processes.,T1057,Process Discovery
exploiting vulnerabilities in the remote desktop protocol (RDP).,T1210,Exploitation of Remote Services
distributing phishing emails containing malicious files,T1566.001,Phishing: Spearphishing Attachment
it attempts to establish a connection with the remote server to retrieve the subsequent component of the attack,T1105,Ingress Tool Transfer
a malicious template file is downloaded and executed,T1105,Ingress Tool Transfer
to trigger the retrieval of the final stage payload,T1105,Ingress Tool Transfer
This enables the document to fetch the .dotm file from the remote server required for further actions,T1105,Ingress Tool Transfer
Upon opening the malicious document,T1204.002,User Execution: Malicious File
an obfuscated VBA macro,T1027,Obfuscated Files or Information
“cmd /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"the Windows Registry or NTFS Extended Attributes to hide their data,",T1112,Modify Registry
hide a second stage payload in registry transaction files,T1112,Modify Registry
"perform a
number of changes on the filesystem or registry,",T1112,Modify Registry
"to store and retrieve binary data with
the Windows API.",T1106,Native API
"It provides
applications with API functions—available",T1106,Native API
accessible through API functions.,T1106,Native API
opened with the CreateLogFile() API,T1106,Native API
using the clfsw32.dll API function,T1106,Native API
"This function is
patched using Microsoft Detours—a publicly available library used for
instrumenting Win32
functions—so",T1106,Native API
"resolves the function
address for the ServiceMain export function",T1106,Native API
via the API CreateFileTransactedA(),T1106,Native API
"via the API
NtCreateSection()",T1106,Native API
Malware Obfuscation,T1027,Obfuscated Files or Information
"most of the strings used by
PRIVATELOG and STASHLOG are obfuscated",T1027,Obfuscated Files or Information
"each string is therefore
encrypted with a unique byte stream.",T1027,Obfuscated Files or Information
relies on XOR’ing each byte with a hard-coded,T1027,Obfuscated Files or Information
"the
control flow obfuscation.",T1027,Obfuscated Files or Information
"In addition to containing obfuscated strings, the installer’s code
is protected using various control flow obfuscation techniques that
make static analysis cumbersome",T1027,Obfuscated Files or Information
"the installer
generates and prints out encryption keys that the actor uses to
pre-encrypt the payload before it is written to disk",T1027,Obfuscated Files or Information
"Following the payload header, the malware expects blocks of
encrypted data with 8-byte headers.",T1027,Obfuscated Files or Information
"Each block is then
re-encrypted with the new key material as follows:
 The encryption key is the 16-byte GUID",T1027,Obfuscated Files or Information
"The encryption algorithm
is HC-128,",T1027,Obfuscated Files or Information
Sample string deobfuscation,T1140,Deobfuscate/Decode Files or Information
"some of the deobfuscated strings from the installer
are used for logging error messages and",T1140,Deobfuscate/Decode Files or Information
"the installer opens and decrypts the
contents of the file passed as an argument",T1140,Deobfuscate/Decode Files or Information
decrypted file contents,T1140,Deobfuscate/Decode Files or Information
"the decrypted data matches
the payload",T1140,Deobfuscate/Decode Files or Information
"the malware decrypts
each block using HC-128",T1140,Deobfuscate/Decode Files or Information
"the payload which will be
decrypted.",T1140,Deobfuscate/Decode Files or Information
"its contents are decrypted
using the HC-128 encryption algorithm",T1140,Deobfuscate/Decode Files or Information
"The decryption key and IV are
generated using the same unique host properties",T1140,Deobfuscate/Decode Files or Information
"only decrypts the first matching
block",T1140,Deobfuscate/Decode Files or Information
"the decrypted
payload contents",T1140,Deobfuscate/Decode Files or Information
"file that
should be hidden in a CLFS file",T1564.001,Hide Artifacts: Hidden Files and Directories
"it searches for .blf files in the
default user’s profile directory",T1083,File and Directory Discovery
"starts by enumerating *.blf files in the default user’s profile
directory",T1083,File and Directory Discovery
"malware
also checks that the operating system version",T1082,System Information Discovery
"The injection
process",T1055,Process Injection
"For example,
to open a registry key in a transaction, the functions
RegCreateKeyTransacted(), RegOpenKeyTransacted(), and
RegDeleteKeyTransacted() are available.",T1012,Query Registry
The GUID returned from the registry value,T1012,Query Registry
Mimikatz to steal credentials from host memory.,T1003.001,OS Credential Dumping: LSASS Memory
Mimikatz,T1003.001,OS Credential Dumping: LSASS Memory
Uses Mimikatz to harvest credentials.,T1003.001,OS Credential Dumping: LSASS Memory
decrypts them locally.,T1140,Deobfuscate/Decode Files or Information
"Once decrypted,",T1140,Deobfuscate/Decode Files or Information
begins to decrypt and parse its embedded configuration,T1140,Deobfuscate/Decode Files or Information
decrypting the rest of the blob once it has been decoded.,T1140,Deobfuscate/Decode Files or Information
Once the REvil configuration has decrypted,T1140,Deobfuscate/Decode Files or Information
Decrypted REvil configuration,T1140,Deobfuscate/Decode Files or Information
decrypted Ransom Cartel configuration,T1140,Deobfuscate/Decode Files or Information
"they are written to the registry,",T1112,Modify Registry
"it is written to the registry key SOFTWARE\\Google_Authenticator\\b52dKMhj,",T1112,Modify Registry
Once the data has been written to the registry,T1112,Modify Registry
stored within the registry,T1112,Modify Registry
Modifies the Registry to disable UAC remote restrictions by setting SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy to 1.,T1112,Modify Registry
"first checks to see if the registry already contains previously generated values; if so, it will read those values into memory.",T1012,Query Registry
the command line provided to the ransomware is parsed.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd.exe,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Uses cmd.exe to execute commands.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
to disable UAC remote restrictions by setting SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy to 1.,T1562.001,Impair Defenses: Disable or Modify Tools
Adds registry run keys to achieve persistence.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
to download and install payloads,T1105,Ingress Tool Transfer
to retrieve the malicious payload and download additional resources,T1105,Ingress Tool Transfer
Downloads and uploads files to and from the victim’s machine.,T1105,Ingress Tool Transfer
the tool downloads the files,T1105,Ingress Tool Transfer
"Uses legitimate VPN, RDP, Citrix or VNC credentials to maintain access to an environment.",T1078,Valid Accounts
Deploys PDQ Inventory Scanner tool.,T1072,Software Deployment Tools
"using a cracked version of a legitimate tool called PDQ Inventory, which is a legitimate system management solution that IT administrators use to scan their network and collect hardware, software and Windows configuration data",T1072,Software Deployment Tools
to enable offline password cracking.,T1110,Brute Force
Uses Rundll32 to load and execute malicious DLL.,T1218.011,System Binary Proxy Execution: Rundll32
the ransomware will proceed to spawn another instance of itself via rundll32.exe,T1218.011,System Binary Proxy Execution: Rundll32
"Deletes some of its files used during operations as part of cleanup, including removing applications such as 7z.exe, tor.exe, ssh.exe",T1070.004,Indicator Removal: File Deletion
Uses encoded PowerShell commands.,T1027,Obfuscated Files or Information
utilizing string encryption,T1027,Obfuscated Files or Information
encrypted configuration,T1027,Obfuscated Files or Information
"a base64-encoded ransom note,",T1027,Obfuscated Files or Information
"The configuration is stored as a base64-encoded blob, whereby the first 16 bytes of the base64-encoded blob is the RC4 key",T1027,Obfuscated Files or Information
opts to obfuscate their ransomware much more heavily,T1027,Obfuscated Files or Information
Searches for specific files prior to encryption.,T1083,File and Directory Discovery
"seeks out files with the following file extensions: .log, .vmdk, .vmem, .vswp and .vmsn.",T1083,File and Directory Discovery
Target specific file path,T1083,File and Directory Discovery
to search machines for certain files,T1083,File and Directory Discovery
Uses AnyDesk to remotely connect and transfer files.,T1219,Remote Access Software
used this as a remote access tool to establish an interactive command and control channel,T1219,Remote Access Software
Routes traffic over TOR and VPN servers to obfuscate their activities.,T1090,Proxy
TOR sites redirecting to a new ransomware operation,T1090,Proxy
API hashing,T1027,Obfuscated Files or Information
the username,T1033,System Owner/User Discovery
"computer name, domain name, locale and product name.",T1082,System Information Discovery
leads to a function that iterates over a call,T1106,Native API
"executes the batch file,",T1059.003,Command and Scripting Interpreter: Windows Command Shell
a batch script used,T1059.003,Command and Scripting Interpreter: Windows Command Shell
batch files,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"A new batch file, localdisk.bat, was also executed",T1059.003,Command and Scripting Interpreter: Windows Command Shell
These discovery actions were completed several times again in other various batch files.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
it was executed using a command line argument,T1059.003,Command and Scripting Interpreter: Windows Command Shell
a batch file.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the execution of the batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
The batch file eyewear.bat then executed two commands,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe,T1059.003,Command and Scripting Interpreter: Windows Command Shell
enter this directly in the host OS command shell.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
invoked from the command line,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Another batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
leveraged by a batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\System32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
using the command line,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the threat actors dropped several batch scripts on the server:,T1059.003,Command and Scripting Interpreter: Windows Command Shell
the batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd.exe /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd.exe /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd.exe /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd.exe /c,T1059.003,Command and Scripting Interpreter: Windows Command Shell
a batch file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
The threat actor installed Atera and Splashtop remote access software,T1219,Remote Access Software
They then repeated the install of the remote access software package.,T1219,Remote Access Software
the threat actor installed RSAT (Remote Server Administration Tools) on the beachhead host,T1219,Remote Access Software
AnyDesk was used to move laterally between a workstation and a backup server,T1219,Remote Access Software
three different Remote Access Software were used by the threat actor,T1219,Remote Access Software
the threat actor used three different tools in order to establish an interactive and persistent command and control channel.,T1219,Remote Access Software
the installation of the remote management tools,T1219,Remote Access Software
began their first lateral movement to a server in the environment by copying their Cobalt Strike DLL over to the host and executing it,T1570,Lateral Tool Transfer
"the threat actors moved to install AnyDesk on several servers including a backup management host, likely as a further means of persistence or later command and control.",T1570,Lateral Tool Transfer
"they connected to a domain controller and dropped three scripts; one to copy the ransomware executable to all hosts, one to reset every users password in the organization, and a final one to execute the staged ransomware payload using PsExec",T1570,Lateral Tool Transfer
executing it via a remote service.,T1210,Exploitation of Remote Services
proceeded to dump LSASS memory,T1003.001,OS Credential Dumping: LSASS Memory
ProcDump was used to dump LSASS memory.,T1003.001,OS Credential Dumping: LSASS Memory
"several different Mimikatz implementations were executed on the domain controller, including a Mimikatz executable",T1003.001,OS Credential Dumping: LSASS Memory
There were several variants of Mimikatz in binary and PowerShell form,T1003.001,OS Credential Dumping: LSASS Memory
"C:\Windows\system32\cmd.exe /C mimikatz.exe ""privilege::debug"" ""sekurlsa::logonpasswords""",T1003.001,OS Credential Dumping: LSASS Memory
C:\Windows\system32\cmd.exe /C mimikatz.exe privilege::debug sekurlsa::logonPasswords full samdump,T1003.001,OS Credential Dumping: LSASS Memory
Multiple injections into the LSASS process were observed on multiple hosts.,T1003.001,OS Credential Dumping: LSASS Memory
LSASS process to access credentials.,T1003.001,OS Credential Dumping: LSASS Memory
Process dump of the LSASS process,T1003.001,OS Credential Dumping: LSASS Memory
the lsass.exe beacon,T1003.001,OS Credential Dumping: LSASS Memory
c:\windows\temp\procdump64.exe -accepteula -ma lsass.exe,T1003.001,OS Credential Dumping: LSASS Memory
Several more beacons were also loaded on the host using DLLs and PowerShell.,T1105,Ingress Tool Transfer
the threat actor moved on to downloading a variety of beacon executables,T1105,Ingress Tool Transfer
"to execute various dropped tools or beacons on the endpoint,",T1105,Ingress Tool Transfer
files that where downloaded from those sites:,T1105,Ingress Tool Transfer
file downloads relating to tooling/scripts.,T1105,Ingress Tool Transfer
The threat actors downloaded the lsass.exe beacon from their attacker hosted infrastructure,T1105,Ingress Tool Transfer
Lots of custom scripts dropped by threat actors,T1105,Ingress Tool Transfer
Other tools and scripts were dropped onto one endpoint,T1105,Ingress Tool Transfer
the threat actors often opened Internet Explorer to download their beacons,T1105,Ingress Tool Transfer
The threat actors dropped the first of their ransomware binaries on the fourth day of the intrusion,T1105,Ingress Tool Transfer
the threat actors had the clear text credentials for one of the domain administrator accounts and began moving lateral to other systems,T1078,Valid Accounts
"They issued remote commands using WMIC to conduct discovery, as well as distribute and execute Cobalt Strike beacons.",T1047,Windows Management Instrumentation
"additional beacons executed using remote WMIC commands,",T1047,Windows Management Instrumentation
executed using remote WMI commands,T1047,Windows Management Instrumentation
The use of WMIC was leveraged by a batch file,T1047,Windows Management Instrumentation
wmic /node,T1047,Windows Management Instrumentation
Threat actors used the lolbin wmic.exe in order to execute PowerShell Cobalt Strike beacons on multiple workstations and servers,T1047,Windows Management Instrumentation
WmiPrvSe.exe (WMI Provider Host) executed the PowerShell Cobalt Strike beacon on the remote computers.,T1047,Windows Management Instrumentation
the threat actors proceeded to RDP to the domain controller.,T1021.001,Remote Services: Remote Desktop Protocol
starting the RDP session,T1021.001,Remote Services: Remote Desktop Protocol
run from their interactive RDP session,T1021.001,Remote Services: Remote Desktop Protocol
used to proxy RDP connections and connect to another computer.,T1021.001,Remote Services: Remote Desktop Protocol
"The use of RDP was extensively used throughout the intrusion, using a variety of processes",T1021.001,Remote Services: Remote Desktop Protocol
establishing RDP connections,T1021.001,Remote Services: Remote Desktop Protocol
"During these RDP sessions,",T1021.001,Remote Services: Remote Desktop Protocol
This file was opened during their RDP session and contained the PowerShell commands used to launch a new beacon:,T1021.001,Remote Services: Remote Desktop Protocol
RDP traffic and minimize external RDP access,T1021.001,Remote Services: Remote Desktop Protocol
RDP traffic,T1021.001,Remote Services: Remote Desktop Protocol
They then opened an RDP connection back to the primary domain controller,T1021.001,Remote Services: Remote Desktop Protocol
the threat actors executed a PowerShell command to disable Windows Defender Antivirus on the host,T1562.001,Impair Defenses: Disable or Modify Tools
Windows Defender tampering,T1562.001,Impair Defenses: Disable or Modify Tools
powershell.exe Uninstall-WindowsFeature -Name Windows-Defender-GUI,T1562.001,Impair Defenses: Disable or Modify Tools
reviewed Group Policy Objects for the domain.,T1484.001,Domain or Tenant Policy Modification: Group Policy Modification
"the user clicked on the ISO file, which created a new virtual hard drive disk",T1204.002,User Execution: Malicious File
"when the victim clicked on the LNK file, it triggered the execution of the batch file",T1204.002,User Execution: Malicious File
Clicking on the LNK file executes the batch file,T1204.002,User Execution: Malicious File
a hidden directory,T1564.001,Hide Artifacts: Hidden Files and Directories
located in a hidden folder,T1564.001,Hide Artifacts: Hidden Files and Directories
the hidden view attribute in file explorer in reference to the ProgramData folder.,T1564.001,Hide Artifacts: Hidden Files and Directories
delivered a hidden directory,T1564.001,Hide Artifacts: Hidden Files and Directories
The ISO file was delivered as a ZIP archive via a malicious spam mail campaign.,T1566.001,Phishing: Spearphishing Attachment
"DLL was executed using rundll32.exe :
C:\Windows\system32\cmd.exe /c D:\max\eyewear.bat
	➝ rundll32",T1218.011,System Binary Proxy Execution: Rundll32
This process was invoked by RunDLL32.exe,T1218.011,System Binary Proxy Execution: Rundll32
malware running via Rundll32,T1218.011,System Binary Proxy Execution: Rundll32
file was executed by the injected Rundll32.exe process.,T1218.011,System Binary Proxy Execution: Rundll32
a single Rundll32.exe process,T1218.011,System Binary Proxy Execution: Rundll32
"rundll32 locker_32.dll,run",T1218.011,System Binary Proxy Execution: Rundll32
loads it using rundll32,T1218.011,System Binary Proxy Execution: Rundll32
The decoded PowerShell function,T1140,Deobfuscate/Decode Files or Information
Decoded from Base64:,T1140,Deobfuscate/Decode Files or Information
A scheduled task was then created using this same DLL.,T1053.005,Scheduled Task/Job: Scheduled Task
A scheduled task was created at that time to maintain persistence on this host,T1053.005,Scheduled Task/Job: Scheduled Task
GetSystem creates a service,T1543.003,Create or Modify System Process: Windows Service
used to inject a new beacon or a specific program to another process on the victim’s computer.,T1055,Process Injection
The injection is also visible from memory dumps,T1055,Process Injection
Several hosts showed rundll32 processes exhibiting common process injection behavior,T1055,Process Injection
Code injection in LSASS,T1055,Process Injection
an injected Cobalt Strike beacon,T1055,Process Injection
the injected Rundll32.exe process.,T1055,Process Injection
The common processes observed were two injected processes,T1055,Process Injection
a beacon injected into a single Rundll32.exe process,T1055,Process Injection
to discover information relating to the user,T1033,System Owner/User Discovery
"host,",T1082,System Information Discovery
cmd.exe /C hostname,T1082,System Information Discovery
systeminfo,T1082,System Information Discovery
systeminfo,T1082,System Information Discovery
queried a number of target hosts to determine the host disk drive configuration,T1082,System Information Discovery
"This can be useful to determine drives, including mounted network shares.",T1082,System Information Discovery
"logicaldisk get caption,description,drivetype,providername,volumename",T1082,System Information Discovery
network configuration,T1016,System Network Configuration Discovery
ipconfig /all,T1016,System Network Configuration Discovery
ipconfig,T1016,System Network Configuration Discovery
C:\Windows\system32\cmd.exe /C dir /s *file/,T1083,File and Directory Discovery
threat actors used the dir command,T1083,File and Directory Discovery
C:\Windows\System32\cmd.exe /C dir,T1083,File and Directory Discovery
This was double base64 encoded.,T1027,Obfuscated Files or Information
"PowerShell Base64 encoded string:

The -e is short for -EncodedCommand.",T1027,Obfuscated Files or Information
The base64 encoding starts with JAB that is a common pattern for UTF-16 starting with $,T1027,Obfuscated Files or Information
PowerShell encoded commands:,T1027,Obfuscated Files or Information
powershell -np -w hidden -encodedcommand,T1027,Obfuscated Files or Information
used to proxy,T1090,Proxy
"Proxying RDP traffic via a processes such as a Cobalt Strike beacon reduces the exposure of the threat actor’s own infrastructure, and blends RDP activity to those of internal hosts on the network.",T1090,Proxy
the threat actors made attempts to proxy RDP traffic,T1090,Proxy
the RDP traffic was being proxied through,T1090,Proxy
attempted to masquerade dropped files as legitimate Microsoft Windows executables,T1036.005,Masquerading: Match Legitimate Name or Location
Once the file was unpacked,T1027,Obfuscated Files or Information
the documents were exfiltrated over one of the encrypted C2 channels.,T1041,Exfiltration Over C2 Channel
"When the payload was executed, there were some telltale registry events observed",T1112,Modify Registry
files were then deleted,T1070.004,Indicator Removal: File Deletion
packed versions uploaded to VT,T1027,Obfuscated Files or Information
pack the code’s dependencies into the .NET assembly so it can run self-contained.,T1027,Obfuscated Files or Information
compression using QuickLZ,T1027,Obfuscated Files or Information
"with names invoking popular videogames such as Fortnite, Valorant, Roblox or Warzone2.",T1036.005,Masquerading: Match Legitimate Name or Location
create a legitimate looking folder to drop an illicit version of the System Configuration Utility msconfig.exe,T1036.005,Masquerading: Match Legitimate Name or Location
"creates the folder “C:Windows System32”, with a space after Windows",T1036.005,Masquerading: Match Legitimate Name or Location
packaged into an obfuscated PowerShell batch file,T1027,Obfuscated Files or Information
heavily obfuscated batch file is hidden and automatically executed when launched.,T1027,Obfuscated Files or Information
script extracts two separate binaries from the base64 encoded text,T1027,Obfuscated Files or Information
another obfuscated binary carrying an embedded resource,T1027,Obfuscated Files or Information
extraction of the resources leads to the final payloads,T1027,Obfuscated Files or Information
Option to embed additional malware to be executed,T1027,Obfuscated Files or Information
the rootkit’s DLL that is embedded as a resource,T1027,Obfuscated Files or Information
fileless and executed only in memory after going through several decryptions and decompression routines,T1140,Deobfuscate/Decode Files or Information
"AES decrypts, and GZIP decompresses it to produce two separate byte arrays",T1140,Deobfuscate/Decode Files or Information
will be decompressed and decrypted,T1140,Deobfuscate/Decode Files or Information
decompress and decrypt the final payload,T1140,Deobfuscate/Decode Files or Information
Hooks several functions from ntdll.dll to hide its presence.,T1055,Process Injection
leveraging Windows Management Instrumentation (WMI) to identify the system’s manufacturer.,T1047,Windows Management Instrumentation
identify the system’s manufacturer,T1082,System Information Discovery
"delivered to the victim, commonly through a phishing mail",T1566.001,Phishing: Spearphishing Attachment
receives a ZIP file containing a benign file in plain sight,T1566.001,Phishing: Spearphishing Attachment
automatically executed when launched.,T1204.002,User Execution: Malicious File
bat file format,T1059.003,Command and Scripting Interpreter: Windows Command Shell
spawned with PowerShell via Task Scheduler,T1059.003,Command and Scripting Interpreter: Windows Command Shell
using PowerShell.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
base64 encoded text later in the file,T1027,Obfuscated Files or Information
more obfuscation and encryption techniques that lead to the final payload.,T1027,Obfuscated Files or Information
stored as obfuscated data in the registry,T1027,Obfuscated Files or Information
"prefix is used to hide files, directories, NamedPipes, scheduled tasks, processes, registry keys/values, and services.",T1027,Obfuscated Files or Information
writes it as encrypted data.,T1027,Obfuscated Files or Information
deletes it as soon as the utility is running,T1070.004,Indicator Removal: File Deletion
stored as obfuscated data in the registry,T1112,Modify Registry
Creating a registry key to store the malware code,T1112,Modify Registry
saves its configuration as a registry key.,T1112,Modify Registry
spawned with PowerShell via Task Scheduler,T1053.005,Scheduled Task/Job: Scheduled Task
Creating a scheduled task to execute the malware using PowerShell.,T1053.005,Scheduled Task/Job: Scheduled Task
injected into the winlogon.exe process.,T1055,Process Injection
injected into other processes.,T1055,Process Injection
injects itself and additional malware(s) into all processes,T1055,Process Injection
be injected into the winlogon.exe process,T1055,Process Injection
carries out process injections,T1055,Process Injection
"loads a fresh copy of ntdll.dll,",T1055,Process Injection
loading a fresh copy of “ntdll.dll” from disk to avoid process hollowing detection,T1055,Process Injection
executed via dllhost.exe using process hollowing techniques.,T1055,Process Injection
injects the rootkit when new processes are created,T1055,Process Injection
Injects the rootkit to a newly created process by another process and updates the callee via NamedPipe,T1055,Process Injection
executes an executable using process hollowing,T1055,Process Injection
Enumerates all running processes,T1057,Process Discovery
executes a file using ShellExecute,T1106,Native API
utilizes the same Common Name in their TLS certificate.,T1071.001,Application Layer Protocol: Web Protocols
secure communication through TLS encryption.,T1071.001,Application Layer Protocol: Web Protocols
"support for TCP network streams (both IPv4 and IPv6),",T1095,Non-Application Layer Protocol
Controlling attached camera devices to take pictures of the compromised computer’s surroundings.,T1113,Screen Capture
takes screenshots at regular intervals.,T1113,Screen Capture
can periodically take screenshots and store them with information about the foreground process and time since the last user input,T1113,Screen Capture
"To limit the disk space used, images where fewer than 5% of the pixels differ from the most recently stored capture aren’t saved.",T1113,Screen Capture
similar screen captures,T1113,Screen Capture
"uses a custom network protocol, which can function over HTTP",T1071.001,Application Layer Protocol: Web Protocols
we can see one more HTTP request,T1071.001,Application Layer Protocol: Web Protocols
HTTP POST request used for FlowCloud C&C communication,T1071.001,Application Layer Protocol: Web Protocols
can send and receive data over HTTP.,T1071.001,Application Layer Protocol: Web Protocols
communicates with a hardcoded IP address via HTTP.,T1071.001,Application Layer Protocol: Web Protocols
can communicate over HTTP or via its “normal protocol”.,T1071.001,Application Layer Protocol: Web Protocols
"The HTTP protocol uses the message format detailed in the previous paragraph, but it adds a few extra steps to disguise its traffic as legitimate HTTP",T1071.001,Application Layer Protocol: Web Protocols
The fields required for HTTP,T1071.001,Application Layer Protocol: Web Protocols
used for HTTP client requests,T1071.001,Application Layer Protocol: Web Protocols
used for HTTP server responses,T1071.001,Application Layer Protocol: Web Protocols
HTTP by prepending the data with a hardcoded,T1071.001,Application Layer Protocol: Web Protocols
"or raw TCP, for C&C server communications.",T1095,Non-Application Layer Protocol
can communicate over raw TCP sockets.,T1095,Non-Application Layer Protocol
normal protocol uses raw TCP sockets and a custom message format,T1095,Non-Application Layer Protocol
which can check running processes,T1057,Process Discovery
which can check running processes against a hardcoded list,T1057,Process Discovery
backdoors can list running processes.,T1057,Process Discovery
"functionalities that collect information about programs and processes,",T1057,Process Discovery
Other commands can be used to retrieve a detailed list of available services and currently running processes.,T1057,Process Discovery
It checks running processes,T1057,Process Discovery
the running processes using  CreateToolhelp32Snapshot and  Process32Next,T1057,Process Discovery
the PID of the process in which the orchestrator is running.,T1057,Process Discovery
"we found a custom AntivirusCheck class, which can check running processes against a hardcoded list of executable filenames from known security products, including ESET products",T1518.001,Software Discovery: Security Software Discovery
"can check whether specific security software is installed on the machine it tries to compromise,",T1518.001,Software Discovery: Security Software Discovery
"there is a custom AntivirusCheck class, which can check running processes against a hardcoded list of XOR-encrypted executable filenames from known security products: 360 Total Security, Avast, Avira, AVG, Bitdefender, ESET, Jiangmin Technology Antivirus, Kingsoft, McAfee, Micropoint, Norton, Rising Antivirus, and Trend Micro.",T1518.001,Software Discovery: Security Software Discovery
It checks running processes for executables of several known cybersecurity vendors.,T1518.001,Software Discovery: Security Software Discovery
contain a section defining specific security software to check for,T1518.001,Software Discovery: Security Software Discovery
"include the ability to collect mouse movements, keyboard activity",T1056.001,Input Capture: Keylogging
records keystrokes.,T1056.001,Input Capture: Keylogging
backdoor’s components records mouse and keyboard activity to a database.,T1056.001,Input Capture: Keylogging
with the keylogger component of the driver (described in the next section) by reading data from the \\.\pipe\namedpipe_keymousespy_english named pipe.,T1056.001,Input Capture: Keylogging
it acts as both a keylogger,T1056.001,Input Capture: Keylogging
Read (IRP_MJ_READ) for the keyboard driver (kbdclass or KeyboardClass0),T1056.001,Input Capture: Keylogging
"handlers for keyboard and mouse events, the driver simply records IO events to lookaside lists before passing them to the legitimate handler.",T1056.001,Input Capture: Keylogging
Keylogging,T1056.001,Input Capture: Keylogging
by compromising a web-facing application such as Microsoft Exchange or SharePoint,T1190,Exploit Public-Facing Application
"exploited Microsoft SharePoint servers in 2019 to gain code execution, probably by leveraging CVE-2019-0604",T1190,Exploit Public-Facing Application
The public-facing application compromise approach,T1190,Exploit Public-Facing Application
has exploited web server vulnerabilities for initial access.,T1190,Exploit Public-Facing Application
"Initial access to targets is obtained by exploiting vulnerable internet-facing applications such as Microsoft Exchange,",T1190,Exploit Public-Facing Application
These were either dropped directly via the webshell or downloaded from a remote server,T1105,Ingress Tool Transfer
The following files are downloaded and written to disk:,T1105,Ingress Tool Transfer
"The communications module then downloads the main backdoor module,",T1105,Ingress Tool Transfer
This downloader simply downloads the loader,T1105,Ingress Tool Transfer
Encoded Royal Road payload,T1027,Obfuscated Files or Information
this encrypted file is,T1027,Obfuscated Files or Information
The identical encrypted file,T1027,Obfuscated Files or Information
deployed in a multistage process that uses various obfuscation and encryption techniques to hinder analysis,T1027,Obfuscated Files or Information
"The values for these executables and configuration data can be found, encrypted, in the loader’s resource section.",T1027,Obfuscated Files or Information
"most resources are written to disk encrypted,",T1027,Obfuscated Files or Information
"In some cases, they are then re-encrypted but with a different key",T1027,Obfuscated Files or Information
same sequence of opcodes to obfuscate the program’s flow,T1027,Obfuscated Files or Information
control flow obfuscation snippet,T1027,Obfuscated Files or Information
files are distributed and stored in encrypted form.,T1027,Obfuscated Files or Information
Base64-encoded strings,T1027,Obfuscated Files or Information
new encrypted shellcode,T1027,Obfuscated Files or Information
This configuration file is encrypted using the just-described function and starts with the magic bytes 0xAF1324BC,T1027,Obfuscated Files or Information
and encrypted QuasarRAT payload,T1027,Obfuscated Files or Information
control flow obfuscation to hinder analysis,T1027,Obfuscated Files or Information
the document triggers the injection of a custom downloader – a PE executable – into an iexplore.exe process.,T1055,Process Injection
that decrypts hardcoded shellcode,T1140,Deobfuscate/Decode Files or Information
Shellcode decryption loop,T1140,Deobfuscate/Decode Files or Information
and only decrypted in memory when needed.,T1140,Deobfuscate/Decode Files or Information
the loader decrypts and parses the embedded installation configuration,T1140,Deobfuscate/Decode Files or Information
the rootkit module is decrypted,T1140,Deobfuscate/Decode Files or Information
"the self-decrypting DLL,",T1140,Deobfuscate/Decode Files or Information
[sic] section of a decoded FlowCloud config,T1140,Deobfuscate/Decode Files or Information
It first decrypts the embedded DLL using a byte-oriented XOR-and-ADD scheme,T1140,Deobfuscate/Decode Files or Information
Once it has decrypted the embedded DLL,T1140,Deobfuscate/Decode Files or Information
Self-decrypting DLL,T1140,Deobfuscate/Decode Files or Information
The loaded shellcode is a self-decrypting DLL.,T1140,Deobfuscate/Decode Files or Information
DLL decryption routine,T1140,Deobfuscate/Decode Files or Information
and only decoded as needed.,T1140,Deobfuscate/Decode Files or Information
a thread that decrypts and loads the fcClient module,T1140,Deobfuscate/Decode Files or Information
The decrypted shellcode,T1140,Deobfuscate/Decode Files or Information
decrypt the embedded module,T1140,Deobfuscate/Decode Files or Information
into the shellcode that will decompress and load the Korplug payload.,T1140,Deobfuscate/Decode Files or Information
It decrypts and loads,T1140,Deobfuscate/Decode Files or Information
decrypted before being written,T1140,Deobfuscate/Decode Files or Information
and injects it into iexplore.exe using WriteProcessMemory.,T1055,Process Injection
"The next stage, injected into iexplore.exe",T1055,Process Injection
The injected code loads the same backdoor (rescure.dat) into the process’s memory and calls its startModule export to finish the installation.,T1055,Process Injection
the injection process,T1055,Process Injection
perform process injection to masquerade as harmless processes.,T1055,Process Injection
"The module creates a new process using the same executable and performs process injection on it, redirecting the existing thread to the written code region.",T1055,Process Injection
The loader injects an orchestrator into memory in a svchost.exe process.,T1055,Process Injection
the orchestrator injects the network component into memory,T1055,Process Injection
the process into which the shellcode will be injected,T1055,Process Injection
"and inject    shellcode,",T1055,Process Injection
Persistence for the downloaded payload is established via the Tendyron value under the Run key HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
the task or service attains persistence by being set to start automatically on boot,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
It then sets specific registry keys and files as guardrails to skip the setup on subsequent runs.,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
"uses filenames that are either similar to those of legitimate Windows files (e.g., rebare.dll which could be mistaken for rebar.dll) or innocuous looking (e.g., AC146142) to avoid suspicion.",T1036.005,Masquerading: Match Legitimate Name or Location
named after legitimate utilities are written into the %ProgramFiles%\MSBuild\Microsoft\Expression\Blend\msole\ subdirectory.,T1036.005,Masquerading: Match Legitimate Name or Location
This process is further camouflaged by changing its associated executable filename to one of svchost.exe or dllhost.exe in the same kernel structure.,T1036.005,Masquerading: Match Legitimate Name or Location
registry key where each embedded resource is to be written,T1112,Modify Registry
by writing to specific registry keys.,T1112,Modify Registry
Network shellcode registry keys,T1112,Modify Registry
stored in the Windows registry.,T1112,Modify Registry
shows the three registry keys used,T1112,Modify Registry
creating the files and registry keys,T1112,Modify Registry
2001Path to the registry key for the PrintProcessor service,T1112,Modify Registry
The paths and registry keys to use,T1112,Modify Registry
it can create a service,T1543.003,Create or Modify System Process: Windows Service
service is then created,T1543.003,Create or Modify System Process: Windows Service
can be configured to create a service for persistence.,T1543.003,Create or Modify System Process: Windows Service
it can create a service or scheduled task.,T1053.005,Scheduled Task/Job: Scheduled Task
persistence is established by using the ITaskService COM interface to create the \Microsoft\Windows\CertificateServicesClient\NetTask scheduled task,T1053.005,Scheduled Task/Job: Scheduled Task
This task will run the DLL hijacking target as SYSTEM at each boot.,T1053.005,Scheduled Task/Job: Scheduled Task
uses COM interfaces to schedule tasks,T1053.005,Scheduled Task/Job: Scheduled Task
creates a scheduled task for persistence.,T1053.005,Scheduled Task/Job: Scheduled Task
service was configured to execute the next step of the installation process by running a legitimate application,T1569.002,System Services: Service Execution
service is then created to run that module and is immediately started,T1569.002,System Services: Service Execution
target for DLL side-loading,T1574.002,Hijack Execution Flow: DLL Side-Loading
DLL side-loading,T1574.002,Hijack Execution Flow: DLL Side-Loading
the malicious library is the same and serves to load and execute shellcode from a file that is stored under the same name as the DLL,T1574.002,Hijack Execution Flow: DLL Side-Loading
"the new process loads the decoy DLL and manually replaces its content in memory with the fcClientDll module (a process known as module stomping or DLL hollowing),",T1574.002,Hijack Execution Flow: DLL Side-Loading
uses DLL Side-Loading to launch its second-stage dropper.,T1574.002,Hijack Execution Flow: DLL Side-Loading
"If a task with the same name already exists, it is deleted before the new one is created",T1027,Obfuscated Files or Information
"After hijacking the aforementioned drivers, the rootkit erases the DLL names associated with them from internal structures used to display device drivers.",T1027,Obfuscated Files or Information
Covers its tracks by overwriting the code previously modified by the malicious library with a useless call to lstrlenW.,T1027,Obfuscated Files or Information
removing their entries from the ActiveProcessLinks list of the undocumented KPROCESS kernel structure.,T1027,Obfuscated Files or Information
The file is then deleted from the disk,T1070.004,Indicator Removal: File Deletion
deletes its rootkit’s executable after launching it.,T1070.004,Indicator Removal: File Deletion
then starts a suspended process to perform injection on it.,T1055,Process Injection
stores collected data in local SQLite databases prior to exfiltration.,T1074.001,Data Staged: Local Data Staging
"Each manager stores collected data in its own SQLite database, while data that is collected on demand is returned directly to the C&C server",T1074.001,Data Staged: Local Data Staging
uses local caches to stage data,T1074.001,Data Staged: Local Data Staging
data can be collected locally by the corresponding class before it is staged for exfiltration.,T1074.001,Data Staged: Local Data Staging
can exfiltrate files from local file systems.,T1005,Data from Local System
The corresponding files are collected,T1005,Data from Local System
Monitoring file system events to collect new and modified files.,T1005,Data from Local System
can search through connected file systems and obtain directory listings.,T1083,File and Directory Discovery
walks through all mapped file systems and collects files,T1083,File and Directory Discovery
collects file and directory metadata,T1083,File and Directory Discovery
uses malicious RTF and DOCX attachments to compromise victims.,T1566.001,Phishing: Spearphishing Attachment
sending spearphishing emails with malicious attachments such as RTF documents created via the Royal Road builder,T1566.001,Phishing: Spearphishing Attachment
makes extensive use of the Windows API to execute commands and launch processes.,T1106,Native API
performs the functions of LoadLibrary and calls the loaded module’s startModule export.,T1106,Native API
used for function imports (via GetProcAddress),T1106,Native API
perform WMI queries,T1047,Windows Management Instrumentation
uses WMI for lateral movement and information gathering.,T1047,Windows Management Instrumentation
runs WMI queries every second to get all process creation and termination events.,T1047,Windows Management Instrumentation
lateral movement scripts such as WMIExec.,T1047,Windows Management Instrumentation
use locally configured proxies.,T1090,Proxy
"can use XOR, TEA, RC4 and a modified AES algorithm to encrypt traffic and files.",T1573.001,Encrypted Channel: Symmetric Cryptography
It is encrypted using the AES algorithm,T1573.001,Encrypted Channel: Symmetric Cryptography
The application and the accompanying relevant and malicious DLL were both embedded in the loader’s resources.,T1027,Obfuscated Files or Information
the embedded DLL,T1027,Obfuscated Files or Information
the embedded DLL,T1027,Obfuscated Files or Information
It also embeds a DLL version of the Pafish (aka Paranoid Fish) sandbox and analysis detection tool as one of its encrypted resources,T1027,Obfuscated Files or Information
This module is embedded in the library’s resource section and encrypted with an algorithm similar to RC4,T1027,Obfuscated Files or Information
the function used to encrypt and decrypt the embedded module,T1027,Obfuscated Files or Information
"Another component collects information about mapped volumes, including mount point, name, drive type, and disk usage data.",T1082,System Information Discovery
This is sent to the server along with the computer’s name,T1082,System Information Discovery
This includes bidirectional file transfers between the C&C and the compromised machine.,T1041,Exfiltration Over C2 Channel
This configuration corresponds to resource 1000 in the initial loader. It defines the address and port for both the exfiltration server (file_server) and the C&C server,T1041,Exfiltration Over C2 Channel
a given command line.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"is protected with DNGuard, a commercial .NET packer.",T1027,Obfuscated Files or Information
uses both regular and reflective DLL injection.,T1055,Process Injection
"proxy/tunneling utilities (HTran, LCX, EarthWorm",T1090,Proxy
read from a file on disk or a registry key.,T1012,Query Registry
components use registry keys to signal each other.,T1012,Query Registry
it collects usernames,T1033,System Owner/User Discovery
usernames,T1033,System Owner/User Discovery
directory listings,T1083,File and Directory Discovery
directory listings were harvested as a result.,T1083,File and Directory Discovery
hostnames,T1082,System Information Discovery
machine names,T1082,System Information Discovery
execution using scheduled tasks,T1053.005,Scheduled Task/Job: Scheduled Task
downloaded and run by the plaintext PY files from external infrastructure.,T1105,Ingress Tool Transfer
it download and execute yet another Python script,T1105,Ingress Tool Transfer
Code responsible for downloading cron_script file,T1105,Ingress Tool Transfer
keylogging functionality.,T1056.001,Input Capture: Keylogging
malware hidden inside the Python compiled byte code,T1027,Obfuscated Files or Information
malicious code is embedded in code,T1027,Obfuscated Files or Information
unpacking,T1027,Obfuscated Files or Information
Obfuscation is one of the most popular methods to achieve this.,T1027,Obfuscated Files or Information
JavaScript obfuscation was used,T1027,Obfuscated Files or Information
use of various obfuscation techniques in malware,T1027,Obfuscated Files or Information
the most popular obfuscation techniques is execution of Base64-encoded malicious code,T1027,Obfuscated Files or Information
use of W4SP crew obfuscation tools such as Hyperion and Kramer,T1027,Obfuscated Files or Information
The inspected UEFI firmware was tampered with to embed a malicious code that we dub MoonBounce;,T1027,Obfuscated Files or Information
be embedded in the loader itself.,T1027,Obfuscated Files or Information
that stages execution of further payloads downloaded from the internet,T1105,Ingress Tool Transfer
"attempts to fetch another stage of the payload to run in memory,",T1105,Ingress Tool Transfer
"stage the execution of additional plugins in memory,",T1105,Ingress Tool Transfer
Download a file from the C2 server,T1105,Ingress Tool Transfer
reaching out to the server to obtain a further payload.,T1105,Ingress Tool Transfer
"the execution of several functions in the EFI Boot Services Table, namely AllocatePool, CreateEventEx and ExitBootServices",T1106,Native API
using the WinExec API,T1106,Native API
"injecting it into an svchost.exe process,",T1055,Process Injection
injecting it to the address space of another process.,T1055,Process Injection
The injected process,T1055,Process Injection
an encrypted blob,T1027,Obfuscated Files or Information
the encrypted ScrambleCross shellcode,T1027,Obfuscated Files or Information
an encrypted configuration file,T1027,Obfuscated Files or Information
facilitates the functionality of WMI in Windows,T1047,Windows Management Instrumentation
when the WMI service was initiated,T1047,Windows Management Instrumentation
upon initiation of the WMI service,T1047,Windows Management Instrumentation
Usage of WMI for remote command execution,T1047,Windows Management Instrumentation
wmic  /node:<,T1047,Windows Management Instrumentation
It works by decrypting a shellcode BLOB with AES-256,T1140,Deobfuscate/Decode Files or Information
through the command line as,T1059.003,Command and Scripting Interpreter: Windows Command Shell
via a Windows batch script file,T1059.003,Command and Scripting Interpreter: Windows Command Shell
issuing the following command line,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Write text to a given *.bat file and execute it,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Run a shell command,T1059.003,Command and Scripting Interpreter: Windows Command Shell
examples of command lines,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
cmd /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
executing a launcher utility with the filename System.Mail.Service.dll (MD5: 5F9020983A61446A77AF1976247C443D) through the command line as a service.,T1569.002,System Services: Service Execution
"reg  add ""HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Svchost""",T1112,Modify Registry
"reg  add ""HKLM\SYSTEM\CurrentControlSet\Services\iscsiwmi\Parameters""",T1112,Modify Registry
"reg  add ""HKLM\SYSTEM\CurrentControlSet\Services\iscsiwmi\Parameters"" /",T1112,Modify Registry
The second way to execute StealthMutant is through the creation of a scheduled task,T1053.005,Scheduled Task/Job: Scheduled Task
schtasks /create /TN,T1053.005,Scheduled Task/Job: Scheduled Task
schtasks /run,T1053.005,Scheduled Task/Job: Scheduled Task
Both the IP and the server directory path are encrypted with AES-128 using a base64 encoded key stored in the backdoor’s image.,T1573.001,Encrypted Channel: Symmetric Cryptography
The commands retrieved from the server are also encrypted with AES-128,T1573.001,Encrypted Channel: Symmetric Cryptography
Get list of drives,T1083,File and Directory Discovery
Get content list from a specified directory,T1083,File and Directory Discovery
"cmd /C ""C: & cd \ & dir $temp\ /od""",T1083,File and Directory Discovery
Sending back the result of the command’s execution to the C2 server.,T1041,Exfiltration Over C2 Channel
"cmd /C ""C: & cd \ & whoami""",T1033,System Owner/User Discovery
"cmd /C ""C: & cd \ & tasklist""",T1057,Process Discovery
"cmd /C ""C: & cd \ & systeminfo""",T1082,System Information Discovery
Copying of files across SMB shares,T1570,Lateral Tool Transfer
"cmd /C ""C: & cd \ & arp -a""",T1016,System Network Configuration Discovery
Removal of artefacts from the system,T1070.004,Indicator Removal: File Deletion
wmic  /node,T1070.004,Indicator Removal: File Deletion
wmic  /node,T1070.004,Indicator Removal: File Deletion
wmic  /node,T1070.004,Indicator Removal: File Deletion
wmic  /node,T1070.004,Indicator Removal: File Deletion
wmic  /node,T1070.004,Indicator Removal: File Deletion
wmic  /node,T1070.004,Indicator Removal: File Deletion
These were used to inject the payload into process memory.,T1055,Process Injection
Adds Run Registry Key for Persistence,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
The persistence technique is simply adding a run registry key for persistence,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
added to the startup folder,T1547.001,Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
Screen capture,T1113,Screen Capture
Screen Logger,T1113,Screen Capture
Keylogging,T1056.001,Input Capture: Keylogging
Keylogger,T1056.001,Input Capture: Keylogging
Gathering system information,T1082,System Information Discovery
System Information,T1082,System Information Discovery
Encoded shellcode in Project File,T1027,Obfuscated Files or Information
"contained encoded executables and shellcode,",T1027,Obfuscated Files or Information
"LoadLibraryW, VirtualAlloc, CreateProccessW, and ZwUnmapViewOfSection.",T1106,Native API
"LoadLibraryW loads the module, VirtualAlloc allocates the memory, CreateProcessW created a process, and ZwUnmapViewOfSection is used",T1106,Native API
using the callback function pointer in CallWindowProc,T1106,Native API
The payload from the project files was a remote access tool (RAT) called Remcos.,T1219,Remote Access Software
two large arrays of decimal bytes were decoded by the function,T1140,Deobfuscate/Decode Files or Information
Decoding Function,T1140,Deobfuscate/Decode Files or Information
decoding function,T1140,Deobfuscate/Decode Files or Information
Remote Command Line,T1059.003,Command and Scripting Interpreter: Windows Command Shell
Registry Editor,T1112,Modify Registry
stealing multiple types of data,T1005,Data from Local System
the “UsingTask” element defines the task that will be compiled by MSBuild.,T1053.005,Scheduled Task/Job: Scheduled Task
MSBuild has an inline task feature,T1053.005,Scheduled Task/Job: Scheduled Task
Modify and query the Windows registry,T1112,Modify Registry
query the Windows registry,T1012,Query Registry
Log keystrokes,T1056.001,Input Capture: Keylogging
Bypass UAC,T1548.002,Abuse Elevation Control Mechanism: Bypass User Account Control
"Egress communications over HTTP, HTTPS",T1071.001,Application Layer Protocol: Web Protocols
Take screenshots,T1113,Screen Capture
Set up proxies,T1090,Proxy
payloads are usually shellcode encrypted with a rolling XOR key.,T1027,Obfuscated Files or Information
Once the encoded payload has been located,T1027,Obfuscated Files or Information
the project file has an encoded and compressed payload,T1027,Obfuscated Files or Information
"The use of shellcode, encoding, compression, obfuscated strings",T1027,Obfuscated Files or Information
since each payload will be encrypted with different keys and each configuration will uniquely change the hash value.,T1027,Obfuscated Files or Information
Encrypted payloads will also obfuscate useful strings from static analysis.,T1027,Obfuscated Files or Information
using multiple stages and encrypted/obfuscated payloads,T1027,Obfuscated Files or Information
the code can be injected into other legitimate running processes,T1055,Process Injection
"The payload, usually shellcode, is injected into another process.",T1055,Process Injection
The shellcode is then executed in a new thread.,T1055,Process Injection
An endpoint with a system injected,T1055,Process Injection
process injection,T1055,Process Injection
and process injection,T1055,Process Injection
Inject malicious code into legitimate processes,T1055,Process Injection
is a memory-only DLL that runs as a service,T1543.003,Create or Modify System Process: Windows Service
that pulls the Cobalt Strike payload from a fake JPG file.,T1027,Obfuscated Files or Information
also leveraging steganography to locate the start of the encoded payload,T1027,Obfuscated Files or Information
It uses a different custom packer,T1027,Obfuscated Files or Information
the malware to unpack,T1027,Obfuscated Files or Information
", it extracts, decrypts, and decompresses the data to be executed as shellcode.",T1140,Deobfuscate/Decode Files or Information
"This payload is decrypted, decompressed, and then copied into memory",T1140,Deobfuscate/Decode Files or Information
it is decrypted and executed,T1140,Deobfuscate/Decode Files or Information
decode,T1140,Deobfuscate/Decode Files or Information
domain fronting,T1090,Proxy
or download additional stages.,T1105,Ingress Tool Transfer
drops and executes Cobalt Strike in the memory space of “rundll32.exe.”,T1218.011,System Binary Proxy Execution: Rundll32
This requires either social engineering tactics to get the target to execute the malware or another program/script to execute the file.,T1204.002,User Execution: Malicious File
"To optimize brute forcing efforts, the malware compares the server prompt upon connection to a hardcoded list of strings",T1110,Brute Force
These credentials used appear to be default credentials for IoT devices.,T1078,Valid Accounts
It attempts to specifically gain root access to these devices via a default password,T1078,Valid Accounts
Like the earlier SSH brute-forcing campaign,T1110,Brute Force
brute-forced devices,T1110,Brute Force
optimizing the brute forcing implementation,T1110,Brute Force
Code for the brute forcing implementation is significantly more structured,T1110,Brute Force
added to support the Telnet brute force.,T1110,Brute Force
Restart Telnet brute forcing,T1110,Brute Force
brute forcing,T1110,Brute Force
SSH brute forcing code with the more usual Telnet equivalent.,T1110,Brute Force
The Telnet brute forcing code is designed primarily for self-propagation,T1110,Brute Force
"SSH brute-forcing campaign,",T1110,Brute Force
This allows it to download and deploy,T1105,Ingress Tool Transfer
are downloaded and executed in the victim's system,T1105,Ingress Tool Transfer
downloader to the compromised device that executes and downloads the primary payload.,T1105,Ingress Tool Transfer
"then downloads its payload via software installed on the compromised device, such as ftpget, wget, curl, or tftp, before executing the payload.",T1570,Lateral Tool Transfer
It uses the cpuinfo Python module to retrieve information about the CPU.,T1082,System Information Discovery
This code checks if the disk size is greater than a specified threshold (50 GB as example).,T1082,System Information Discovery
uses the win32api.GetDiskFreeSpaceEx() function to retrieve the disk size in bytes,T1082,System Information Discovery
Reflective PE injection,T1055,Process Injection
Reflective PE injection is a technique used by malware or advanced attackers to inject a Portable Executable (PE) file directly into the memory of a running process without the need for writing the file to disk,T1055,Process Injection
reflective PE injection allows the malware to load and execute its code directly from memory,T1055,Process Injection
"In reflective PE injection, the PE file is parsed and its sections are reconstructed in the target process’s memory.",T1055,Process Injection
-ReflectivePEInjection” that facilitates reflective PE injection using PowerShell.,T1055,Process Injection
This module allows the injection of a PE file into a remote or local process’s memory without writing it to disk,T1055,Process Injection
"Once the PE file is injected and reconstructed in memory, the execution flow can be redirected to the injected code, enabling the malware to operate within the context of the compromised process.",T1055,Process Injection
PE reflective injection.,T1055,Process Injection
The PE file is downloaded on filesystem and than executed.,T1105,Ingress Tool Transfer
uses the DownloadFile method of the WebClient object to download the file from the specified URL and save it to the specified local file path.,T1105,Ingress Tool Transfer
the file to be downloaded.,T1105,Ingress Tool Transfer
script that downloads a file from a fixed location and executes it.,T1105,Ingress Tool Transfer
PowerShell one-liner that can be used to download and execute a remote .ps1 or .exe file:,T1105,Ingress Tool Transfer
"using LNK files to download malware or other malicious files by leveraging legitimate native apps, such as PowerShell.",T1105,Ingress Tool Transfer
simple stager download of an .exe file and its execution.,T1105,Ingress Tool Transfer
This line uses the ShellExecute method of the Shell.Application object to execute the downloaded file.,T1059.003,Command and Scripting Interpreter: Windows Command Shell
The Shell.Application object provides methods for working with the Windows shell,T1059.003,Command and Scripting Interpreter: Windows Command Shell
decrypt,T1140,Deobfuscate/Decode Files or Information
This decryption process utilizes the Fernet algorithm,T1140,Deobfuscate/Decode Files or Information
The script will download and decrypt the string that represents the token,T1140,Deobfuscate/Decode Files or Information
The fernet_decrypt function decrypts an encrypted string,T1140,Deobfuscate/Decode Files or Information
It returns the decrypted message as a decoded string.,T1140,Deobfuscate/Decode Files or Information
"it use the harcoded password for decryption using the fernet_decrypt function, and returns the decrypted AUTH Token.",T1140,Deobfuscate/Decode Files or Information
the file will be deleted,T1070.004,Indicator Removal: File Deletion
"access to system APIs,",T1106,Native API
It uses the win32api.GetDiskFreeSpaceEx() function,T1106,Native API
Fernet is a symmetric encryption algorithm and token format used for secure communication and data protection,T1573.001,Encrypted Channel: Symmetric Cryptography
"It utilizes symmetric key cryptography, where the same secret key is used for both encryption and decryption",T1573.001,Encrypted Channel: Symmetric Cryptography
this code comparing the local IP address with a predefined list of network addresses,T1016,System Network Configuration Discovery
obfuscation mechanisms during the compilation process.,T1027,Obfuscated Files or Information
the injected code,T1055,Process Injection
the local disk volumes to be encrypted are also configured in a similar manner.,T1027,Obfuscated Files or Information
"In addition to file encryption and obfuscation,",T1027,Obfuscated Files or Information
"(crawl whole tree), I:, H:, G:, F:, E:, and D:.",T1083,File and Directory Discovery
"malware will attempt to gather specific, sensitive information from targeted systems.",T1005,Data from Local System
the dropper is distributed in the form of a UPX-packed DLL,T1027,Obfuscated Files or Information
"The malware then abuses the MSDTC service, manipulating the permissions and startup parameters.",T1569.002,System Services: Service Execution
"its abuse of the legitimate MSDTC service,",T1569.002,System Services: Service Execution
malicious oci.dll into the service’s executable,T1569.002,System Services: Service Execution
its attempts to steal credentials and browser data.,T1552.001,Unsecured Credentials: Credentials In Files
This includes browser session and credential data.,T1552.001,Unsecured Credentials: Credentials In Files
Credential and Browser Data Theft,T1552.001,Unsecured Credentials: Credentials In Files
"It checks that there are no running processes related to security-related software (e.g., Windbg, Autoruns, Wireshark)",T1518.001,Software Discovery: Security Software Discovery
"It checks that there are no drivers loaded from security-related software (e.g., groundling32.sys)",T1518.001,Software Discovery: Security Software Discovery
"It checks that the status of certain services belonging to security-related software meets certain conditions (e.g., windefend, sense, cavp)",T1518.001,Software Discovery: Security Software Discovery
"Like the domain, the URI is composed using a set of hardcoded keywords and paths, which are chosen partly at random and partly based on the type of HTTP request that is being sent out.",T1071.001,Application Layer Protocol: Web Protocols
DeleteFile,T1070.004,Indicator Removal: File Deletion
deleting files,T1070.004,Indicator Removal: File Deletion
ReadRegistryValue,T1012,Query Registry
GetRegistrySubKeyAndValueNames,T1012,Query Registry
enumerate files and registry keys,T1012,Query Registry
The content of the MachineGuid registry value from the key HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography,T1012,Query Registry
DeleteRegistryValue,T1112,Modify Registry
SetRegistryValue,T1112,Modify Registry
manipulating of registry keys,T1112,Modify Registry
GetProcessByDescription,T1057,Process Discovery
enumerate processes,T1057,Process Discovery
"The command CollectSystemDescription retrieves the following information:

Local Computer Domain name
Administrator Account SID
HostName",T1082,System Information Discovery
OS Version,T1082,System Information Discovery
The domain name of the device,T1082,System Information Discovery
Username,T1033,System Owner/User Discovery
System Directory,T1083,File and Directory Discovery
"To avoid detection, attackers renamed Windows administrative tools like adfind.exe which were then used for domain enumeration",T1036.005,Masquerading: Match Legitimate Name or Location
schtasks /create /F /tn “\Microsoft\Windows\SoftwareProtectionPlatform\EventCacheManager” /tr “C:\Windows\SoftwareDistribution\EventCacheManager.exe” /sc ONSTART /ru system /,T1053.005,Scheduled Task/Job: Scheduled Task
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
C:\Windows\system32\cmd.exe /C,T1059.003,Command and Scripting Interpreter: Windows Command Shell
"With Rundll32,",T1218.011,System Binary Proxy Execution: Rundll32
collect and upload information about the device,T1005,Data from Local System
to report some basic information about the compromised system,T1005,Data from Local System
the ability to log keystrokes,T1056.001,Input Capture: Keylogging
keystrokes,T1056.001,Input Capture: Keylogging
logs keystrokes,T1056.001,Input Capture: Keylogging
"capture screenshots,",T1113,Screen Capture
“The reconnaissance data is exfiltrated to the attacker-controlled server through an HTTP POST request,T1041,Exfiltration Over C2 Channel
the attacker-controlled server through an HTTP POST request,T1071.001,Application Layer Protocol: Web Protocols
send phishing emails with malicious HTML attachments,T1566.001,Phishing: Spearphishing Attachment
operating system information,T1082,System Information Discovery
collecting system information such as hostnames,T1082,System Information Discovery
OS version information,T1082,System Information Discovery
run the payloads by sideloading them to the legitimate executables,T1574.002,Hijack Execution Flow: DLL Side-Loading
insights on anti-virus software present on the machine,T1518.001,Software Discovery: Security Software Discovery
downloading and executing two other PowerShell scripts from a different attacker-controlled server,T1105,Ingress Tool Transfer
IPv4 addresses,T1016,System Network Configuration Discovery
“The banking trojan targets the victim’s sensitive information,T1005,Data from Local System
"Once user credentials have been compromised, this tool takes “full control” of the account",T1078,Valid Accounts
"“When a victim opens the HTML file attachment, an embedded URL is launched in the victim’s browser, redirecting to another malicious HTML file from an attacker-controlled AWS EC2 instance",T1027,Obfuscated Files or Information
Identify processes,T1057,Process Discovery
Logged Processes,T1057,Process Discovery
"Identify processes related to backups, antivirus/anti-spyware,",T1518.001,Software Discovery: Security Software Discovery
actors have also gained initial access to victim networks by distributing phishing emails with malicious attachments,T1566.001,Phishing: Spearphishing Attachment
by exploiting the following vulnerabilities against Microsoft Exchange servers,T1190,Exploit Public-Facing Application
removes virus definitions and disables all portions of Windows Defender and other common antivirus programs in the system registry,T1562.001,Impair Defenses: Disable or Modify Tools
Microsoft Windows Defender AntiVirus Protection disabled,T1562.001,Impair Defenses: Disable or Modify Tools
Microsoft Windows Defender AntiSpyware Protection disabled,T1562.001,Impair Defenses: Disable or Modify Tools
Microsoft Exchange Server Privilege Escalation Vulnerability,T1068,Exploitation for Privilege Escalation
remove all existing shadow copies via vssadmin on command line,T1059.003,Command and Scripting Interpreter: Windows Command Shell
This could cause the file to run when double-clicked instead of opening it with a PDF viewer.,T1204.002,User Execution: Malicious File
and then downloads a second-stage backdoor from the OpenDrive cloud service.,T1105,Ingress Tool Transfer
The decryption routine shared between the BADCALL for Linux and targeted destructive malware for Windows from 2014,T1140,Deobfuscate/Decode Files or Information
uses the same type of strong encryption – AES-GCM,T1027,Obfuscated Files or Information
creates a scheduled task on the system that provides persistence.,T1053.005,Scheduled Task/Job: Scheduled Task
creates a scheduled task on the system that provides persistence.,T1053.005,Scheduled Task/Job: Scheduled Task
creates a scheduled task on the system that provides persistence.,T1053.005,Scheduled Task/Job: Scheduled Task
establishes persistence by creating an autostart service that allows it to run whenever the machine boots.,T1543.003,Create or Modify System Process: Windows Service
establishes persistence by creating an autostart service that allows it to run whenever the machine boots.,T1543.003,Create or Modify System Process: Windows Service
decodes the configuration data and modules.,T1140,Deobfuscate/Decode Files or Information
injects into the svchost.exe process.,T1055,Process Injection
injects into the svchost.exe process,T1055,Process Injection
malicious actors spread primarily by spearphishing campaigns using tailored emails that contain malicious attachments,T1566.001,Phishing: Spearphishing Attachment
has used an email with an Excel sheet containing a malicious macro to deploy the malware.,T1566.001,Phishing: Spearphishing Attachment
compromised server that prompts the victim to click,T1204.002,User Execution: Malicious File
"In clicking the photo, the victim unknowingly downloads a malicious JavaScript file that",T1204.002,User Execution: Malicious File
has attempted to get users to launch malicious documents to deliver its payload.,T1204.002,User Execution: Malicious File
spread the malware laterally across a network by abusing the Server Message Block (SMB) Protocol.,T1570,Lateral Tool Transfer
modules spread the malware laterally across a network by abusing the SMB Protocol.,T1570,Lateral Tool Transfer
data exfiltration over a hardcoded C2 server,T1041,Exfiltration Over C2 Channel
can send information about the compromised host to a hardcoded C2 server.,T1041,Exfiltration Over C2 Channel
"uses the Windows Application Programming Interface (API) call, CreateProcessW(), to manage execution flow.",T1106,Native API
by capturing the CredEnumerateA API.,T1106,Native API
by capturing the CredEnumerateA API.,T1106,Native API
leveraging Microsoft’s CryptoAPI,T1106,Native API
uses an AES CBC (256 bits) encryption algorithm for its loader and configuration files.,T1027,Obfuscated Files or Information
leverages a custom packer to obfuscate its functionality.,T1027,Obfuscated Files or Information
can modify registry entries,T1112,Modify Registry
can disable Windows Defender.,T1562.001,Impair Defenses: Disable or Modify Tools
"can obtain passwords stored in files from several applications such as Outlook, Filezilla, OpenSSH, OpenVPN and WinSCP.",T1552.001,Unsecured Credentials: Credentials In Files
it searches for the .vnc.lnk affix to steal VNC credentials.,T1552.001,Unsecured Credentials: Credentials In Files
can obtain passwords stored in files,T1552.001,Unsecured Credentials: Credentials In Files
by querying the Software\SimonTatham\Putty\Sessions registry key.,T1012,Query Registry
"obtains the IP address, location, and other relevant network information from the victim’s machine.",T1016,System Network Configuration Discovery
can identify the user and groups the user belongs to on a compromised host.,T1033,System Owner/User Discovery
"gathers the OS version, machine name, CPU type, amount of RAM available from the victim’s machine",T1082,System Information Discovery
"searches the system for all of the following file extensions: .avi, .mov, .mkv, .mpeg, .mpeg4, .mp4, .mp3, .wav, .ogg, .jpeg, .jpg, .png, .bmp, .gif, .tiff, .ico, .xlsx, and .zip.",T1083,File and Directory Discovery
collects local files and information from the victim’s local machine.,T1005,Data from Local System
uses HTTPS to communicate with its C2 servers,T1071.001,Application Layer Protocol: Web Protocols
samples have used HTTP over ports 447 and 8082 for C2.,T1071.001,Application Layer Protocol: Web Protocols
downloads several additional files and saves them to the victim's machine.,T1105,Ingress Tool Transfer
uses a custom crypter leveraging Microsoft’s CryptoAPI to encrypt C2 traffic.,T1573.001,Encrypted Channel: Symmetric Cryptography